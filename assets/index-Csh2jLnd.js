(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var Ri=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ao(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Io(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),r}var ut,Li;function j(){if(Li)return ut;Li=1;function e(){}e.prototype.addEventListener=function(r,i){var n=this.__events=this.__events||{},s=n[r]=n[r]||[];s.indexOf(i)<0&&s.push(i)},e.prototype.removeEventListener=function(r,i){var n=this.__events=this.__events||{},s=n[r];if(s){var a=s.indexOf(i);a>=0&&s.splice(a,1)}},e.prototype.emit=function(r,i){var n=this.__events=this.__events||{},s=n[r],a=Array.prototype.slice.call(arguments,1);if(s)for(var o=0;o<s.length;o++){var l=s[o];l.apply(this,a)}};function t(r){for(var i in e.prototype)e.prototype.hasOwnProperty(i)&&(r.prototype[i]=e.prototype[i])}return ut=t,ut}var dt,Pi;function Ce(){if(Pi)return dt;Pi=1;function e(){return typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return Date.now()}}return dt=e(),dt}var pt,zi;function ds(){if(zi)return pt;zi=1;var e=Ce();function t(i,n){this.fn=i,this.cb=n,this.cfn=null}function r(i){this._queue=[],this._delay=i&&i.delay||0,this._paused=i&&!!i.paused||!1,this._currentTask=null,this._lastFinished=null}return r.prototype.length=function(){return this._queue.length},r.prototype.push=function(i,n){var s=new t(i,n),a=this._cancel.bind(this,s);return this._queue.push(s),this._next(),a},r.prototype.pause=function(){this._paused||(this._paused=!0)},r.prototype.resume=function(){this._paused&&(this._paused=!1,this._next())},r.prototype._start=function(i){if(this._currentTask)throw new Error("WorkQueue: called start while running task");this._currentTask=i;var n=this._finish.bind(this,i);if(i.cfn=i.fn(n),typeof i.cfn!="function")throw new Error("WorkQueue: function is not cancellable")},r.prototype._finish=function(i){var n=Array.prototype.slice.call(arguments,1);if(this._currentTask!==i)throw new Error("WorkQueue: called finish on wrong task");i.cb.apply(null,n),this._currentTask=null,this._lastFinished=e(),this._next()},r.prototype._cancel=function(i){var n=Array.prototype.slice.call(arguments,1);if(this._currentTask===i)i.cfn.apply(null,n);else{var s=this._queue.indexOf(i);s>=0&&(this._queue.splice(s,1),i.cb.apply(null,n))}},r.prototype._next=function(){if(!this._paused&&this._queue.length&&!this._currentTask){if(this._lastFinished!=null){var i=e()-this._lastFinished,n=this._delay-i;if(n>0){setTimeout(this._next.bind(this),n);return}}var s=this._queue.shift();this._start(s)}},pt=r,pt}var _t,Ai;function ps(){if(Ai)return _t;Ai=1;function e(t,r,i,n){n=n||{};var s;i!=null&&i.absoluteWidth!=null?s=i.absoluteWidth/t:i!=null&&i.relativeWidth!=null?s=i.relativeWidth:s=1;var a;i&&i.absoluteHeight!=null?a=i.absoluteHeight/r:i!=null&&i.relativeHeight!=null?a=i.relativeHeight:a=1;var o;i!=null&&i.absoluteX!=null?o=i.absoluteX/t:i!=null&&i.relativeX!=null?o=i.relativeX:o=0;var l;return i!=null&&i.absoluteY!=null?l=i.absoluteY/r:i!=null&&i.relativeY!=null?l=i.relativeY:l=0,n.x=o,n.y=l,n.width=s,n.height=a,n}return _t=e,_t}var mt,Ii;function _s(){if(Ii)return mt;Ii=1;function e(t){return function(i){var n,s;try{s=t()}catch(a){n=a}finally{n?i(n):i(null,s)}}}return mt=e,mt}var yt,qi;function Kr(){if(qi)return yt;qi=1;function e(t){var r=!1,i;return function(){return r||(r=!0,i=t.apply(null,arguments)),i}}return yt=e,yt}var gt,Oi;function ms(){if(Oi)return gt;Oi=1;var e=Kr();function t(r){return function(){if(!arguments.length)throw new Error("cancelized: expected at least one argument");var n=Array.prototype.slice.call(arguments,0),s=n[n.length-1]=e(n[n.length-1]);function a(){s.apply(null,arguments)}return r.apply(null,n),a}}return gt=t,gt}var wt,Di;function U(){if(Di)return wt;Di=1;function e(t){for(var r in t)t.hasOwnProperty(r)&&(t[r]=void 0)}return wt=e,wt}var xt,Hi;function qo(){if(Hi)return xt;Hi=1;function e(){this._renderers={}}return e.prototype.set=function(t,r,i){this._renderers[t]||(this._renderers[t]={}),this._renderers[t][r]=i},e.prototype.get=function(t,r){var i=this._renderers[t]&&this._renderers[t][r];return i||null},xt=e,xt}var Mt,$i;function Oo(){if($i)return Mt;$i=1;var e=j(),t=ds(),r=ps(),i=_s(),n=ms(),s=U(),a=qo();function o(c,f){return c.cmp(f)}function l(c,f){return-c.cmp(f)}function h(c){this._progressive=!!(c&&c.progressive),this._layers=[],this._renderers=[],this._tilesToLoad=[],this._tilesToRender=[],this._tmpVisible=[],this._tmpChildren=[],this._width=0,this._height=0,this._tmpRect={},this._tmpSize={},this._createTextureWorkQueue=new t,this._emitRenderInvalid=this._emitRenderInvalid.bind(this),this._rendererRegistry=new a}return e(h),h.prototype.destroy=function(){this.removeAllLayers(),s(this)},h.prototype.registerRenderer=function(c,f,_){return this._rendererRegistry.set(c,f,_)},h.prototype.domElement=function(){throw new Error("Stage implementation must override domElement")},h.prototype.width=function(){return this._width},h.prototype.height=function(){return this._height},h.prototype.size=function(c){return c=c||{},c.width=this._width,c.height=this._height,c},h.prototype.setSize=function(c){this._width=c.width,this._height=c.height,this.setSizeForType(),this.emit("resize"),this._emitRenderInvalid()},h.prototype.setSizeForType=function(c){throw new Error("Stage implementation must override setSizeForType")},h.prototype.loadImage=function(){throw new Error("Stage implementation must override loadImage")},h.prototype._emitRenderInvalid=function(){this.emit("renderInvalid")},h.prototype.validateLayer=function(c){throw new Error("Stage implementation must override validateLayer")},h.prototype.listLayers=function(){return[].concat(this._layers)},h.prototype.hasLayer=function(c){return this._layers.indexOf(c)>=0},h.prototype.addLayer=function(c,f){if(this._layers.indexOf(c)>=0)throw new Error("Layer already in stage");if(f==null&&(f=this._layers.length),f<0||f>this._layers.length)throw new Error("Invalid layer position");this.validateLayer(c);var _=c.geometry().type,d=c.view().type,g=this._rendererRegistry.get(_,d);if(!g)throw new Error("No "+this.type+" renderer avaiable for "+_+" geometry and "+d+" view");var p=this.createRenderer(g);this._layers.splice(f,0,c),this._renderers.splice(f,0,p),c.addEventListener("viewChange",this._emitRenderInvalid),c.addEventListener("effectsChange",this._emitRenderInvalid),c.addEventListener("fixedLevelChange",this._emitRenderInvalid),c.addEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},h.prototype.moveLayer=function(c,f){var _=this._layers.indexOf(c);if(_<0)throw new Error("No such layer in stage");if(f<0||f>=this._layers.length)throw new Error("Invalid layer position");c=this._layers.splice(_,1)[0];var d=this._renderers.splice(_,1)[0];this._layers.splice(f,0,c),this._renderers.splice(f,0,d),this._emitRenderInvalid()},h.prototype.removeLayer=function(c){var f=this._layers.indexOf(c);if(f<0)throw new Error("No such layer in stage");var _=this._layers.splice(f,1)[0],d=this._renderers.splice(f,1)[0];this.destroyRenderer(d),_.removeEventListener("viewChange",this._emitRenderInvalid),_.removeEventListener("effectsChange",this._emitRenderInvalid),_.removeEventListener("fixedLevelChange",this._emitRenderInvalid),_.removeEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},h.prototype.removeAllLayers=function(){for(;this._layers.length>0;)this.removeLayer(this._layers[0])},h.prototype.startFrame=function(){throw new Error("Stage implementation must override startFrame")},h.prototype.endFrame=function(){throw new Error("Stage implementation must override endFrame")},h.prototype.render=function(){var c,f,_=this._tilesToLoad,d=this._tilesToRender,g=!0,p,v=this._width,w=this._height,x=this._tmpRect,m=this._tmpSize;if(!(v<=0||w<=0)){for(this.startFrame(),c=0;c<this._layers.length;c++)this._layers[c].textureStore().startFrame();for(c=0;c<this._layers.length;c++){var M=this._layers[c],u=M.effects(),C=M.view(),T=M.textureStore(),b=this._renderers[c],P=this._layers.length-c,z,R;if(r(v,w,u&&u.rect,x),!(x.width<=0||x.height<=0)){for(m.width=x.width*this._width,m.height=x.height*this._height,C.setSize(m),b.startLayer(M,x),p=this._collectTiles(M,T),f=0;f<_.length;f++)z=_[f],T.markTile(z);for(f=0;f<d.length;f++)z=d[f],R=T.texture(z),b.renderTile(z,R,M,P);M.emit("renderComplete",p),p||(g=!1),b.endLayer(M,x)}}for(c=0;c<this._layers.length;c++)this._layers[c].textureStore().endFrame();this.endFrame(),this.emit("renderComplete",g)}},h.prototype._collectTiles=function(c,f){var _=this._tilesToLoad,d=this._tilesToRender,g=this._tmpVisible;_.length=0,d.length=0,g.length=0,c.visibleTiles(g);for(var p=!0,v=0;v<g.length;v++){var w=g[v],x;this._collectTileToLoad(w),f.texture(w)?(x=!1,this._collectTileToRender(w)):(x=this._collectChildren(w,f),p=!1),this._collectParents(w,f,x)}return _.sort(o),d.sort(l),p},h.prototype._collectChildren=function(c,f){var _=this._tmpChildren,d=!0;do{if(_.length=0,!c.children(_))break;d=!1;for(var g=0;g<_.length;g++)c=_[g],f.texture(c)?(this._collectTileToLoad(c),this._collectTileToRender(c)):d=!0}while(d&&_.length===1);return d},h.prototype._collectParents=function(c,f,_){for(var d=this._progressive;(d||_)&&(c=c.parent())!=null;){if(_){if(f.texture(c))this._collectTileToRender(c),_=!1;else if(!this._progressive)continue}this._collectTileToLoad(c)||(d=!1)}return _},h.prototype._collectTileToLoad=function(c){return this._collectTileIntoList(c,this._tilesToLoad)},h.prototype._collectTileToRender=function(c){return this._collectTileIntoList(c,this._tilesToRender)},h.prototype._collectTileIntoList=function(c,f){for(var _=!1,d=0;d<f.length;d++)if(c.equals(f[d])){_=!0;break}return _||f.push(c),!_},h.prototype.createTexture=function(c,f,_){var d=this;function g(){return new d.TextureClass(d,c,f)}var p=n(i(g));return this._createTextureWorkQueue.push(p,function(v,w){_(v,c,f,w)})},Mt=h,Mt}var Et,Ni;function ys(){if(Ni)return Et;Ni=1;var e=function(){return typeof window<"u"?window:typeof self<"u"?self:typeof Ri<"u"?Ri:null}();return Et=e,Et}var Tt,Fi;function Qr(){if(Fi)return Tt;Fi=1;var e=ys(),t=j(),r=U(),i={HTMLImageElement:["naturalWidth","naturalHeight"],HTMLCanvasElement:["width","height"],ImageBitmap:["width","height"]};function n(s){var a=!1;for(var o in i)if(e[o]&&s instanceof e[o]){a=!0,this._widthProp=i[o][0],this._heightProp=i[o][1];break}if(!a)throw new Error("Unsupported pixel source");this._element=s}return t(n),n.prototype.destroy=function(){r(this)},n.prototype.element=function(){return this._element},n.prototype.width=function(){return this._element[this._widthProp]},n.prototype.height=function(){return this._element[this._heightProp]},n.prototype.timestamp=function(){return 0},n.prototype.isDynamic=function(){return!1},Tt=n,Tt}var bt,Vi;function de(){if(Vi)return bt;Vi=1;function e(t,r){t.super_=r;var i=function(){};i.prototype=r.prototype,t.prototype=new i,t.prototype.constructor=t}return bt=e,bt}var Ct,Wi;function gs(){if(Wi)return Ct;Wi=1;var e=de();function t(r){this.constructor.super_.apply(this,arguments),this.message=r}return e(t,Error),Ct=t,Ct}var Ge={exports:{}};/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */var Do=Ge.exports,ki;function Jr(){return ki||(ki=1,function(e){(function(t,r,i){e.exports?e.exports=i():t[r]=i()})(Do,"bowser",function(){var t=!0;function r(h){function c(k){var Y=h.match(k);return Y&&Y.length>1&&Y[1]||""}function f(k){var Y=h.match(k);return Y&&Y.length>1&&Y[2]||""}var _=c(/(ipod|iphone|ipad)/i).toLowerCase(),d=/like android/i.test(h),g=!d&&/android/i.test(h),p=/nexus\s*[0-6]\s*/i.test(h),v=!p&&/nexus\s*[0-9]+/i.test(h),w=/CrOS/.test(h),x=/silk/i.test(h),m=/sailfish/i.test(h),M=/tizen/i.test(h),u=/(web|hpw)(o|0)s/i.test(h),C=/windows phone/i.test(h),T=!C&&/windows/i.test(h),b=!_&&!x&&/macintosh/i.test(h),P=!g&&!m&&!M&&!u&&/linux/i.test(h),z=f(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),R=c(/version\/(\d+(\.\d+)?)/i),A=/tablet/i.test(h)&&!/tablet pc/i.test(h),O=!A&&/[^-]mobi/i.test(h),I=/xbox/i.test(h),S;/opera/i.test(h)?S={name:"Opera",opera:t,version:R||c(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(h)?S={name:"Opera",opera:t,version:c(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||R}:/SamsungBrowser/i.test(h)?S={name:"Samsung Internet for Android",samsungBrowser:t,version:R||c(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(h)?S={name:"NAVER Whale browser",whale:t,version:c(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(h)?S={name:"MZ Browser",mzbrowser:t,version:c(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(h)?S={name:"Opera Coast",coast:t,version:R||c(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(h)?S={name:"Focus",focus:t,version:c(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(h)?S={name:"Yandex Browser",yandexbrowser:t,version:R||c(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(h)?S={name:"UC Browser",ucbrowser:t,version:c(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(h)?S={name:"Maxthon",maxthon:t,version:c(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(h)?S={name:"Epiphany",epiphany:t,version:c(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(h)?S={name:"Puffin",puffin:t,version:c(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(h)?S={name:"Sleipnir",sleipnir:t,version:c(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(h)?S={name:"K-Meleon",kMeleon:t,version:c(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:C?(S={name:"Windows Phone",osname:"Windows Phone",windowsphone:t},z?(S.msedge=t,S.version=z):(S.msie=t,S.version=c(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(h)?S={name:"Internet Explorer",msie:t,version:c(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:w?S={name:"Chrome",osname:"Chrome OS",chromeos:t,chromeBook:t,chrome:t,version:c(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(h)?S={name:"Microsoft Edge",msedge:t,version:z}:/vivaldi/i.test(h)?S={name:"Vivaldi",vivaldi:t,version:c(/vivaldi\/(\d+(\.\d+)?)/i)||R}:m?S={name:"Sailfish",osname:"Sailfish OS",sailfish:t,version:c(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(h)?S={name:"SeaMonkey",seamonkey:t,version:c(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(h)?(S={name:"Firefox",firefox:t,version:c(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(h)&&(S.firefoxos=t,S.osname="Firefox OS")):x?S={name:"Amazon Silk",silk:t,version:c(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(h)?S={name:"PhantomJS",phantom:t,version:c(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(h)?S={name:"SlimerJS",slimer:t,version:c(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(h)||/rim\stablet/i.test(h)?S={name:"BlackBerry",osname:"BlackBerry OS",blackberry:t,version:R||c(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:u?(S={name:"WebOS",osname:"WebOS",webos:t,version:R||c(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(h)&&(S.touchpad=t)):/bada/i.test(h)?S={name:"Bada",osname:"Bada",bada:t,version:c(/dolfin\/(\d+(\.\d+)?)/i)}:M?S={name:"Tizen",osname:"Tizen",tizen:t,version:c(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||R}:/qupzilla/i.test(h)?S={name:"QupZilla",qupzilla:t,version:c(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||R}:/chromium/i.test(h)?S={name:"Chromium",chromium:t,version:c(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||R}:/chrome|crios|crmo/i.test(h)?S={name:"Chrome",chrome:t,version:c(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:g?S={name:"Android",version:R}:/safari|applewebkit/i.test(h)?(S={name:"Safari",safari:t},R&&(S.version=R)):_?(S={name:_=="iphone"?"iPhone":_=="ipad"?"iPad":"iPod"},R&&(S.version=R)):/googlebot/i.test(h)?S={name:"Googlebot",googlebot:t,version:c(/googlebot\/(\d+(\.\d+))/i)||R}:S={name:c(/^(.*)\/(.*) /),version:f(/^(.*)\/(.*) /)},!S.msedge&&/(apple)?webkit/i.test(h)?(/(apple)?webkit\/537\.36/i.test(h)?(S.name=S.name||"Blink",S.blink=t):(S.name=S.name||"Webkit",S.webkit=t),!S.version&&R&&(S.version=R)):!S.opera&&/gecko\//i.test(h)&&(S.name=S.name||"Gecko",S.gecko=t,S.version=S.version||c(/gecko\/(\d+(\.\d+)?)/i)),!S.windowsphone&&(g||S.silk)?(S.android=t,S.osname="Android"):!S.windowsphone&&_?(S[_]=t,S.ios=t,S.osname="iOS"):b?(S.mac=t,S.osname="macOS"):I?(S.xbox=t,S.osname="Xbox"):T?(S.windows=t,S.osname="Windows"):P&&(S.linux=t,S.osname="Linux");function N(k){switch(k){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}var H="";S.windows?H=N(c(/Windows ((NT|XP)( \d\d?.\d)?)/i)):S.windowsphone?H=c(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):S.mac?(H=c(/Mac OS X (\d+([_\.\s]\d+)*)/i),H=H.replace(/[_\s]/g,".")):_?(H=c(/os (\d+([_\s]\d+)*) like mac os x/i),H=H.replace(/[_\s]/g,".")):g?H=c(/android[ \/-](\d+(\.\d+)*)/i):S.webos?H=c(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):S.blackberry?H=c(/rim\stablet\sos\s(\d+(\.\d+)*)/i):S.bada?H=c(/bada\/(\d+(\.\d+)*)/i):S.tizen&&(H=c(/tizen[\/\s](\d+(\.\d+)*)/i)),H&&(S.osversion=H);var V=!S.windows&&H.split(".")[0];return A||v||_=="ipad"||g&&(V==3||V>=4&&!O)||S.silk?S.tablet=t:(O||_=="iphone"||_=="ipod"||g||p||S.blackberry||S.webos||S.bada)&&(S.mobile=t),S.msedge||S.msie&&S.version>=10||S.yandexbrowser&&S.version>=15||S.vivaldi&&S.version>=1||S.chrome&&S.version>=20||S.samsungBrowser&&S.version>=4||S.whale&&a([S.version,"1.0"])===1||S.mzbrowser&&a([S.version,"6.0"])===1||S.focus&&a([S.version,"1.0"])===1||S.firefox&&S.version>=20||S.safari&&S.version>=6||S.opera&&S.version>=10||S.ios&&S.osversion&&S.osversion.split(".")[0]>=6||S.blackberry&&S.version>=10.1||S.chromium&&S.version>=20?S.a=t:S.msie&&S.version<10||S.chrome&&S.version<20||S.firefox&&S.version<20||S.safari&&S.version<6||S.opera&&S.version<10||S.ios&&S.osversion&&S.osversion.split(".")[0]<6||S.chromium&&S.version<20?S.c=t:S.x=t,S}var i=r(typeof navigator<"u"&&navigator.userAgent||"");i.test=function(h){for(var c=0;c<h.length;++c){var f=h[c];if(typeof f=="string"&&f in i)return!0}return!1};function n(h){return h.split(".").length}function s(h,c){var f=[],_;if(Array.prototype.map)return Array.prototype.map.call(h,c);for(_=0;_<h.length;_++)f.push(c(h[_]));return f}function a(h){for(var c=Math.max(n(h[0]),n(h[1])),f=s(h,function(_){var d=c-n(_);return _=_+new Array(d+1).join(".0"),s(_.split("."),function(g){return new Array(20-g.length).join("0")+g}).reverse()});--c>=0;){if(f[0][c]>f[1][c])return 1;if(f[0][c]===f[1][c]){if(c===0)return 0}else return-1}}function o(h,c,f){var _=i;typeof c=="string"&&(f=c,c=void 0),c===void 0&&(c=!1),f&&(_=r(f));var d=""+_.version;for(var g in h)if(h.hasOwnProperty(g)&&_[g]){if(typeof h[g]!="string")throw new Error("Browser version in the minVersion map should be a string: "+g+": "+String(h));return a([d,h[g]])<0}return c}function l(h,c,f){return!o(h,c,f)}return i.isUnsupportedBrowser=o,i.compareVersions=a,i.check=l,i._detect=r,i.detect=r,i})}(Ge)),Ge.exports}var St,Yi;function Ho(){if(Yi)return St;Yi=1;var e=Qr(),t=gs(),r=Jr(),i=ys(),n=Kr(),s=!!i.createImageBitmap&&!r.firefox,a={imageOrientation:"flipY",premultiplyAlpha:"premultiply"};function o(l){this._stage=l}return o.prototype.loadImage=function(l,h,c){var f=this,_=new Image;_.crossOrigin="anonymous";var d=h&&h.x||0,g=h&&h.y||0,p=h&&h.width||1,v=h&&h.height||1;c=n(c),_.onload=function(){f._handleLoad(_,d,g,p,v,c)},_.onerror=function(){f._handleError(l,c)},_.src=l;function w(){_.onload=_.onerror=null,_.src="",c.apply(null,arguments)}return w},o.prototype._handleLoad=function(l,h,c,f,_,d){if(h===0&&c===0&&f===1&&_===1){d(null,new e(l));return}if(h*=l.naturalWidth,c*=l.naturalHeight,f*=l.naturalWidth,_*=l.naturalHeight,s)i.createImageBitmap(l,h,c,f,_,a).then(function(v){d(null,new e(v))});else{var g=document.createElement("canvas");g.width=f,g.height=_;var p=g.getContext("2d");p.drawImage(l,h,c,f,_,0,0,f,_),d(null,new e(g))}},o.prototype._handleError=function(l,h){h(new t("Network error: "+l))},St=o,St}var Rt,Xi;function Qe(){if(Xi)return Rt;Xi=1;var e=1;function t(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var r=window.screen;if(r&&r.deviceXDPI&&r.logicalXDPI)return r.deviceXDPI/r.logicalXDPI;if(r&&r.systemXDPI&&r.logicalXDPI)return r.systemXDPI/r.logicalXDPI}return e}return Rt=t,Rt}var Lt,Bi;function $o(){if(Bi)return Lt;Bi=1;function e(t){return(t&t-1)==0}return Lt=e,Lt}var Pt,Ui;function ne(){if(Ui)return Pt;Ui=1;function e(p){for(var v=document.documentElement.style,w=["Moz","Webkit","Khtml","O","ms"],x=0;x<w.length;x++){var m=w[x],M=p[0].toUpperCase()+p.slice(1),u=m+M;if(u in v)return u}return p}function t(p){var v=e(p);return function(x){return x.style[v]}}function r(p){var v=e(p);return function(x,m){return x.style[v]=m}}var i=r("transform"),n=r("transformOrigin");function s(p){i(p,"translateZ(0)")}function a(p){n(p,"0 0 0")}function o(p){p.style.position="absolute"}function l(p,v,w){p.style.left=v+"px",p.style.top=w+"px"}function h(p,v,w){p.style.width=v+"px",p.style.height=w+"px"}function c(p){p.style.width=p.style.height=0}function f(p){p.style.width=p.style.height="100%"}function _(p){p.style.overflow="hidden"}function d(p){p.style.overflow="visible"}function g(p){p.style.pointerEvents="none"}return Pt={prefixProperty:e,getWithVendorPrefix:t,setWithVendorPrefix:r,setTransform:i,setTransformOrigin:n,setNullTransform:s,setNullTransformOrigin:a,setAbsolute:o,setPixelPosition:l,setPixelSize:h,setNullSize:c,setFullSize:f,setOverflowHidden:_,setOverflowVisible:d,setNoPointerEvents:g},Pt}var zt,Gi;function ws(){if(Gi)return zt;Gi=1;var e=Oo(),t=Ho(),r=Jr(),i=de(),n=Qe(),s=$o(),a=ne().setAbsolute,o=ne().setFullSize,l=U(),h={videoUseTexImage2D:r.chrome};function c(d,g){var p={alpha:!0,premultipliedAlpha:!0,antialias:!!(g&&g.antialias),preserveDrawingBuffer:!!(g&&g.preserveDrawingBuffer)},v=d.getContext&&(d.getContext("webgl",p)||d.getContext("experimental-webgl",p));if(!v)throw new Error("Could not get WebGL context");return g.wrapContext&&(v=g.wrapContext(v)),v}function f(d){d=d||{};var g=this;this.constructor.super_.call(this,d),this._generateMipmaps=d.generateMipmaps!=null?d.generateMipmaps:!1,this._loader=new t(this),this._domElement=document.createElement("canvas"),a(this._domElement),o(this._domElement),this._gl=c(this._domElement,d),this._handleContextLoss=function(){g.emit("webglcontextlost"),g._gl=null},this._domElement.addEventListener("webglcontextlost",this._handleContextLoss),this._rendererInstances=[]}i(f,e),f.prototype.destroy=function(){this._domElement.removeEventListener("webglcontextlost",this._handleContextLoss),this.constructor.super_.prototype.destroy.call(this)},f.prototype.domElement=function(){return this._domElement},f.prototype.webGlContext=function(){return this._gl},f.prototype.setSizeForType=function(){var d=n();this._domElement.width=d*this._width,this._domElement.height=d*this._height},f.prototype.loadImage=function(d,g,p){return this._loader.loadImage(d,g,p)},f.prototype.maxTextureSize=function(){return this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE)},f.prototype.validateLayer=function(d){var g=d.geometry().maxTileSize(),p=this.maxTextureSize();if(g>p)throw new Error("Layer has level with tile size larger than maximum texture size ("+g+" vs. "+p+")")},f.prototype.createRenderer=function(d){for(var g=this._rendererInstances,p=0;p<g.length;p++)if(g[p]instanceof d)return g[p];var v=new d(this._gl);return g.push(v),v},f.prototype.destroyRenderer=function(d){var g=this._rendererInstances;if(this._renderers.indexOf(d)<0){d.destroy();var p=g.indexOf(d);p>=0&&g.splice(p,1)}},f.prototype.startFrame=function(){var d=this._gl;if(!d)throw new Error("Bad WebGL context - maybe context was lost?");d.viewport(0,0,d.drawingBufferWidth,d.drawingBufferHeight),d.clearColor(0,0,0,0),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),d.enable(d.DEPTH_TEST),d.enable(d.BLEND),d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA)},f.prototype.endFrame=function(){},f.prototype.takeSnapshot=function(d){(typeof d!="object"||d==null)&&(d={});var g=d.quality;if(typeof g>"u"&&(g=75),typeof g!="number"||g<0||g>100)throw new Error("WebGLStage: Snapshot quality needs to be a number between 0 and 100");return this.render(),this._domElement.toDataURL("image/jpeg",g/100)},f.type=f.prototype.type="webgl";function _(d,g,p){this._stage=d,this._gl=d._gl,this._texture=null,this._timestamp=null,this._width=this._height=null,this.refresh(g,p)}return _.prototype.refresh=function(d,g){var p=this._gl,v=this._stage,w,x=g.timestamp();if(x!==this._timestamp){var m=g.element(),M=g.width(),u=g.height();if(M!==this._width||u!==this._height){var C=v.maxTextureSize();if(M>C)throw new Error("Texture width larger than max size ("+M+" vs. "+C+")");if(u>C)throw new Error("Texture height larger than max size ("+u+" vs. "+C+")");this._texture&&p.deleteTexture(w),w=this._texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,w),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!0),p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,m)}else w=this._texture,p.bindTexture(p.TEXTURE_2D,w),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!0),p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),m instanceof HTMLVideoElement&&h.videoUseTexImage2D?p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,m):p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,m);v._generateMipmaps&&s(M)&&s(u)?(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR_MIPMAP_LINEAR),p.generateMipmap(p.TEXTURE_2D)):(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR)),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.bindTexture(p.TEXTURE_2D,null),this._timestamp=x,this._width=M,this._height=u}},_.prototype.destroy=function(){this._texture&&this._gl.deleteTexture(this._texture),l(this)},f.TextureClass=f.prototype.TextureClass=_,zt=f,zt}var $=1e-6,W=typeof Float32Array<"u"?Float32Array:Array,ce=Math.random;function No(e){W=e}var Fo=Math.PI/180;function Vo(e){return e*Fo}function Wo(e,t){return Math.abs(e-t)<=$*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});const ko=Object.freeze(Object.defineProperty({__proto__:null,get ARRAY_TYPE(){return W},EPSILON:$,RANDOM:ce,equals:Wo,setMatrixArrayType:No,toRadian:Vo},Symbol.toStringTag,{value:"Module"}));function Yo(){var e=new W(4);return W!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function Xo(e){var t=new W(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Bo(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Uo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function Go(e,t,r,i){var n=new W(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function jo(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function Zo(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function Ko(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*s-n*i;return a?(a=1/a,e[0]=s*a,e[1]=-i*a,e[2]=-n*a,e[3]=r*a,e):null}function Qo(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e}function Jo(e){return e[0]*e[3]-e[2]*e[1]}function xs(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],l=r[1],h=r[2],c=r[3];return e[0]=i*o+s*l,e[1]=n*o+a*l,e[2]=i*h+s*c,e[3]=n*h+a*c,e}function eh(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+s*o,e[1]=n*l+a*o,e[2]=i*-o+s*l,e[3]=n*-o+a*l,e}function th(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],l=r[1];return e[0]=i*o,e[1]=n*o,e[2]=s*l,e[3]=a*l,e}function rh(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e}function ih(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function nh(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function sh(e){return Math.hypot(e[0],e[1],e[2],e[3])}function ah(e,t,r,i){return e[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-e[2]*r[1],[e,t,r]}function oh(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Ms(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function hh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function lh(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=t[0],o=t[1],l=t[2],h=t[3];return Math.abs(r-a)<=$*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=$*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-l)<=$*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-h)<=$*Math.max(1,Math.abs(s),Math.abs(h))}function ch(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function vh(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}var fh=xs,uh=Ms;const dh=Object.freeze(Object.defineProperty({__proto__:null,LDU:ah,add:oh,adjoint:Qo,clone:Xo,copy:Bo,create:Yo,determinant:Jo,equals:lh,exactEquals:hh,frob:sh,fromRotation:rh,fromScaling:ih,fromValues:Go,identity:Uo,invert:Ko,mul:fh,multiply:xs,multiplyScalar:ch,multiplyScalarAndAdd:vh,rotate:eh,scale:th,set:jo,str:nh,sub:uh,subtract:Ms,transpose:Zo},Symbol.toStringTag,{value:"Module"}));function ph(){var e=new W(6);return W!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function _h(e){var t=new W(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function mh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function yh(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function gh(e,t,r,i,n,s){var a=new W(6);return a[0]=e,a[1]=t,a[2]=r,a[3]=i,a[4]=n,a[5]=s,a}function wh(e,t,r,i,n,s,a){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e}function xh(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=r*s-i*n;return l?(l=1/l,e[0]=s*l,e[1]=-i*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*o-s*a)*l,e[5]=(i*a-r*o)*l,e):null}function Mh(e){return e[0]*e[3]-e[1]*e[2]}function Es(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=r[0],c=r[1],f=r[2],_=r[3],d=r[4],g=r[5];return e[0]=i*h+s*c,e[1]=n*h+a*c,e[2]=i*f+s*_,e[3]=n*f+a*_,e[4]=i*d+s*g+o,e[5]=n*d+a*g+l,e}function Eh(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=Math.sin(r),c=Math.cos(r);return e[0]=i*c+s*h,e[1]=n*c+a*h,e[2]=i*-h+s*c,e[3]=n*-h+a*c,e[4]=o,e[5]=l,e}function Th(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=r[0],c=r[1];return e[0]=i*h,e[1]=n*h,e[2]=s*c,e[3]=a*c,e[4]=o,e[5]=l,e}function bh(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=r[0],c=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=i*h+s*c+o,e[5]=n*h+a*c+l,e}function Ch(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e}function Sh(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function Rh(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function Lh(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function Ph(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function zh(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e}function Ts(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function Ah(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e}function Ih(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e}function qh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function Oh(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=t[0],h=t[1],c=t[2],f=t[3],_=t[4],d=t[5];return Math.abs(r-l)<=$*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-h)<=$*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-c)<=$*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(s-f)<=$*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-_)<=$*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(o-d)<=$*Math.max(1,Math.abs(o),Math.abs(d))}var Dh=Es,Hh=Ts;const $h=Object.freeze(Object.defineProperty({__proto__:null,add:zh,clone:_h,copy:mh,create:ph,determinant:Mh,equals:Oh,exactEquals:qh,frob:Ph,fromRotation:Ch,fromScaling:Sh,fromTranslation:Rh,fromValues:gh,identity:yh,invert:xh,mul:Dh,multiply:Es,multiplyScalar:Ah,multiplyScalarAndAdd:Ih,rotate:Eh,scale:Th,set:wh,str:Lh,sub:Hh,subtract:Ts,translate:bh},Symbol.toStringTag,{value:"Module"}));function bs(){var e=new W(9);return W!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Nh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Fh(e){var t=new W(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Vh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Wh(e,t,r,i,n,s,a,o,l){var h=new W(9);return h[0]=e,h[1]=t,h[2]=r,h[3]=i,h[4]=n,h[5]=s,h[6]=a,h[7]=o,h[8]=l,h}function kh(e,t,r,i,n,s,a,o,l,h){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=h,e}function Yh(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Xh(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Bh(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8],f=c*a-o*h,_=-c*s+o*l,d=h*s-a*l,g=r*f+i*_+n*d;return g?(g=1/g,e[0]=f*g,e[1]=(-c*i+n*h)*g,e[2]=(o*i-n*a)*g,e[3]=_*g,e[4]=(c*r-n*l)*g,e[5]=(-o*r+n*s)*g,e[6]=d*g,e[7]=(-h*r+i*l)*g,e[8]=(a*r-i*s)*g,e):null}function Uh(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8];return e[0]=a*c-o*h,e[1]=n*h-i*c,e[2]=i*o-n*a,e[3]=o*l-s*c,e[4]=r*c-n*l,e[5]=n*s-r*o,e[6]=s*h-a*l,e[7]=i*l-r*h,e[8]=r*a-i*s,e}function Gh(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8];return t*(h*s-a*l)+r*(-h*n+a*o)+i*(l*n-s*o)}function Cs(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=t[8],_=r[0],d=r[1],g=r[2],p=r[3],v=r[4],w=r[5],x=r[6],m=r[7],M=r[8];return e[0]=_*i+d*a+g*h,e[1]=_*n+d*o+g*c,e[2]=_*s+d*l+g*f,e[3]=p*i+v*a+w*h,e[4]=p*n+v*o+w*c,e[5]=p*s+v*l+w*f,e[6]=x*i+m*a+M*h,e[7]=x*n+m*o+M*c,e[8]=x*s+m*l+M*f,e}function jh(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=t[8],_=r[0],d=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=o,e[5]=l,e[6]=_*i+d*a+h,e[7]=_*n+d*o+c,e[8]=_*s+d*l+f,e}function Zh(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=t[8],_=Math.sin(r),d=Math.cos(r);return e[0]=d*i+_*a,e[1]=d*n+_*o,e[2]=d*s+_*l,e[3]=d*a-_*i,e[4]=d*o-_*n,e[5]=d*l-_*s,e[6]=h,e[7]=c,e[8]=f,e}function Kh(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Qh(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Jh(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function el(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function tl(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function rl(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,l=n+n,h=r*a,c=i*a,f=i*o,_=n*a,d=n*o,g=n*l,p=s*a,v=s*o,w=s*l;return e[0]=1-f-g,e[3]=c-w,e[6]=_+v,e[1]=c+w,e[4]=1-h-g,e[7]=d-p,e[2]=_-v,e[5]=d+p,e[8]=1-h-f,e}function il(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8],f=t[9],_=t[10],d=t[11],g=t[12],p=t[13],v=t[14],w=t[15],x=r*o-i*a,m=r*l-n*a,M=r*h-s*a,u=i*l-n*o,C=i*h-s*o,T=n*h-s*l,b=c*p-f*g,P=c*v-_*g,z=c*w-d*g,R=f*v-_*p,A=f*w-d*p,O=_*w-d*v,I=x*O-m*A+M*R+u*z-C*P+T*b;return I?(I=1/I,e[0]=(o*O-l*A+h*R)*I,e[1]=(l*z-a*O-h*P)*I,e[2]=(a*A-o*z+h*b)*I,e[3]=(n*A-i*O-s*R)*I,e[4]=(r*O-n*z+s*P)*I,e[5]=(i*z-r*A-s*b)*I,e[6]=(p*T-v*C+w*u)*I,e[7]=(v*M-g*T-w*m)*I,e[8]=(g*C-p*M+w*x)*I,e):null}function nl(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function sl(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function al(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function ol(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function Ss(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function hl(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function ll(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e}function cl(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function vl(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],c=e[8],f=t[0],_=t[1],d=t[2],g=t[3],p=t[4],v=t[5],w=t[6],x=t[7],m=t[8];return Math.abs(r-f)<=$*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-_)<=$*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(n-d)<=$*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-g)<=$*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(a-p)<=$*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-v)<=$*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(l-w)<=$*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(h-x)<=$*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(c-m)<=$*Math.max(1,Math.abs(c),Math.abs(m))}var fl=Cs,ul=Ss;const dl=Object.freeze(Object.defineProperty({__proto__:null,add:ol,adjoint:Uh,clone:Fh,copy:Vh,create:bs,determinant:Gh,equals:vl,exactEquals:cl,frob:al,fromMat2d:tl,fromMat4:Nh,fromQuat:rl,fromRotation:Jh,fromScaling:el,fromTranslation:Qh,fromValues:Wh,identity:Yh,invert:Bh,mul:fl,multiply:Cs,multiplyScalar:hl,multiplyScalarAndAdd:ll,normalFromMat4:il,projection:nl,rotate:Zh,scale:Kh,set:kh,str:sl,sub:ul,subtract:Ss,translate:jh,transpose:Xh},Symbol.toStringTag,{value:"Module"}));function pl(){var e=new W(16);return W!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function _l(e){var t=new W(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ml(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function yl(e,t,r,i,n,s,a,o,l,h,c,f,_,d,g,p){var v=new W(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=i,v[4]=n,v[5]=s,v[6]=a,v[7]=o,v[8]=l,v[9]=h,v[10]=c,v[11]=f,v[12]=_,v[13]=d,v[14]=g,v[15]=p,v}function gl(e,t,r,i,n,s,a,o,l,h,c,f,_,d,g,p,v){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=h,e[9]=c,e[10]=f,e[11]=_,e[12]=d,e[13]=g,e[14]=p,e[15]=v,e}function Rs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wl(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=s,e[11]=t[14],e[12]=n,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function xl(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8],f=t[9],_=t[10],d=t[11],g=t[12],p=t[13],v=t[14],w=t[15],x=r*o-i*a,m=r*l-n*a,M=r*h-s*a,u=i*l-n*o,C=i*h-s*o,T=n*h-s*l,b=c*p-f*g,P=c*v-_*g,z=c*w-d*g,R=f*v-_*p,A=f*w-d*p,O=_*w-d*v,I=x*O-m*A+M*R+u*z-C*P+T*b;return I?(I=1/I,e[0]=(o*O-l*A+h*R)*I,e[1]=(n*A-i*O-s*R)*I,e[2]=(p*T-v*C+w*u)*I,e[3]=(_*C-f*T-d*u)*I,e[4]=(l*z-a*O-h*P)*I,e[5]=(r*O-n*z+s*P)*I,e[6]=(v*M-g*T-w*m)*I,e[7]=(c*T-_*M+d*m)*I,e[8]=(a*A-o*z+h*b)*I,e[9]=(i*z-r*A-s*b)*I,e[10]=(g*C-p*M+w*x)*I,e[11]=(f*M-c*C-d*x)*I,e[12]=(o*P-a*R-l*b)*I,e[13]=(r*R-i*P+n*b)*I,e[14]=(p*m-g*u-v*x)*I,e[15]=(c*u-f*m+_*x)*I,e):null}function Ml(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8],f=t[9],_=t[10],d=t[11],g=t[12],p=t[13],v=t[14],w=t[15];return e[0]=o*(_*w-d*v)-f*(l*w-h*v)+p*(l*d-h*_),e[1]=-(i*(_*w-d*v)-f*(n*w-s*v)+p*(n*d-s*_)),e[2]=i*(l*w-h*v)-o*(n*w-s*v)+p*(n*h-s*l),e[3]=-(i*(l*d-h*_)-o*(n*d-s*_)+f*(n*h-s*l)),e[4]=-(a*(_*w-d*v)-c*(l*w-h*v)+g*(l*d-h*_)),e[5]=r*(_*w-d*v)-c*(n*w-s*v)+g*(n*d-s*_),e[6]=-(r*(l*w-h*v)-a*(n*w-s*v)+g*(n*h-s*l)),e[7]=r*(l*d-h*_)-a*(n*d-s*_)+c*(n*h-s*l),e[8]=a*(f*w-d*p)-c*(o*w-h*p)+g*(o*d-h*f),e[9]=-(r*(f*w-d*p)-c*(i*w-s*p)+g*(i*d-s*f)),e[10]=r*(o*w-h*p)-a*(i*w-s*p)+g*(i*h-s*o),e[11]=-(r*(o*d-h*f)-a*(i*d-s*f)+c*(i*h-s*o)),e[12]=-(a*(f*v-_*p)-c*(o*v-l*p)+g*(o*_-l*f)),e[13]=r*(f*v-_*p)-c*(i*v-n*p)+g*(i*_-n*f),e[14]=-(r*(o*v-l*p)-a*(i*v-n*p)+g*(i*l-n*o)),e[15]=r*(o*_-l*f)-a*(i*_-n*f)+c*(i*l-n*o),e}function El(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],c=e[9],f=e[10],_=e[11],d=e[12],g=e[13],p=e[14],v=e[15],w=t*a-r*s,x=t*o-i*s,m=t*l-n*s,M=r*o-i*a,u=r*l-n*a,C=i*l-n*o,T=h*g-c*d,b=h*p-f*d,P=h*v-_*d,z=c*p-f*g,R=c*v-_*g,A=f*v-_*p;return w*A-x*R+m*z+M*P-u*b+C*T}function Ls(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=t[8],_=t[9],d=t[10],g=t[11],p=t[12],v=t[13],w=t[14],x=t[15],m=r[0],M=r[1],u=r[2],C=r[3];return e[0]=m*i+M*o+u*f+C*p,e[1]=m*n+M*l+u*_+C*v,e[2]=m*s+M*h+u*d+C*w,e[3]=m*a+M*c+u*g+C*x,m=r[4],M=r[5],u=r[6],C=r[7],e[4]=m*i+M*o+u*f+C*p,e[5]=m*n+M*l+u*_+C*v,e[6]=m*s+M*h+u*d+C*w,e[7]=m*a+M*c+u*g+C*x,m=r[8],M=r[9],u=r[10],C=r[11],e[8]=m*i+M*o+u*f+C*p,e[9]=m*n+M*l+u*_+C*v,e[10]=m*s+M*h+u*d+C*w,e[11]=m*a+M*c+u*g+C*x,m=r[12],M=r[13],u=r[14],C=r[15],e[12]=m*i+M*o+u*f+C*p,e[13]=m*n+M*l+u*_+C*v,e[14]=m*s+M*h+u*d+C*w,e[15]=m*a+M*c+u*g+C*x,e}function Tl(e,t,r){var i=r[0],n=r[1],s=r[2],a,o,l,h,c,f,_,d,g,p,v,w;return t===e?(e[12]=t[0]*i+t[4]*n+t[8]*s+t[12],e[13]=t[1]*i+t[5]*n+t[9]*s+t[13],e[14]=t[2]*i+t[6]*n+t[10]*s+t[14],e[15]=t[3]*i+t[7]*n+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],h=t[3],c=t[4],f=t[5],_=t[6],d=t[7],g=t[8],p=t[9],v=t[10],w=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=h,e[4]=c,e[5]=f,e[6]=_,e[7]=d,e[8]=g,e[9]=p,e[10]=v,e[11]=w,e[12]=a*i+c*n+g*s+t[12],e[13]=o*i+f*n+p*s+t[13],e[14]=l*i+_*n+v*s+t[14],e[15]=h*i+d*n+w*s+t[15]),e}function bl(e,t,r){var i=r[0],n=r[1],s=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Cl(e,t,r,i){var n=i[0],s=i[1],a=i[2],o=Math.hypot(n,s,a),l,h,c,f,_,d,g,p,v,w,x,m,M,u,C,T,b,P,z,R,A,O,I,S;return o<$?null:(o=1/o,n*=o,s*=o,a*=o,l=Math.sin(r),h=Math.cos(r),c=1-h,f=t[0],_=t[1],d=t[2],g=t[3],p=t[4],v=t[5],w=t[6],x=t[7],m=t[8],M=t[9],u=t[10],C=t[11],T=n*n*c+h,b=s*n*c+a*l,P=a*n*c-s*l,z=n*s*c-a*l,R=s*s*c+h,A=a*s*c+n*l,O=n*a*c+s*l,I=s*a*c-n*l,S=a*a*c+h,e[0]=f*T+p*b+m*P,e[1]=_*T+v*b+M*P,e[2]=d*T+w*b+u*P,e[3]=g*T+x*b+C*P,e[4]=f*z+p*R+m*A,e[5]=_*z+v*R+M*A,e[6]=d*z+w*R+u*A,e[7]=g*z+x*R+C*A,e[8]=f*O+p*I+m*S,e[9]=_*O+v*I+M*S,e[10]=d*O+w*I+u*S,e[11]=g*O+x*I+C*S,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Sl(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=t[9],f=t[10],_=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*n+h*i,e[5]=a*n+c*i,e[6]=o*n+f*i,e[7]=l*n+_*i,e[8]=h*n-s*i,e[9]=c*n-a*i,e[10]=f*n-o*i,e[11]=_*n-l*i,e}function Rl(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],h=t[8],c=t[9],f=t[10],_=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n-h*i,e[1]=a*n-c*i,e[2]=o*n-f*i,e[3]=l*n-_*i,e[8]=s*i+h*n,e[9]=a*i+c*n,e[10]=o*i+f*n,e[11]=l*i+_*n,e}function Ll(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],h=t[4],c=t[5],f=t[6],_=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n+h*i,e[1]=a*n+c*i,e[2]=o*n+f*i,e[3]=l*n+_*i,e[4]=h*n-s*i,e[5]=c*n-a*i,e[6]=f*n-o*i,e[7]=_*n-l*i,e}function Pl(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function zl(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Al(e,t,r){var i=r[0],n=r[1],s=r[2],a=Math.hypot(i,n,s),o,l,h;return a<$?null:(a=1/a,i*=a,n*=a,s*=a,o=Math.sin(t),l=Math.cos(t),h=1-l,e[0]=i*i*h+l,e[1]=n*i*h+s*o,e[2]=s*i*h-n*o,e[3]=0,e[4]=i*n*h-s*o,e[5]=n*n*h+l,e[6]=s*n*h+i*o,e[7]=0,e[8]=i*s*h+n*o,e[9]=n*s*h-i*o,e[10]=s*s*h+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Il(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ql(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ol(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ps(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=i+i,l=n+n,h=s+s,c=i*o,f=i*l,_=i*h,d=n*l,g=n*h,p=s*h,v=a*o,w=a*l,x=a*h;return e[0]=1-(d+p),e[1]=f+x,e[2]=_-w,e[3]=0,e[4]=f-x,e[5]=1-(c+p),e[6]=g+v,e[7]=0,e[8]=_+w,e[9]=g-v,e[10]=1-(c+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Dl(e,t){var r=new W(3),i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=i*i+n*n+s*s+a*a;return f>0?(r[0]=(o*a+c*i+l*s-h*n)*2/f,r[1]=(l*a+c*n+h*i-o*s)*2/f,r[2]=(h*a+c*s+o*n-l*i)*2/f):(r[0]=(o*a+c*i+l*s-h*n)*2,r[1]=(l*a+c*n+h*i-o*s)*2,r[2]=(h*a+c*s+o*n-l*i)*2),Ps(e,t,r),e}function zs(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function As(e,t){var r=t[0],i=t[1],n=t[2],s=t[4],a=t[5],o=t[6],l=t[8],h=t[9],c=t[10];return e[0]=Math.hypot(r,i,n),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,h,c),e}function Is(e,t){var r=new W(3);As(r,t);var i=1/r[0],n=1/r[1],s=1/r[2],a=t[0]*i,o=t[1]*n,l=t[2]*s,h=t[4]*i,c=t[5]*n,f=t[6]*s,_=t[8]*i,d=t[9]*n,g=t[10]*s,p=a+c+g,v=0;return p>0?(v=Math.sqrt(p+1)*2,e[3]=.25*v,e[0]=(f-d)/v,e[1]=(_-l)/v,e[2]=(o-h)/v):a>c&&a>g?(v=Math.sqrt(1+a-c-g)*2,e[3]=(f-d)/v,e[0]=.25*v,e[1]=(o+h)/v,e[2]=(_+l)/v):c>g?(v=Math.sqrt(1+c-a-g)*2,e[3]=(_-l)/v,e[0]=(o+h)/v,e[1]=.25*v,e[2]=(f+d)/v):(v=Math.sqrt(1+g-a-c)*2,e[3]=(o-h)/v,e[0]=(_+l)/v,e[1]=(f+d)/v,e[2]=.25*v),e}function Hl(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3],l=n+n,h=s+s,c=a+a,f=n*l,_=n*h,d=n*c,g=s*h,p=s*c,v=a*c,w=o*l,x=o*h,m=o*c,M=i[0],u=i[1],C=i[2];return e[0]=(1-(g+v))*M,e[1]=(_+m)*M,e[2]=(d-x)*M,e[3]=0,e[4]=(_-m)*u,e[5]=(1-(f+v))*u,e[6]=(p+w)*u,e[7]=0,e[8]=(d+x)*C,e[9]=(p-w)*C,e[10]=(1-(f+g))*C,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function $l(e,t,r,i,n){var s=t[0],a=t[1],o=t[2],l=t[3],h=s+s,c=a+a,f=o+o,_=s*h,d=s*c,g=s*f,p=a*c,v=a*f,w=o*f,x=l*h,m=l*c,M=l*f,u=i[0],C=i[1],T=i[2],b=n[0],P=n[1],z=n[2],R=(1-(p+w))*u,A=(d+M)*u,O=(g-m)*u,I=(d-M)*C,S=(1-(_+w))*C,N=(v+x)*C,H=(g+m)*T,V=(v-x)*T,k=(1-(_+p))*T;return e[0]=R,e[1]=A,e[2]=O,e[3]=0,e[4]=I,e[5]=S,e[6]=N,e[7]=0,e[8]=H,e[9]=V,e[10]=k,e[11]=0,e[12]=r[0]+b-(R*b+I*P+H*z),e[13]=r[1]+P-(A*b+S*P+V*z),e[14]=r[2]+z-(O*b+N*P+k*z),e[15]=1,e}function Nl(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,l=n+n,h=r*a,c=i*a,f=i*o,_=n*a,d=n*o,g=n*l,p=s*a,v=s*o,w=s*l;return e[0]=1-f-g,e[1]=c+w,e[2]=_-v,e[3]=0,e[4]=c-w,e[5]=1-h-g,e[6]=d+p,e[7]=0,e[8]=_+v,e[9]=d-p,e[10]=1-h-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fl(e,t,r,i,n,s,a){var o=1/(r-t),l=1/(n-i),h=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(n+i)*l,e[10]=(a+s)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*h,e[15]=0,e}function Vl(e,t,r,i,n){var s=1/Math.tan(t/2),a;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(a=1/(i-n),e[10]=(n+i)*a,e[14]=2*n*i*a):(e[10]=-1,e[14]=-2*i),e}function Wl(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),h=2/(n+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(n-s)*h*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function kl(e,t,r,i,n,s,a){var o=1/(t-r),l=1/(i-n),h=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*l,e[14]=(a+s)*h,e[15]=1,e}function Yl(e,t,r,i){var n,s,a,o,l,h,c,f,_,d,g=t[0],p=t[1],v=t[2],w=i[0],x=i[1],m=i[2],M=r[0],u=r[1],C=r[2];return Math.abs(g-M)<$&&Math.abs(p-u)<$&&Math.abs(v-C)<$?Rs(e):(c=g-M,f=p-u,_=v-C,d=1/Math.hypot(c,f,_),c*=d,f*=d,_*=d,n=x*_-m*f,s=m*c-w*_,a=w*f-x*c,d=Math.hypot(n,s,a),d?(d=1/d,n*=d,s*=d,a*=d):(n=0,s=0,a=0),o=f*a-_*s,l=_*n-c*a,h=c*s-f*n,d=Math.hypot(o,l,h),d?(d=1/d,o*=d,l*=d,h*=d):(o=0,l=0,h=0),e[0]=n,e[1]=o,e[2]=c,e[3]=0,e[4]=s,e[5]=l,e[6]=f,e[7]=0,e[8]=a,e[9]=h,e[10]=_,e[11]=0,e[12]=-(n*g+s*p+a*v),e[13]=-(o*g+l*p+h*v),e[14]=-(c*g+f*p+_*v),e[15]=1,e)}function Xl(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=i[0],l=i[1],h=i[2],c=n-r[0],f=s-r[1],_=a-r[2],d=c*c+f*f+_*_;d>0&&(d=1/Math.sqrt(d),c*=d,f*=d,_*=d);var g=l*_-h*f,p=h*c-o*_,v=o*f-l*c;return d=g*g+p*p+v*v,d>0&&(d=1/Math.sqrt(d),g*=d,p*=d,v*=d),e[0]=g,e[1]=p,e[2]=v,e[3]=0,e[4]=f*v-_*p,e[5]=_*g-c*v,e[6]=c*p-f*g,e[7]=0,e[8]=c,e[9]=f,e[10]=_,e[11]=0,e[12]=n,e[13]=s,e[14]=a,e[15]=1,e}function Bl(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Ul(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Gl(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function qs(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function jl(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Zl(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function Kl(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Ql(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],c=e[8],f=e[9],_=e[10],d=e[11],g=e[12],p=e[13],v=e[14],w=e[15],x=t[0],m=t[1],M=t[2],u=t[3],C=t[4],T=t[5],b=t[6],P=t[7],z=t[8],R=t[9],A=t[10],O=t[11],I=t[12],S=t[13],N=t[14],H=t[15];return Math.abs(r-x)<=$*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-m)<=$*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(n-M)<=$*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(s-u)<=$*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(a-C)<=$*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(o-T)<=$*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(l-b)<=$*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(h-P)<=$*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(c-z)<=$*Math.max(1,Math.abs(c),Math.abs(z))&&Math.abs(f-R)<=$*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(_-A)<=$*Math.max(1,Math.abs(_),Math.abs(A))&&Math.abs(d-O)<=$*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-I)<=$*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(p-S)<=$*Math.max(1,Math.abs(p),Math.abs(S))&&Math.abs(v-N)<=$*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(w-H)<=$*Math.max(1,Math.abs(w),Math.abs(H))}var Jl=Ls,ec=qs;const tc=Object.freeze(Object.defineProperty({__proto__:null,add:Gl,adjoint:Ml,clone:_l,copy:ml,create:pl,determinant:El,equals:Ql,exactEquals:Kl,frob:Ul,fromQuat:Nl,fromQuat2:Dl,fromRotation:Al,fromRotationTranslation:Ps,fromRotationTranslationScale:Hl,fromRotationTranslationScaleOrigin:$l,fromScaling:zl,fromTranslation:Pl,fromValues:yl,fromXRotation:Il,fromYRotation:ql,fromZRotation:Ol,frustum:Fl,getRotation:Is,getScaling:As,getTranslation:zs,identity:Rs,invert:xl,lookAt:Yl,mul:Jl,multiply:Ls,multiplyScalar:jl,multiplyScalarAndAdd:Zl,ortho:kl,perspective:Vl,perspectiveFromFieldOfView:Wl,rotate:Cl,rotateX:Sl,rotateY:Rl,rotateZ:Ll,scale:bl,set:gl,str:Bl,sub:ec,subtract:qs,targetTo:Xl,translate:Tl,transpose:wl},Symbol.toStringTag,{value:"Module"}));function ei(){var e=new W(3);return W!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function rc(e){var t=new W(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Os(e){var t=e[0],r=e[1],i=e[2];return Math.hypot(t,r,i)}function Zr(e,t,r){var i=new W(3);return i[0]=e,i[1]=t,i[2]=r,i}function ic(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function nc(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function sc(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Ds(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Hs(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function $s(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function ac(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function oc(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function hc(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function lc(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function cc(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function vc(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function fc(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e}function Ns(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.hypot(r,i,n)}function Fs(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n}function Vs(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function uc(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function dc(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Ws(e,t){var r=t[0],i=t[1],n=t[2],s=r*r+i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function ti(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function je(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],l=r[2];return e[0]=n*l-s*o,e[1]=s*a-i*l,e[2]=i*o-n*a,e}function pc(e,t,r,i){var n=t[0],s=t[1],a=t[2];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=a+i*(r[2]-a),e}function _c(e,t,r,i,n,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,h=a*(s-1),c=a*(3-2*s);return e[0]=t[0]*o+r[0]*l+i[0]*h+n[0]*c,e[1]=t[1]*o+r[1]*l+i[1]*h+n[1]*c,e[2]=t[2]*o+r[2]*l+i[2]*h+n[2]*c,e}function mc(e,t,r,i,n,s){var a=1-s,o=a*a,l=s*s,h=o*a,c=3*s*o,f=3*l*a,_=l*s;return e[0]=t[0]*h+r[0]*c+i[0]*f+n[0]*_,e[1]=t[1]*h+r[1]*c+i[1]*f+n[1]*_,e[2]=t[2]*h+r[2]*c+i[2]*f+n[2]*_,e}function yc(e,t){t=t||1;var r=ce()*2*Math.PI,i=ce()*2-1,n=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*n,e[1]=Math.sin(r)*n,e[2]=i*t,e}function gc(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[3]*i+r[7]*n+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*i+r[4]*n+r[8]*s+r[12])/a,e[1]=(r[1]*i+r[5]*n+r[9]*s+r[13])/a,e[2]=(r[2]*i+r[6]*n+r[10]*s+r[14])/a,e}function wc(e,t,r){var i=t[0],n=t[1],s=t[2];return e[0]=i*r[0]+n*r[3]+s*r[6],e[1]=i*r[1]+n*r[4]+s*r[7],e[2]=i*r[2]+n*r[5]+s*r[8],e}function xc(e,t,r){var i=r[0],n=r[1],s=r[2],a=r[3],o=t[0],l=t[1],h=t[2],c=n*h-s*l,f=s*o-i*h,_=i*l-n*o,d=n*_-s*f,g=s*c-i*_,p=i*f-n*c,v=a*2;return c*=v,f*=v,_*=v,d*=2,g*=2,p*=2,e[0]=o+c+d,e[1]=l+f+g,e[2]=h+_+p,e}function Mc(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0],s[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),s[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function Ec(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),s[1]=n[1],s[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function Tc(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),s[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),s[2]=n[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function bc(e,t){var r=e[0],i=e[1],n=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(r*r+i*i+n*n),h=Math.sqrt(s*s+a*a+o*o),c=l*h,f=c&&ti(e,t)/c;return Math.acos(Math.min(Math.max(f,-1),1))}function Cc(e){return e[0]=0,e[1]=0,e[2]=0,e}function Sc(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Rc(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Lc(e,t){var r=e[0],i=e[1],n=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(r-s)<=$*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=$*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-o)<=$*Math.max(1,Math.abs(n),Math.abs(o))}var Pc=Ds,zc=Hs,Ac=$s,Ic=Ns,qc=Fs,ks=Os,Oc=Vs,Dc=function(){var e=ei();return function(t,r,i,n,s,a){var o,l;for(r||(r=3),i||(i=0),n?l=Math.min(n*r+i,t.length):l=t.length,o=i;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();const Hc=Object.freeze(Object.defineProperty({__proto__:null,add:sc,angle:bc,bezier:mc,ceil:ac,clone:rc,copy:ic,create:ei,cross:je,dist:Ic,distance:Ns,div:Ac,divide:$s,dot:ti,equals:Lc,exactEquals:Rc,floor:oc,forEach:Dc,fromValues:Zr,hermite:_c,inverse:dc,len:ks,length:Os,lerp:pc,max:lc,min:hc,mul:zc,multiply:Hs,negate:uc,normalize:Ws,random:yc,rotateX:Mc,rotateY:Ec,rotateZ:Tc,round:cc,scale:vc,scaleAndAdd:fc,set:nc,sqrDist:qc,sqrLen:Oc,squaredDistance:Fs,squaredLength:Vs,str:Sc,sub:Pc,subtract:Ds,transformMat3:wc,transformMat4:gc,transformQuat:xc,zero:Cc},Symbol.toStringTag,{value:"Module"}));function Ys(){var e=new W(4);return W!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Xs(e){var t=new W(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Bs(e,t,r,i){var n=new W(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function Us(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Gs(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function js(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Zs(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Ks(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Qs(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function $c(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Nc(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Fc(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Vc(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Wc(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Js(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function kc(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function ea(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,i,n,s)}function ta(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return r*r+i*i+n*n+s*s}function ri(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.hypot(t,r,i,n)}function ii(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function Yc(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Xc(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function ra(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=i*a,e[2]=n*a,e[3]=s*a,e}function ia(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Bc(e,t,r,i){var n=r[0]*i[1]-r[1]*i[0],s=r[0]*i[2]-r[2]*i[0],a=r[0]*i[3]-r[3]*i[0],o=r[1]*i[2]-r[2]*i[1],l=r[1]*i[3]-r[3]*i[1],h=r[2]*i[3]-r[3]*i[2],c=t[0],f=t[1],_=t[2],d=t[3];return e[0]=f*h-_*l+d*o,e[1]=-(c*h)+_*a-d*s,e[2]=c*l-f*a+d*n,e[3]=-(c*o)+f*s-_*n,e}function na(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=a+i*(r[2]-a),e[3]=o+i*(r[3]-o),e}function Uc(e,t){t=t||1;var r,i,n,s,a,o;do r=ce()*2-1,i=ce()*2-1,a=r*r+i*i;while(a>=1);do n=ce()*2-1,s=ce()*2-1,o=n*n+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*r,e[1]=t*i,e[2]=t*n*l,e[3]=t*s*l,e}function Gc(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*s+r[12]*a,e[1]=r[1]*i+r[5]*n+r[9]*s+r[13]*a,e[2]=r[2]*i+r[6]*n+r[10]*s+r[14]*a,e[3]=r[3]*i+r[7]*n+r[11]*s+r[15]*a,e}function jc(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],l=r[2],h=r[3],c=h*i+o*s-l*n,f=h*n+l*i-a*s,_=h*s+a*n-o*i,d=-a*i-o*n-l*s;return e[0]=c*h+d*-a+f*-l-_*-o,e[1]=f*h+d*-o+_*-a-c*-l,e[2]=_*h+d*-l+c*-o-f*-a,e[3]=t[3],e}function Zc(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Kc(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function sa(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function aa(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=t[0],o=t[1],l=t[2],h=t[3];return Math.abs(r-a)<=$*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=$*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-l)<=$*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-h)<=$*Math.max(1,Math.abs(s),Math.abs(h))}var Qc=Zs,Jc=Ks,ev=Qs,tv=ea,rv=ta,iv=ri,nv=ii,sv=function(){var e=Ys();return function(t,r,i,n,s,a){var o,l;for(r||(r=4),i||(i=0),n?l=Math.min(n*r+i,t.length):l=t.length,o=i;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();const av=Object.freeze(Object.defineProperty({__proto__:null,add:js,ceil:$c,clone:Xs,copy:Us,create:Ys,cross:Bc,dist:tv,distance:ea,div:ev,divide:Qs,dot:ia,equals:aa,exactEquals:sa,floor:Nc,forEach:sv,fromValues:Bs,inverse:Xc,len:iv,length:ri,lerp:na,max:Vc,min:Fc,mul:Jc,multiply:Ks,negate:Yc,normalize:ra,random:Uc,round:Wc,scale:Js,scaleAndAdd:kc,set:Gs,sqrDist:rv,sqrLen:nv,squaredDistance:ta,squaredLength:ii,str:Kc,sub:Qc,subtract:Zs,transformMat4:Gc,transformQuat:jc,zero:Zc},Symbol.toStringTag,{value:"Module"}));function Ke(){var e=new W(4);return W!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function ov(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function oa(e,t,r){r=r*.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function hv(e,t){var r=Math.acos(t[3])*2,i=Math.sin(r/2);return i>$?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),r}function lv(e,t){var r=si(e,t);return Math.acos(2*r*r-1)}function ha(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],l=r[1],h=r[2],c=r[3];return e[0]=i*c+a*o+n*h-s*l,e[1]=n*c+a*l+s*o-i*h,e[2]=s*c+a*h+i*l-n*o,e[3]=a*c-i*o-n*l-s*h,e}function la(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+a*o,e[1]=n*l+s*o,e[2]=s*l-n*o,e[3]=a*l-i*o,e}function ca(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l-s*o,e[1]=n*l+a*o,e[2]=s*l+i*o,e[3]=a*l-n*o,e}function va(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+n*o,e[1]=n*l-i*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function cv(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e}function fa(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=Math.sqrt(r*r+i*i+n*n),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return e[0]=r*l,e[1]=i*l,e[2]=n*l,e[3]=o*Math.cos(a),e}function ua(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=Math.sqrt(r*r+i*i+n*n),o=a>0?Math.atan2(a,s)/a:0;return e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=.5*Math.log(r*r+i*i+n*n+s*s),e}function vv(e,t,r){return ua(e,t),pa(e,e,r),fa(e,e),e}function Ze(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3],l=r[0],h=r[1],c=r[2],f=r[3],_,d,g,p,v;return d=n*l+s*h+a*c+o*f,d<0&&(d=-d,l=-l,h=-h,c=-c,f=-f),1-d>$?(_=Math.acos(d),g=Math.sin(_),p=Math.sin((1-i)*_)/g,v=Math.sin(i*_)/g):(p=1-i,v=i),e[0]=p*n+v*l,e[1]=p*s+v*h,e[2]=p*a+v*c,e[3]=p*o+v*f,e}function fv(e){var t=ce(),r=ce(),i=ce(),n=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=n*Math.sin(2*Math.PI*r),e[1]=n*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*i),e[3]=s*Math.cos(2*Math.PI*i),e}function uv(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s,o=a?1/a:0;return e[0]=-r*o,e[1]=-i*o,e[2]=-n*o,e[3]=s*o,e}function dv(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function da(e,t){var r=t[0]+t[4]+t[8],i;if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);var s=(n+1)%3,a=(n+2)%3;i=Math.sqrt(t[n*3+n]-t[s*3+s]-t[a*3+a]+1),e[n]=.5*i,i=.5/i,e[3]=(t[s*3+a]-t[a*3+s])*i,e[s]=(t[s*3+n]+t[n*3+s])*i,e[a]=(t[a*3+n]+t[n*3+a])*i}return e}function pv(e,t,r,i){var n=.5*Math.PI/180;t*=n,r*=n,i*=n;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(r),l=Math.cos(r),h=Math.sin(i),c=Math.cos(i);return e[0]=s*l*c-a*o*h,e[1]=a*o*c+s*l*h,e[2]=a*l*h-s*o*c,e[3]=a*l*c+s*o*h,e}function _v(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var mv=Xs,yv=Bs,ni=Us,gv=Gs,wv=js,xv=ha,pa=Js,si=ia,Mv=na,ai=ri,Ev=ai,oi=ii,Tv=oi,hi=ra,bv=sa,Cv=aa,Sv=function(){var e=ei(),t=Zr(1,0,0),r=Zr(0,1,0);return function(i,n,s){var a=ti(n,s);return a<-.999999?(je(e,t,n),ks(e)<1e-6&&je(e,r,n),Ws(e,e),oa(i,e,Math.PI),i):a>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(je(e,n,s),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+a,hi(i,i))}}(),Rv=function(){var e=Ke(),t=Ke();return function(r,i,n,s,a,o){return Ze(e,i,a,o),Ze(t,n,s,o),Ze(r,e,t,2*o*(1-o)),r}}(),Lv=function(){var e=bs();return function(t,r,i,n){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],hi(t,da(t,e))}}();const Pv=Object.freeze(Object.defineProperty({__proto__:null,add:wv,calculateW:cv,clone:mv,conjugate:dv,copy:ni,create:Ke,dot:si,equals:Cv,exactEquals:bv,exp:fa,fromEuler:pv,fromMat3:da,fromValues:yv,getAngle:lv,getAxisAngle:hv,identity:ov,invert:uv,len:Ev,length:ai,lerp:Mv,ln:ua,mul:xv,multiply:ha,normalize:hi,pow:vv,random:fv,rotateX:la,rotateY:ca,rotateZ:va,rotationTo:Sv,scale:pa,set:gv,setAxes:Lv,setAxisAngle:oa,slerp:Ze,sqlerp:Rv,sqrLen:Tv,squaredLength:oi,str:_v},Symbol.toStringTag,{value:"Module"}));function zv(){var e=new W(8);return W!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function Av(e){var t=new W(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Iv(e,t,r,i,n,s,a,o){var l=new W(8);return l[0]=e,l[1]=t,l[2]=r,l[3]=i,l[4]=n,l[5]=s,l[6]=a,l[7]=o,l}function qv(e,t,r,i,n,s,a){var o=new W(8);o[0]=e,o[1]=t,o[2]=r,o[3]=i;var l=n*.5,h=s*.5,c=a*.5;return o[4]=l*i+h*r-c*t,o[5]=h*i+c*e-l*r,o[6]=c*i+l*t-h*e,o[7]=-l*e-h*t-c*r,o}function _a(e,t,r){var i=r[0]*.5,n=r[1]*.5,s=r[2]*.5,a=t[0],o=t[1],l=t[2],h=t[3];return e[0]=a,e[1]=o,e[2]=l,e[3]=h,e[4]=i*h+n*l-s*o,e[5]=n*h+s*a-i*l,e[6]=s*h+i*o-n*a,e[7]=-i*a-n*o-s*l,e}function Ov(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0]*.5,e[5]=t[1]*.5,e[6]=t[2]*.5,e[7]=0,e}function Dv(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Hv(e,t){var r=Ke();Is(r,t);var i=new W(3);return zs(i,t),_a(e,r,i),e}function ma(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function $v(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Nv(e,t,r,i,n,s,a,o,l){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e}var Fv=ni;function Vv(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var Wv=ni;function kv(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function Yv(e,t){var r=t[4],i=t[5],n=t[6],s=t[7],a=-t[0],o=-t[1],l=-t[2],h=t[3];return e[0]=(r*h+s*a+i*l-n*o)*2,e[1]=(i*h+s*o+n*a-r*l)*2,e[2]=(n*h+s*l+r*o-i*a)*2,e}function Xv(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0]*.5,l=r[1]*.5,h=r[2]*.5,c=t[4],f=t[5],_=t[6],d=t[7];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=a*o+n*h-s*l+c,e[5]=a*l+s*o-i*h+f,e[6]=a*h+i*l-n*o+_,e[7]=-i*o-n*l-s*h+d,e}function Bv(e,t,r){var i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=o*a+c*i+l*s-h*n,_=l*a+c*n+h*i-o*s,d=h*a+c*s+o*n-l*i,g=c*a-o*i-l*n-h*s;return la(e,t,r),i=e[0],n=e[1],s=e[2],a=e[3],e[4]=f*a+g*i+_*s-d*n,e[5]=_*a+g*n+d*i-f*s,e[6]=d*a+g*s+f*n-_*i,e[7]=g*a-f*i-_*n-d*s,e}function Uv(e,t,r){var i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=o*a+c*i+l*s-h*n,_=l*a+c*n+h*i-o*s,d=h*a+c*s+o*n-l*i,g=c*a-o*i-l*n-h*s;return ca(e,t,r),i=e[0],n=e[1],s=e[2],a=e[3],e[4]=f*a+g*i+_*s-d*n,e[5]=_*a+g*n+d*i-f*s,e[6]=d*a+g*s+f*n-_*i,e[7]=g*a-f*i-_*n-d*s,e}function Gv(e,t,r){var i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],f=o*a+c*i+l*s-h*n,_=l*a+c*n+h*i-o*s,d=h*a+c*s+o*n-l*i,g=c*a-o*i-l*n-h*s;return va(e,t,r),i=e[0],n=e[1],s=e[2],a=e[3],e[4]=f*a+g*i+_*s-d*n,e[5]=_*a+g*n+d*i-f*s,e[6]=d*a+g*s+f*n-_*i,e[7]=g*a-f*i-_*n-d*s,e}function jv(e,t,r){var i=r[0],n=r[1],s=r[2],a=r[3],o=t[0],l=t[1],h=t[2],c=t[3];return e[0]=o*a+c*i+l*s-h*n,e[1]=l*a+c*n+h*i-o*s,e[2]=h*a+c*s+o*n-l*i,e[3]=c*a-o*i-l*n-h*s,o=t[4],l=t[5],h=t[6],c=t[7],e[4]=o*a+c*i+l*s-h*n,e[5]=l*a+c*n+h*i-o*s,e[6]=h*a+c*s+o*n-l*i,e[7]=c*a-o*i-l*n-h*s,e}function Zv(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],l=r[1],h=r[2],c=r[3];return e[0]=i*c+a*o+n*h-s*l,e[1]=n*c+a*l+s*o-i*h,e[2]=s*c+a*h+i*l-n*o,e[3]=a*c-i*o-n*l-s*h,o=r[4],l=r[5],h=r[6],c=r[7],e[4]=i*c+a*o+n*h-s*l,e[5]=n*c+a*l+s*o-i*h,e[6]=s*c+a*h+i*l-n*o,e[7]=a*c-i*o-n*l-s*h,e}function Kv(e,t,r,i){if(Math.abs(i)<$)return ma(e,t);var n=Math.hypot(r[0],r[1],r[2]);i=i*.5;var s=Math.sin(i),a=s*r[0]/n,o=s*r[1]/n,l=s*r[2]/n,h=Math.cos(i),c=t[0],f=t[1],_=t[2],d=t[3];e[0]=c*h+d*a+f*l-_*o,e[1]=f*h+d*o+_*a-c*l,e[2]=_*h+d*l+c*o-f*a,e[3]=d*h-c*a-f*o-_*l;var g=t[4],p=t[5],v=t[6],w=t[7];return e[4]=g*h+w*a+p*l-v*o,e[5]=p*h+w*o+v*a-g*l,e[6]=v*h+w*l+g*o-p*a,e[7]=w*h-g*a-p*o-v*l,e}function Qv(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e}function ya(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[4],l=r[5],h=r[6],c=r[7],f=t[4],_=t[5],d=t[6],g=t[7],p=r[0],v=r[1],w=r[2],x=r[3];return e[0]=i*x+a*p+n*w-s*v,e[1]=n*x+a*v+s*p-i*w,e[2]=s*x+a*w+i*v-n*p,e[3]=a*x-i*p-n*v-s*w,e[4]=i*c+a*o+n*h-s*l+f*x+g*p+_*w-d*v,e[5]=n*c+a*l+s*o-i*h+_*x+g*v+d*p-f*w,e[6]=s*c+a*h+i*l-n*o+d*x+g*w+f*v-_*p,e[7]=a*c-i*o-n*l-s*h+g*x-f*p-_*v-d*w,e}var Jv=ya;function ef(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e}var ga=si;function tf(e,t,r,i){var n=1-i;return ga(t,r)<0&&(i=-i),e[0]=t[0]*n+r[0]*i,e[1]=t[1]*n+r[1]*i,e[2]=t[2]*n+r[2]*i,e[3]=t[3]*n+r[3]*i,e[4]=t[4]*n+r[4]*i,e[5]=t[5]*n+r[5]*i,e[6]=t[6]*n+r[6]*i,e[7]=t[7]*n+r[7]*i,e}function rf(e,t){var r=Je(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e}function nf(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var wa=ai,sf=wa,Je=oi,af=Je;function of(e,t){var r=Je(t);if(r>0){r=Math.sqrt(r);var i=t[0]/r,n=t[1]/r,s=t[2]/r,a=t[3]/r,o=t[4],l=t[5],h=t[6],c=t[7],f=i*o+n*l+s*h+a*c;e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=(o-i*f)/r,e[5]=(l-n*f)/r,e[6]=(h-s*f)/r,e[7]=(c-a*f)/r}return e}function hf(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function lf(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function cf(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],c=t[0],f=t[1],_=t[2],d=t[3],g=t[4],p=t[5],v=t[6],w=t[7];return Math.abs(r-c)<=$*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-f)<=$*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(n-_)<=$*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(s-d)<=$*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-g)<=$*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-p)<=$*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(l-v)<=$*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(h-w)<=$*Math.max(1,Math.abs(h),Math.abs(w))}const vf=Object.freeze(Object.defineProperty({__proto__:null,add:Qv,clone:Av,conjugate:nf,copy:ma,create:zv,dot:ga,equals:cf,exactEquals:lf,fromMat4:Hv,fromRotation:Dv,fromRotationTranslation:_a,fromRotationTranslationValues:qv,fromTranslation:Ov,fromValues:Iv,getDual:Vv,getReal:Fv,getTranslation:Yv,identity:$v,invert:rf,len:sf,length:wa,lerp:tf,mul:Jv,multiply:ya,normalize:of,rotateAroundAxis:Kv,rotateByQuatAppend:jv,rotateByQuatPrepend:Zv,rotateX:Bv,rotateY:Uv,rotateZ:Gv,scale:ef,set:Nv,setDual:kv,setReal:Wv,sqrLen:af,squaredLength:Je,str:hf,translate:Xv},Symbol.toStringTag,{value:"Module"}));function xa(){var e=new W(2);return W!=Float32Array&&(e[0]=0,e[1]=0),e}function ff(e){var t=new W(2);return t[0]=e[0],t[1]=e[1],t}function uf(e,t){var r=new W(2);return r[0]=e,r[1]=t,r}function df(e,t){return e[0]=t[0],e[1]=t[1],e}function pf(e,t,r){return e[0]=t,e[1]=r,e}function _f(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Ma(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Ea(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function Ta(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function mf(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function yf(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function gf(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function wf(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function xf(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Mf(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Ef(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function ba(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.hypot(r,i)}function Ca(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function Sa(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function Ra(e){var t=e[0],r=e[1];return t*t+r*r}function Tf(e,t){return e[0]=-t[0],e[1]=-t[1],e}function bf(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function Cf(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e}function Sf(e,t){return e[0]*t[0]+e[1]*t[1]}function Rf(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function Lf(e,t,r,i){var n=t[0],s=t[1];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e}function Pf(e,t){t=t||1;var r=ce()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function zf(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e}function Af(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e}function If(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e}function qf(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e}function Of(e,t,r,i){var n=t[0]-r[0],s=t[1]-r[1],a=Math.sin(i),o=Math.cos(i);return e[0]=n*o-s*a+r[0],e[1]=n*a+s*o+r[1],e}function Df(e,t){var r=e[0],i=e[1],n=t[0],s=t[1],a=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+s*s),o=a&&(r*n+i*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function Hf(e){return e[0]=0,e[1]=0,e}function $f(e){return"vec2("+e[0]+", "+e[1]+")"}function Nf(e,t){return e[0]===t[0]&&e[1]===t[1]}function Ff(e,t){var r=e[0],i=e[1],n=t[0],s=t[1];return Math.abs(r-n)<=$*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-s)<=$*Math.max(1,Math.abs(i),Math.abs(s))}var Vf=Sa,Wf=Ma,kf=Ea,Yf=Ta,Xf=ba,Bf=Ca,Uf=Ra,Gf=function(){var e=xa();return function(t,r,i,n,s,a){var o,l;for(r||(r=2),i||(i=0),n?l=Math.min(n*r+i,t.length):l=t.length,o=i;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();const jf=Object.freeze(Object.defineProperty({__proto__:null,add:_f,angle:Df,ceil:mf,clone:ff,copy:df,create:xa,cross:Rf,dist:Xf,distance:ba,div:Yf,divide:Ta,dot:Sf,equals:Ff,exactEquals:Nf,floor:yf,forEach:Gf,fromValues:uf,inverse:bf,len:Vf,length:Sa,lerp:Lf,max:wf,min:gf,mul:kf,multiply:Ea,negate:Tf,normalize:Cf,random:Pf,rotate:Of,round:xf,scale:Mf,scaleAndAdd:Ef,set:pf,sqrDist:Bf,sqrLen:Uf,squaredDistance:Ca,squaredLength:Ra,str:$f,sub:Wf,subtract:Ma,transformMat2:zf,transformMat2d:Af,transformMat3:If,transformMat4:qf,zero:Hf},Symbol.toStringTag,{value:"Module"})),Zf=Object.freeze(Object.defineProperty({__proto__:null,glMatrix:ko,mat2:dh,mat2d:$h,mat3:dl,mat4:tc,quat:Pv,quat2:vf,vec2:jf,vec3:Hc,vec4:av},Symbol.toStringTag,{value:"Module"})),Q=Io(Zf);var At,ji;function Le(){if(ji)return At;ji=1;function e(t,r,i){return Math.min(Math.max(t,r),i)}return At=e,At}var It,Zi;function La(){if(Zi)return It;Zi=1;var e=256,t=256,r=Le(),i=Q.vec4,n=Q.vec3,s=Q.mat4;function a(T,b,P){var z=T.createShader(b);if(T.shaderSource(z,P),T.compileShader(z),!T.getShaderParameter(z,T.COMPILE_STATUS))throw T.getShaderInfoLog(z);return z}function o(T,b,P,z,R){var A=a(T,T.VERTEX_SHADER,b),O=a(T,T.FRAGMENT_SHADER,P),I=T.createProgram();if(T.attachShader(I,A),T.attachShader(I,O),T.linkProgram(I),!T.getProgramParameter(I,T.LINK_STATUS))throw T.getProgramInfoLog(I);for(var S=0;S<z.length;S++){var N=z[S];if(I[N]=T.getAttribLocation(I,N),I[N]===-1)throw new Error("Shader program has no "+N+" attribute")}for(var H=0;H<R.length;H++){var V=R[H];if(I[V]=T.getUniformLocation(I,V),I[V]===-1)throw new Error("Shader program has no "+V+" uniform")}return I}function l(T,b){for(var P=T.getAttachedShaders(b),z=0;z<P.length;z++){var R=P[z];T.detachShader(b,R),T.deleteShader(R)}T.deleteProgram(b)}function h(T,b,P,z){var R=T.createBuffer();return T.bindBuffer(b,R),T.bufferData(b,z,P),R}function c(T,b,P,z){return{vertexIndices:h(T,T.ELEMENT_ARRAY_BUFFER,T.STATIC_DRAW,new Uint16Array(b)),vertexPositions:h(T,T.ARRAY_BUFFER,T.STATIC_DRAW,new Float32Array(P)),textureCoords:h(T,T.ARRAY_BUFFER,T.STATIC_DRAW,new Float32Array(z))}}function f(T,b){T.deleteBuffer(b.vertexIndices),T.deleteBuffer(b.vertexPositions),T.deleteBuffer(b.textureCoords)}function _(T,b){for(var P=T.getProgramParameter(b,T.ACTIVE_ATTRIBUTES),z=0;z<P;z++)T.enableVertexAttribArray(z)}function d(T,b){for(var P=T.getProgramParameter(b,T.ACTIVE_ATTRIBUTES),z=0;z<P;z++)T.disableVertexAttribArray(z)}function g(T,b,P){T.activeTexture(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,P._texture),T.uniform1i(b.uSampler,0)}function p(T,b,P,z){var R=((P+1)*t-z)/(t*e);T.uniform1f(b.uDepth,R)}var v=1,w=i.create(),x=s.create();s.identity(x);function m(T,b,P){var z=v;b&&b.opacity!=null&&(z=b.opacity),T.uniform1f(P.opacity,z);var R=w;b&&b.colorOffset&&(R=b.colorOffset),T.uniform4fv(P.colorOffset,R);var A=x;b&&b.colorMatrix&&(A=b.colorMatrix),T.uniformMatrix4fv(P.colorMatrix,!1,A)}var M=n.create(),u=n.create();function C(T,b,P,z){if(P.x===0&&P.width===1&&P.y===0&&P.height===1){T.viewport(0,0,T.drawingBufferWidth,T.drawingBufferHeight),s.identity(z);return}var R=P.x,A=r(R,0,1),O=A-R,I=1-A,S=r(P.width-O,0,I),N=P.width-S,H=1-P.height-P.y,V=r(H,0,1),k=V-H,Y=1-V,G=r(P.height-k,0,Y),K=P.height-G;n.set(u,P.width/S,P.height/G,1),n.set(M,(N-O)/S,(K-k)/G,0),s.identity(z),s.translate(z,z,M),s.scale(z,z,u),T.viewport(T.drawingBufferWidth*A,T.drawingBufferHeight*V,T.drawingBufferWidth*S,T.drawingBufferHeight*G)}return It={createShaderProgram:o,destroyShaderProgram:l,createConstantBuffers:c,destroyConstantBuffers:f,enableAttributes:_,disableAttributes:d,setTexture:g,setDepth:p,setViewport:C,setupPixelEffectUniforms:m},It}var qt,Ki;function Kf(){return Ki||(Ki=1,qt=["attribute vec3 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float uDepth;","uniform mat4 uViewportMatrix;","uniform mat4 uProjMatrix;","varying vec2 vTextureCoord;","void main(void) {","  gl_Position = uViewportMatrix * uProjMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);","  gl_Position.z = uDepth * gl_Position.w;","  vTextureCoord = aTextureCoord;","}"].join(`
`)),qt}var Ot,Qi;function Qf(){return Qi||(Qi=1,Ot=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uSampler;","uniform float uOpacity;","uniform vec4 uColorOffset;","uniform mat4 uColorMatrix;","varying vec2 vTextureCoord;","void main(void) {","  vec4 color = texture2D(uSampler, vTextureCoord) * uColorMatrix + uColorOffset;","  gl_FragColor = vec4(color.rgba * uOpacity);","}"].join(`
`)),Ot}var Dt,Ji;function Pa(){if(Ji)return Dt;Ji=1;var e=Q.mat4,t=Q.vec3,r=U(),i=La(),n=i.createConstantBuffers,s=i.destroyConstantBuffers,a=i.createShaderProgram,o=i.destroyShaderProgram,l=i.enableAttributes,h=i.disableAttributes,c=i.setViewport,f=i.setupPixelEffectUniforms,_=i.setDepth,d=i.setTexture,g=Kf(),p=Qf(),v=[0,1,2,0,2,3],w=[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],x=[0,0,1,0,1,1,0,1],m=["aVertexPosition","aTextureCoord"],M=["uDepth","uOpacity","uSampler","uProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix"];function u(C){this.gl=C,this.projMatrix=e.create(),this.viewportMatrix=e.create(),this.translateVector=t.create(),this.scaleVector=t.create(),this.constantBuffers=n(C,v,w,x),this.shaderProgram=a(C,g,p,m,M)}return u.prototype.destroy=function(){s(this.gl,this.constantBuffers),o(this.gl,this.shaderProgram),r(this)},u.prototype.startLayer=function(C,T){var b=this.gl,P=this.shaderProgram,z=this.constantBuffers,R=this.viewportMatrix;b.useProgram(P),l(b,P),c(b,C,T,R),b.uniformMatrix4fv(P.uViewportMatrix,!1,R),b.bindBuffer(b.ARRAY_BUFFER,z.vertexPositions),b.vertexAttribPointer(P.aVertexPosition,3,b.FLOAT,b.FALSE,0,0),b.bindBuffer(b.ARRAY_BUFFER,z.textureCoords),b.vertexAttribPointer(P.aTextureCoord,2,b.FLOAT,b.FALSE,0,0),f(b,C.effects(),{opacity:P.uOpacity,colorOffset:P.uColorOffset,colorMatrix:P.uColorMatrix})},u.prototype.endLayer=function(C,T){var b=this.gl,P=this.shaderProgram;h(b,P)},u.prototype.renderTile=function(C,T,b,P){var z=this.gl,R=this.shaderProgram,A=this.constantBuffers,O=this.projMatrix,I=this.translateVector,S=this.scaleVector;I[0]=C.centerX(),I[1]=C.centerY(),I[2]=-.5,S[0]=C.scaleX(),S[1]=C.scaleY(),S[2]=1,e.copy(O,b.view().projection()),e.rotateX(O,O,C.rotX()),e.rotateY(O,O,C.rotY()),e.translate(O,O,I),e.scale(O,O,S),z.uniformMatrix4fv(R.uProjMatrix,!1,O),_(z,R,P,C.z),d(z,R,T),z.bindBuffer(z.ELEMENT_ARRAY_BUFFER,A.vertexIndices),z.drawElements(z.TRIANGLES,v.length,z.UNSIGNED_SHORT,0)},Dt=u,Dt}var Ht,en;function za(){if(en)return Ht;en=1;var e=Pa(),t=de();function r(){this.constructor.super_.apply(this,arguments)}return t(r,e),Ht=r,Ht}var $t,tn;function Aa(){if(tn)return $t;tn=1;var e=Pa(),t=de();function r(){this.constructor.super_.apply(this,arguments)}return t(r,e),$t=r,$t}var Nt,rn;function Jf(){return rn||(rn=1,Nt=["attribute vec3 aVertexPosition;","uniform float uDepth;","uniform mat4 uViewportMatrix;","uniform mat4 uInvProjMatrix;","varying vec4 vRay;","void main(void) {","  vRay = uInvProjMatrix * vec4(aVertexPosition.xy, 1.0, 1.0);","  gl_Position = uViewportMatrix * vec4(aVertexPosition.xy, uDepth, 1.0);","}"].join(`
`)),Nt}var Ft,nn;function eu(){return nn||(nn=1,Ft=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float","#endif","uniform sampler2D uSampler;","uniform float uOpacity;","uniform float uTextureX;","uniform float uTextureY;","uniform float uTextureWidth;","uniform float uTextureHeight;","uniform vec4 uColorOffset;","uniform mat4 uColorMatrix;","varying vec4 vRay;","const float PI = 3.14159265358979323846264;","void main(void) {","  float r = inversesqrt(vRay.x * vRay.x + vRay.y * vRay.y + vRay.z * vRay.z);","  float phi  = acos(vRay.y * r);","  float theta = atan(vRay.x, -1.0*vRay.z);","  float s = 0.5 + 0.5 * theta / PI;","  float t = 1.0 - phi / PI;","  s = s * uTextureWidth + uTextureX;","  t = t * uTextureHeight + uTextureY;","  vec4 color = texture2D(uSampler, vec2(s, t)) * uColorMatrix + uColorOffset;","  gl_FragColor = vec4(color.rgba * uOpacity);","}"].join(`
`)),Ft}var Vt,sn;function Ia(){if(sn)return Vt;sn=1;var e=Q.mat4,t=U(),r=La(),i=r.createConstantBuffers,n=r.destroyConstantBuffers,s=r.createShaderProgram,a=r.destroyShaderProgram,o=r.enableAttributes,l=r.disableAttributes,h=r.setViewport,c=r.setupPixelEffectUniforms,f=r.setDepth,_=r.setTexture,d=Jf(),g=eu(),p=[0,1,2,0,2,3],v=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],w=[0,0,1,0,1,1,0,1],x=["aVertexPosition"],m=["uDepth","uOpacity","uSampler","uInvProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix","uTextureX","uTextureY","uTextureWidth","uTextureHeight"];function M(u){this.gl=u,this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.constantBuffers=i(u,p,v,w),this.shaderProgram=s(u,d,g,x,m)}return M.prototype.destroy=function(){n(this.gl,this.constantBuffers),a(this.gl,this.shaderProgram),t(this)},M.prototype.startLayer=function(u,C){var T=this.gl,b=this.shaderProgram,P=this.constantBuffers,z=this.invProjMatrix,R=this.viewportMatrix;T.useProgram(b),o(T,b),h(T,u,C,R),T.uniformMatrix4fv(b.uViewportMatrix,!1,R),T.bindBuffer(T.ARRAY_BUFFER,P.vertexPositions),T.vertexAttribPointer(b.aVertexPosition,3,T.FLOAT,T.FALSE,0,0),T.bindBuffer(T.ARRAY_BUFFER,P.textureCoords),e.copy(z,u.view().projection()),e.invert(z,z),T.uniformMatrix4fv(b.uInvProjMatrix,!1,z);var A=u.effects().textureCrop||{},O=A.x!=null?A.x:0,I=A.y!=null?A.y:0,S=A.width!=null?A.width:1,N=A.height!=null?A.height:1;T.uniform1f(b.uTextureX,O),T.uniform1f(b.uTextureY,I),T.uniform1f(b.uTextureWidth,S),T.uniform1f(b.uTextureHeight,N),c(T,u.effects(),{opacity:b.uOpacity,colorOffset:b.uColorOffset,colorMatrix:b.uColorMatrix})},M.prototype.endLayer=function(u,C){var T=this.gl,b=this.shaderProgram;l(T,b)},M.prototype.renderTile=function(u,C,T,b){var P=this.gl,z=this.shaderProgram,R=this.constantBuffers;f(P,z,b,u.z),_(P,z,C),P.bindBuffer(P.ELEMENT_ARRAY_BUFFER,R.vertexIndices),P.drawElements(P.TRIANGLES,p.length,P.UNSIGNED_SHORT,0)},Vt=M,Vt}var Wt,an;function qa(){if(an)return Wt;an=1;var e=za(),t=Aa(),r=Ia();function i(n){switch(n.type){case"webgl":n.registerRenderer("flat","flat",t),n.registerRenderer("cube","rectilinear",e),n.registerRenderer("equirect","rectilinear",r);break;default:throw new Error("Unknown stage type: "+n.type)}}return Wt=i,Wt}var kt,on;function et(){if(on)return kt;on=1;function e(){for(var t=0,r=0;r<arguments.length;r++){var i=arguments[r];t+=i,t+=i<<10,t^=i>>6}return t+=t<<3,t^=t>>11,t+=t<<15,t>=0?t:-t}return kt=e,kt}var Yt,hn;function Ee(){if(hn)return Yt;hn=1;function e(t,r){return(+t%(r=+r)+r)%r}return Yt=e,Yt}var Xt,ln;function Oa(){if(ln)return Xt;ln=1;var e=Ee(),t=64;function r(i){if(i!=null&&(!isFinite(i)||Math.floor(i)!==i||i<1))throw new Error("Set: invalid capacity");this._capacity=this._capacity||t,this._buckets=[];for(var n=0;n<this._capacity;n++)this._buckets.push([]);this._size=0}return r.prototype.add=function(i){for(var n=e(i.hash(),this._capacity),s=this._buckets[n],a=0;a<s.length;a++){var o=s[a];if(i.equals(o))return s[a]=i,o}return s.push(i),this._size++,null},r.prototype.remove=function(i){for(var n=e(i.hash(),this._capacity),s=this._buckets[n],a=0;a<s.length;a++){var o=s[a];if(i.equals(o)){for(var l=a;l<s.length-1;l++)s[l]=s[l+1];return s.length=s.length-1,this._size--,o}}return null},r.prototype.has=function(i){for(var n=e(i.hash(),this._capacity),s=this._buckets[n],a=0;a<s.length;a++){var o=s[a];if(i.equals(o))return!0}return!1},r.prototype.size=function(){return this._size},r.prototype.clear=function(){for(var i=0;i<this._capacity;i++)this._buckets[i].length=0;this._size=0},r.prototype.forEach=function(i){for(var n=0,s=0;s<this._capacity;s++)for(var a=this._buckets[s],o=0;o<a.length;o++)i(a[o]),n+=1;return n},Xt=r,Xt}var Bt,cn;function Da(){if(cn)return Bt;cn=1;var e=Oa();function t(){this._stack=[],this._visited=new e,this._vertices=null}return t.prototype.search=function(r,i,n){var s=this._stack,a=this._visited,o=this._vertices,l=0;for(this._clear(),s.push(i);s.length>0;){var h=s.pop();if(!a.has(h)&&r.intersects(h.vertices(o))){a.add(h);for(var c=h.neighbors(),f=0;f<c.length;f++)s.push(c[f]);n.push(h),l++}}return this._vertices=o,this._clear(),l},t.prototype._clear=function(){this._stack.length=0,this._visited.clear()},Bt=t,Bt}var Ut,vn;function Ha(){if(vn)return Ut;vn=1;var e=Ee();function t(r){if(!isFinite(r)||Math.floor(r)!==r||r<0)throw new Error("LruMap: invalid capacity");this._capacity=r,this._keys=new Array(this._capacity),this._values=new Array(this._capacity),this._start=0,this._size=0}return t.prototype._index=function(r){return e(this._start+r,this._capacity)},t.prototype.get=function(r){for(var i=0;i<this._size;i++){var n=this._keys[this._index(i)];if(r.equals(n))return this._values[this._index(i)]}return null},t.prototype.set=function(r,i){if(this._capacity===0)return r;this.del(r);var n=this._size===this._capacity?this._keys[this._index(0)]:null;return this._keys[this._index(this._size)]=r,this._values[this._index(this._size)]=i,this._size<this._capacity?this._size++:this._start=this._index(1),n},t.prototype.del=function(r){for(var i=0;i<this._size;i++)if(r.equals(this._keys[this._index(i)])){for(var n=this._values[this._index(i)],s=i;s<this._size-1;s++)this._keys[this._index(s)]=this._keys[this._index(s+1)],this._values[this._index(s)]=this._values[this._index(s+1)];return this._size--,n}return null},t.prototype.has=function(r){for(var i=0;i<this._size;i++)if(r.equals(this._keys[this._index(i)]))return!0;return!1},t.prototype.size=function(){return this._size},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._start=0,this._size=0},t.prototype.forEach=function(r){for(var i=0,n=0;n<this._size;n++)r(this._keys[this._index(n)],this._values[this._index(n)]),i+=1;return i},Ut=t,Ut}var Gt,fn;function li(){if(fn)return Gt;fn=1;function e(t){this._fallbackOnly=!!t.fallbackOnly}return e.prototype.numHorizontalTiles=function(){return Math.ceil(this.width()/this.tileWidth())},e.prototype.numVerticalTiles=function(){return Math.ceil(this.height()/this.tileHeight())},e.prototype.fallbackOnly=function(){return this._fallbackOnly},Gt=e,Gt}var jt,un;function De(){if(un)return jt;un=1;function e(t,r){return t<r?-1:t>r?1:0}return jt=e,jt}var Zt,dn;function Oe(){if(dn)return Zt;dn=1;var e=De();function t(i,n){for(var s=[],a=0;a<i.length;a++)s.push(new n(i[a]));return s.sort(function(o,l){return e(o.width(),l.width())}),s}function r(i){for(var n=[],s=0;s<i.length;s++)i[s]._fallbackOnly||n.push(i[s]);if(!n.length)throw new Error("No selectable levels in list");return n}return Zt={makeLevelList:t,makeSelectableLevelList:r},Zt}var Kt,pn;function He(){if(pn)return Kt;pn=1;function e(t){var r=typeof t;if(r==="object"){if(t===null)return"null";if(Object.prototype.toString.call(t)==="[object Array]")return"array";if(Object.prototype.toString.call(t)==="[object RegExp]")return"regexp"}return r}return Kt=e,Kt}var Qt,_n;function tu(){if(_n)return Qt;_n=1;var e=de(),t=et(),r=Da(),i=Ha(),n=li(),s=Oe().makeLevelList,a=Oe().makeSelectableLevelList,o=Le(),l=De(),h=He(),c=Q.vec3,f=Q.vec4,_=64,d="fudlrb",g={f:{x:0,y:0},b:{x:0,y:Math.PI},l:{x:0,y:Math.PI/2},r:{x:0,y:-Math.PI/2},u:{x:Math.PI/2,y:0},d:{x:-Math.PI/2,y:0}},p=c.create();function v(R,A,O,I){O&&c.rotateX(R,R,p,O),I&&c.rotateY(R,R,p,I)}for(var w={},x=0;x<d.length;x++){var m=d[x],M=g[m],u=c.fromValues(0,0,-1);v(u,0,M.x,M.y),w[m]=u}var C={f:["l","r","u","d"],b:["r","l","u","d"],l:["b","f","u","d"],r:["f","b","u","d"],u:["l","r","b","f"],d:["l","r","f","b"]},T=[[0,1],[1,0],[0,-1],[-1,0]];function b(R,A,O,I,S){this.face=R,this.x=A,this.y=O,this.z=I,this._geometry=S,this._level=S.levelList[I]}b.prototype.rotX=function(){return g[this.face].x},b.prototype.rotY=function(){return g[this.face].y},b.prototype.centerX=function(){return(this.x+.5)/this._level.numHorizontalTiles()-.5},b.prototype.centerY=function(){return .5-(this.y+.5)/this._level.numVerticalTiles()},b.prototype.scaleX=function(){return 1/this._level.numHorizontalTiles()},b.prototype.scaleY=function(){return 1/this._level.numVerticalTiles()},b.prototype.vertices=function(R){R||(R=[c.create(),c.create(),c.create(),c.create()]);var A=g[this.face];function O(V,k,Y){c.set(V,k,Y,-.5),v(V,0,A.x,A.y)}var I=this.centerX()-this.scaleX()/2,S=this.centerX()+this.scaleX()/2,N=this.centerY()-this.scaleY()/2,H=this.centerY()+this.scaleY()/2;return O(R[0],I,H),O(R[1],S,H),O(R[2],S,N),O(R[3],I,N),R},b.prototype.parent=function(){if(this.z===0)return null;var R=this.face,A=this.z,O=this.x,I=this.y,S=this._geometry,N=S.levelList[A],H=S.levelList[A-1],V=Math.floor(O/N.numHorizontalTiles()*H.numHorizontalTiles()),k=Math.floor(I/N.numVerticalTiles()*H.numVerticalTiles()),Y=A-1;return new b(R,V,k,Y,S)},b.prototype.children=function(R){if(this.z===this._geometry.levelList.length-1)return null;var A=this.face,O=this.z,I=this.x,S=this.y,N=this._geometry,H=N.levelList[O],V=N.levelList[O+1],k=V.numHorizontalTiles()/H.numHorizontalTiles(),Y=V.numVerticalTiles()/H.numVerticalTiles();R=R||[];for(var G=0;G<k;G++)for(var K=0;K<Y;K++){var ie=k*I+G,ge=Y*S+K,Z=O+1;R.push(new b(A,ie,ge,Z,N))}return R},b.prototype.neighbors=function(){var R=this._geometry,A=R._neighborsCache,O=A.get(this);if(O)return O;for(var I=R._vec,S=this.face,N=this.x,H=this.y,V=this.z,k=this._level,Y=k.numHorizontalTiles(),G=k.numVerticalTiles(),K=[],ie=0;ie<T.length;ie++){var ge=T[ie][0],Z=T[ie][1],J=N+ge,B=H+Z,ee=V,he=S;if(J<0||J>=Y||B<0||B>=G){var we=this.centerX(),xe=this.centerY();J<0?(c.set(I,-.5,xe,-.5),he=C[S][0]):J>=Y?(c.set(I,.5,xe,-.5),he=C[S][1]):B<0?(c.set(I,we,.5,-.5),he=C[S][2]):B>=G&&(c.set(I,we,-.5,-.5),he=C[S][3]);var se;se=g[S],v(I,0,se.x,se.y),se=g[he],v(I,0,-se.x,-se.y),J=o(Math.floor((.5+I[0])*Y),0,Y-1),B=o(Math.floor((.5-I[1])*G),0,G-1)}K.push(new b(he,J,B,ee,R))}return A.set(this,K),K},b.prototype.hash=function(){return t(d.indexOf(this.face),this.z,this.y,this.x)},b.prototype.equals=function(R){return this._geometry===R._geometry&&this.face===R.face&&this.z===R.z&&this.y===R.y&&this.x===R.x},b.prototype.cmp=function(R){return l(this.z,R.z)||l(d.indexOf(this.face),d.indexOf(R.face))||l(this.y,R.y)||l(this.x,R.x)},b.prototype.str=function(){return"CubeTile("+tile.face+", "+tile.x+", "+tile.y+", "+tile.z+")"};function P(R){if(this.constructor.super_.call(this,R),this._size=R.size,this._tileSize=R.tileSize,this._size%this._tileSize!==0)throw new Error("Level size is not multiple of tile size: "+this._size+" "+this._tileSize)}e(P,n),P.prototype.width=function(){return this._size},P.prototype.height=function(){return this._size},P.prototype.tileWidth=function(){return this._tileSize},P.prototype.tileHeight=function(){return this._tileSize},P.prototype._validateWithParentLevel=function(R){var A=this.width(),O=this.height(),I=this.tileWidth(),S=this.tileHeight(),N=this.numHorizontalTiles(),H=this.numVerticalTiles(),V=R.width(),k=R.height(),Y=R.tileWidth(),G=R.tileHeight(),K=R.numHorizontalTiles(),ie=R.numVerticalTiles();if(A%V!==0)throw new Error("Level width must be multiple of parent level: "+A+" vs. "+V);if(O%k!==0)throw new Error("Level height must be multiple of parent level: "+O+" vs. "+k);if(N%K!==0)throw new Error("Number of horizontal tiles must be multiple of parent level: "+N+" ("+A+"/"+I+") vs. "+K+" ("+V+"/"+Y+")");if(H%ie!==0)throw new Error("Number of vertical tiles must be multiple of parent level: "+H+" ("+O+"/"+S+") vs. "+ie+" ("+k+"/"+G+")")};function z(R){if(h(R)!=="array")throw new Error("Level list must be an array");this.levelList=s(R,P),this.selectableLevelList=a(this.levelList);for(var A=1;A<this.levelList.length;A++)this.levelList[A]._validateWithParentLevel(this.levelList[A-1]);this._tileSearcher=new r(this),this._neighborsCache=new i(_),this._vec=f.create(),this._viewSize={}}return z.prototype.maxTileSize=function(){for(var R=0,A=0;A<this.levelList.length;A++){var O=this.levelList[A];R=Math.max(R,O.tileWidth,O.tileHeight)}return R},z.prototype.levelTiles=function(R,A){var O=this.levelList.indexOf(R),I=R.numHorizontalTiles()-1,S=R.numVerticalTiles()-1;A=A||[];for(var N=0;N<d.length;N++)for(var H=d[N],V=0;V<=I;V++)for(var k=0;k<=S;k++)A.push(new b(H,V,k,O,this));return A},z.prototype._closestTile=function(R,A){var O=this._vec;f.set(O,0,0,1,1),f.transformMat4(O,O,R.inverseProjection());var I=1/0,S=null;for(var N in w){var H=w[N],V=1-c.dot(H,O);V<I&&(I=V,S=N)}for(var k=Math.max(Math.abs(O[0]),Math.abs(O[1]),Math.abs(O[2]))/.5,Y=0;Y<3;Y++)O[Y]=O[Y]/k;var G=g[S];v(O,0,-G.x,-G.y);var K=this.levelList.indexOf(A),ie=A.numHorizontalTiles(),ge=A.numVerticalTiles(),Z=o(Math.floor((.5+O[0])*ie),0,ie-1),J=o(Math.floor((.5-O[1])*ge),0,ge-1);return new b(S,Z,J,K,this)},z.prototype.visibleTiles=function(R,A,O){var I=this._viewSize,S=this._tileSearcher;if(O=O||[],R.size(I),I.width===0||I.height===0)return O;var N=this._closestTile(R,A),H=S.search(R,N,O);if(!H)throw new Error("Starting tile is not visible");return O},z.Tile=z.prototype.Tile=b,z.type=z.prototype.type="cube",b.type=b.prototype.type="cube",Qt=z,Qt}var Jt,mn;function ru(){if(mn)return Jt;mn=1;var e=de(),t=et(),r=Da(),i=Ha(),n=li(),s=Oe().makeLevelList,a=Oe().makeSelectableLevelList,o=Le(),l=Ee(),h=De(),c=He(),f=Q.vec2,_=Q.vec4,d=64,g=[[0,1],[1,0],[0,-1],[-1,0]];function p(x,m,M,u){this.x=x,this.y=m,this.z=M,this._geometry=u,this._level=u.levelList[M]}p.prototype.rotX=function(){return 0},p.prototype.rotY=function(){return 0},p.prototype.centerX=function(){var x=this._level.width(),m=this._level.tileWidth();return(this.x*m+.5*this.width())/x-.5},p.prototype.centerY=function(){var x=this._level.height(),m=this._level.tileHeight();return .5-(this.y*m+.5*this.height())/x},p.prototype.scaleX=function(){var x=this._level.width();return this.width()/x},p.prototype.scaleY=function(){var x=this._level.height();return this.height()/x},p.prototype.width=function(){var x=this._level.width(),m=this._level.tileWidth();if(this.x===this._level.numHorizontalTiles()-1){var M=l(x,m);return M||m}else return m},p.prototype.height=function(){var x=this._level.height(),m=this._level.tileHeight();if(this.y===this._level.numVerticalTiles()-1){var M=l(x,m);return M||m}else return m},p.prototype.levelWidth=function(){return this._level.width()},p.prototype.levelHeight=function(){return this._level.height()},p.prototype.vertices=function(x){x||(x=[f.create(),f.create(),f.create(),f.create()]);var m=this.centerX()-this.scaleX()/2,M=this.centerX()+this.scaleX()/2,u=this.centerY()-this.scaleY()/2,C=this.centerY()+this.scaleY()/2;return f.set(x[0],m,C),f.set(x[1],M,C),f.set(x[2],M,u),f.set(x[3],m,u),x},p.prototype.parent=function(){if(this.z===0)return null;var x=this._geometry,m=this.z-1,M=Math.floor(this.x/2),u=Math.floor(this.y/2);return new p(M,u,m,x)},p.prototype.children=function(x){if(this.z===this._geometry.levelList.length-1)return null;var m=this._geometry,M=this.z+1;return x=x||[],x.push(new p(2*this.x,2*this.y,M,m)),x.push(new p(2*this.x,2*this.y+1,M,m)),x.push(new p(2*this.x+1,2*this.y,M,m)),x.push(new p(2*this.x+1,2*this.y+1,M,m)),x},p.prototype.neighbors=function(){var x=this._geometry,m=x._neighborsCache,M=m.get(this);if(M)return M;for(var u=this.x,C=this.y,T=this.z,b=this._level,P=b.numHorizontalTiles()-1,z=b.numVerticalTiles()-1,R=[],A=0;A<g.length;A++){var O=g[A][0],I=g[A][1],S=u+O,N=C+I,H=T;0<=S&&S<=P&&0<=N&&N<=z&&R.push(new p(S,N,H,x))}return m.set(this,R),R},p.prototype.hash=function(){return t(this.z,this.y,this.x)},p.prototype.equals=function(x){return this._geometry===x._geometry&&this.z===x.z&&this.y===x.y&&this.x===x.x},p.prototype.cmp=function(x){return h(this.z,x.z)||h(this.y,x.y)||h(this.x,x.x)},p.prototype.str=function(){return"FlatTile("+tile.x+", "+tile.y+", "+tile.z+")"};function v(x){this.constructor.super_.call(this,x),this._width=x.width,this._height=x.height,this._tileWidth=x.tileWidth,this._tileHeight=x.tileHeight}e(v,n),v.prototype.width=function(){return this._width},v.prototype.height=function(){return this._height},v.prototype.tileWidth=function(){return this._tileWidth},v.prototype.tileHeight=function(){return this._tileHeight},v.prototype._validateWithParentLevel=function(x){var m=this.width(),M=this.height(),u=this.tileWidth(),C=this.tileHeight(),T=x.width(),b=x.height(),P=x.tileWidth(),z=x.tileHeight();if(m%T!==0)return new Error("Level width must be multiple of parent level: "+m+" vs. "+T);if(M%b!==0)return new Error("Level height must be multiple of parent level: "+M+" vs. "+b);if(u%P!==0)return new Error("Level tile width must be multiple of parent level: "+u+" vs. "+P);if(C%z!==0)return new Error("Level tile height must be multiple of parent level: "+C+" vs. "+z)};function w(x){if(c(x)!=="array")throw new Error("Level list must be an array");this.levelList=s(x,v),this.selectableLevelList=a(this.levelList);for(var m=1;m<this.levelList.length;m++)this.levelList[m]._validateWithParentLevel(this.levelList[m-1]);this._tileSearcher=new r(this),this._neighborsCache=new i(d),this._vec=_.create(),this._viewSize={}}return w.prototype.maxTileSize=function(){for(var x=0,m=0;m<this.levelList.length;m++){var M=this.levelList[m];x=Math.max(x,M.tileWidth,M.tileHeight)}return x},w.prototype.levelTiles=function(x,m){var M=this.levelList.indexOf(x),u=x.numHorizontalTiles()-1,C=x.numVerticalTiles()-1;m||(m=[]);for(var T=0;T<=u;T++)for(var b=0;b<=C;b++)m.push(new p(T,b,M,this));return m},w.prototype._closestTile=function(x,m){var M=this._vec;_.set(M,0,0,1,1),_.transformMat4(M,M,x.inverseProjection());var u=.5+M[0],C=.5-M[1],T=this.levelList.indexOf(m),b=m.width(),P=m.height(),z=m.tileWidth(),R=m.tileHeight(),A=m.numHorizontalTiles(),O=m.numVerticalTiles(),I=o(Math.floor(u*b/z),0,A-1),S=o(Math.floor(C*P/R),0,O-1);return new p(I,S,T,this)},w.prototype.visibleTiles=function(x,m,M){var u=this._viewSize,C=this._tileSearcher;if(M=M||[],x.size(u),u.width===0||u.height===0)return M;var T=this._closestTile(x,m),b=C.search(x,T,M);if(!b)throw new Error("Starting tile is not visible");return M},w.Tile=w.prototype.Tile=p,w.type=w.prototype.type="flat",p.type=p.prototype.type="flat",Jt=w,Jt}var er,yn;function iu(){if(yn)return er;yn=1;var e=de(),t=et(),r=De(),i=Oe(),n=li(),s=He();function a(h,c){this.z=h,this._geometry=c,this._level=c.levelList[h]}a.prototype.rotX=function(){return 0},a.prototype.rotY=function(){return 0},a.prototype.centerX=function(){return .5},a.prototype.centerY=function(){return .5},a.prototype.scaleX=function(){return 1},a.prototype.scaleY=function(){return 1},a.prototype.parent=function(){return this.z===0?null:new a(this.z-1,this._geometry)},a.prototype.children=function(h){return this.z===this._geometry.levelList.length-1?null:(h=h||[],h.push(new a(this.z+1,this._geometry)),h)},a.prototype.neighbors=function(){return[]},a.prototype.hash=function(){return t(this.z)},a.prototype.equals=function(h){return this._geometry===h._geometry&&this.z===h.z},a.prototype.cmp=function(h){return r(this.z,h.z)},a.prototype.str=function(){return"EquirectTile("+tile.z+")"};function o(h){this.constructor.super_.call(this,h),this._width=h.width}e(o,n),o.prototype.width=function(){return this._width},o.prototype.height=function(){return this._width/2},o.prototype.tileWidth=function(){return this._width},o.prototype.tileHeight=function(){return this._width/2};function l(h){if(s(h)!=="array")throw new Error("Level list must be an array");this.levelList=i.makeLevelList(h,o),this.selectableLevelList=i.makeSelectableLevelList(this.levelList)}return l.prototype.maxTileSize=function(){for(var h=0,c=0;c<this.levelList.length;c++){var f=this.levelList[c];h=Math.max(h,f.tileWidth,f.tileHeight)}return h},l.prototype.levelTiles=function(h,c){var f=this.levelList.indexOf(h);return c=c||[],c.push(new a(f,this)),c},l.prototype.visibleTiles=function(h,c,f){var _=new a(this.levelList.indexOf(c),this);f=f||[],f.length=0,f.push(_)},l.Tile=l.prototype.Tile=a,l.type=l.prototype.type="equirect",a.type=a.prototype.type="equirect",er=l,er}var tr,gn;function $a(){if(gn)return tr;gn=1;function e(o,l,h){return 2*Math.atan(h*Math.tan(o/2)/l)}function t(o,l,h){return e(o,l,h)}function r(o,l,h){return e(o,l,Math.sqrt(l*l+h*h))}function i(o,l,h){return e(o,h,l)}function n(o,l,h){return e(o,h,Math.sqrt(l*l+h*h))}function s(o,l,h){return e(o,Math.sqrt(l*l+h*h),l)}function a(o,l,h){return e(o,Math.sqrt(l*l+h*h),h)}return tr={convert:e,htov:t,htod:r,vtoh:i,vtod:n,dtoh:s,dtov:a},tr}var rr,wn;function ci(){if(wn)return rr;wn=1;function e(t){return typeof t=="number"&&isFinite(t)}return rr=e,rr}var ir,xn;function vi(){if(xn)return ir;xn=1;function e(t){return t.toPrecision(15)}return ir=e,ir}var nr,Mn;function Na(){if(Mn)return nr;Mn=1;function e(){var t=arguments;return function(i){for(var n=i,s=0;s<t.length;s++){var a=t[s];n=a.call(null,n)}return n}}return nr=e,nr}var sr,En;function nu(){if(En)return sr;En=1;var e=j(),t=Q.mat4,r=Q.vec4,i=Qe(),n=$a(),s=Ee(),a=ci(),o=Le(),l=vi(),h=Na(),c=U(),f=0,_=0,d=0,g=0,p=0,v=Math.PI/4,w=0,x=0,m=1e-6;function M(u,C){this._yaw=u&&u.yaw!=null?u.yaw:d,this._pitch=u&&u.pitch!=null?u.pitch:g,this._roll=u&&u.roll!=null?u.roll:p,this._fov=u&&u.fov!=null?u.fov:v,this._width=u&&u.width!=null?u.width:f,this._height=u&&u.height!=null?u.height:_,this._projectionCenterX=u&&u.projectionCenterX!=null?u.projectionCenterX:w,this._projectionCenterY=u&&u.projectionCenterY!=null?u.projectionCenterY:x,this._limiter=C||null,this._projMatrix=t.create(),this._invProjMatrix=t.create(),this._frustum=[r.create(),r.create(),r.create(),r.create(),r.create()],this._projectionChanged=!0,this._params={},this._fovs={},this._tmpVec=r.create(),this._update()}return e(M),M.prototype.destroy=function(){c(this)},M.prototype.yaw=function(){return this._yaw},M.prototype.pitch=function(){return this._pitch},M.prototype.roll=function(){return this._roll},M.prototype.projectionCenterX=function(){return this._projectionCenterX},M.prototype.projectionCenterY=function(){return this._projectionCenterY},M.prototype.fov=function(){return this._fov},M.prototype.width=function(){return this._width},M.prototype.height=function(){return this._height},M.prototype.size=function(u){return u=u||{},u.width=this._width,u.height=this._height,u},M.prototype.parameters=function(u){return u=u||{},u.yaw=this._yaw,u.pitch=this._pitch,u.roll=this._roll,u.fov=this._fov,u},M.prototype.limiter=function(){return this._limiter},M.prototype.setYaw=function(u){this._resetParams(),this._params.yaw=u,this._update(this._params)},M.prototype.setPitch=function(u){this._resetParams(),this._params.pitch=u,this._update(this._params)},M.prototype.setRoll=function(u){this._resetParams(),this._params.roll=u,this._update(this._params)},M.prototype.setFov=function(u){this._resetParams(),this._params.fov=u,this._update(this._params)},M.prototype.setProjectionCenterX=function(u){this._resetParams(),this._params.projectionCenterX=u,this._update(this._params)},M.prototype.setProjectionCenterY=function(u){this._resetParams(),this._params.projectionCenterY=u,this._update(this._params)},M.prototype.offsetYaw=function(u){this.setYaw(this._yaw+u)},M.prototype.offsetPitch=function(u){this.setPitch(this._pitch+u)},M.prototype.offsetRoll=function(u){this.setRoll(this._roll+u)},M.prototype.offsetFov=function(u){this.setFov(this._fov+u)},M.prototype.setSize=function(u){this._resetParams(),this._params.width=u.width,this._params.height=u.height,this._update(this._params)},M.prototype.setParameters=function(u){this._resetParams(),this._params.yaw=u.yaw,this._params.pitch=u.pitch,this._params.roll=u.roll,this._params.fov=u.fov,this._params.projectionCenterX=u.projectionCenterX,this._params.projectionCenterY=u.projectionCenterY,this._update(this._params)},M.prototype.setLimiter=function(u){this._limiter=u||null,this._update()},M.prototype._resetParams=function(){var u=this._params;u.yaw=null,u.pitch=null,u.roll=null,u.fov=null,u.width=null,u.height=null},M.prototype._update=function(u){u==null&&(this._resetParams(),u=this._params);var C=this._yaw,T=this._pitch,b=this._roll,P=this._fov,z=this._projectionCenterX,R=this._projectionCenterY,A=this._width,O=this._height;if(u.yaw=u.yaw!=null?u.yaw:C,u.pitch=u.pitch!=null?u.pitch:T,u.roll=u.roll!=null?u.roll:b,u.fov=u.fov!=null?u.fov:P,u.width=u.width!=null?u.width:A,u.height=u.height!=null?u.height:O,u.projectionCenterX=u.projectionCenterX!=null?u.projectionCenterX:z,u.projectionCenterY=u.projectionCenterY!=null?u.projectionCenterY:R,this._limiter&&(u=this._limiter(u),!u))throw new Error("Bad view limiter");u=this._normalize(u);var I=u.yaw,S=u.pitch,N=u.roll,H=u.fov,V=u.width,k=u.height,Y=u.projectionCenterX,G=u.projectionCenterY;if(!a(I)||!a(S)||!a(N)||!a(H)||!a(V)||!a(k)||!a(Y)||!a(G))throw new Error("Bad view - suspect a broken limiter");this._yaw=I,this._pitch=S,this._roll=N,this._fov=H,this._width=V,this._height=k,this._projectionCenterX=Y,this._projectionCenterY=G,(I!==C||S!==T||N!==b||H!==P||V!==A||k!==O||Y!==z||G!==R)&&(this._projectionChanged=!0,this.emit("change")),(V!==A||k!==O)&&this.emit("resize")},M.prototype._normalize=function(u){this._normalizeCoordinates(u);var C=n.htov(Math.PI,u.width,u.height),T=isNaN(C)?Math.PI:Math.min(Math.PI,C);return u.fov=o(u.fov,m,T-m),u},M.prototype._normalizeCoordinates=function(u){return"yaw"in u&&(u.yaw=s(u.yaw-Math.PI,-2*Math.PI)+Math.PI),"pitch"in u&&(u.pitch=s(u.pitch-Math.PI,-2*Math.PI)+Math.PI),"roll"in u&&(u.roll=s(u.roll-Math.PI,-2*Math.PI)+Math.PI),u},M.prototype.normalizeToClosest=function(u,C){var T=this._yaw,b=this._pitch,P=u.yaw,z=u.pitch,R=P-2*Math.PI,A=P+2*Math.PI;Math.abs(R-T)<Math.abs(P-T)?P=R:Math.abs(A-T)<Math.abs(P-T)&&(P=A);var O=z-2*Math.PI,I=z+2*Math.PI;return Math.abs(O-b)<Math.abs(z-b)?z=O:Math.abs(O-b)<Math.abs(z-b)&&(z=I),C=C||{},C.yaw=P,C.pitch=z,C},M.prototype.updateWithControlParameters=function(u){var C=this._fov,T=n.vtoh(C,this._width,this._height);isNaN(T)&&(T=C),this.offsetYaw(u.axisScaledX*T+u.x*2*T+u.yaw),this.offsetPitch(u.axisScaledY*C+u.y*2*T+u.pitch),this.offsetRoll(-u.roll),this.offsetFov(u.zoom*C)},M.prototype._updateProjection=function(){var u=this._projMatrix,C=this._invProjMatrix,T=this._frustum;if(this._projectionChanged){var b=this._width,P=this._height,z=this._fov,R=n.vtoh(z,b,P),A=b/P,O=this._projectionCenterX,I=this._projectionCenterY;if(O!==0||I!==0){var S=Math.atan(O*2*Math.tan(R/2)),N=Math.atan(I*2*Math.tan(z/2)),H=this._fovs;H.leftDegrees=(R/2+S)*180/Math.PI,H.rightDegrees=(R/2-S)*180/Math.PI,H.upDegrees=(z/2+N)*180/Math.PI,H.downDegrees=(z/2-N)*180/Math.PI,t.perspectiveFromFieldOfView(u,H,-1,1)}else t.perspective(u,z,A,-1,1);t.rotateZ(u,u,this._roll),t.rotateX(u,u,this._pitch),t.rotateY(u,u,this._yaw),t.invert(C,u),this._matrixToFrustum(u,T),this._projectionChanged=!1}},M.prototype._matrixToFrustum=function(u,C){r.set(C[0],u[3]+u[0],u[7]+u[4],u[11]+u[8],0),r.set(C[1],u[3]-u[0],u[7]-u[4],u[11]-u[8],0),r.set(C[2],u[3]+u[1],u[7]+u[5],u[11]+u[9],0),r.set(C[3],u[3]-u[1],u[7]-u[5],u[11]-u[9],0),r.set(C[4],u[3]+u[2],u[7]+u[6],u[11]+u[10],0)},M.prototype.projection=function(){return this._updateProjection(),this._projMatrix},M.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},M.prototype.intersects=function(u){this._updateProjection();for(var C=this._frustum,T=this._tmpVec,b=0;b<C.length;b++){for(var P=C[b],z=!1,R=0;R<u.length;R++){var A=u[R];r.set(T,A[0],A[1],A[2],0),r.dot(P,T)>=0&&(z=!0)}if(!z)return!1}return!0},M.prototype.selectLevel=function(u){for(var C=i()*this._height,T=Math.tan(.5*this._fov),b=0;b<u.length;b++){var P=u[b];if(T*P.height()>=C)return P}return u[u.length-1]},M.prototype.coordinatesToScreen=function(u,C){var T=this._tmpVec;C||(C={});var b=this._width,P=this._height;if(b<=0||P<=0)return C.x=null,C.y=null,null;var z=u.yaw,R=u.pitch,A=Math.sin(z)*Math.cos(R),O=-Math.sin(R),I=-Math.cos(z)*Math.cos(R);if(r.set(T,A,O,I,1),r.transformMat4(T,T,this.projection()),T[3]>=0)C.x=b*(T[0]/T[3]+1)/2,C.y=P*(1-T[1]/T[3])/2;else return C.x=null,C.y=null,null;return C},M.prototype.screenToCoordinates=function(u,C){var T=this._tmpVec;C||(C={});var b=this._width,P=this._height,z=2*u.x/b-1,R=1-2*u.y/P;r.set(T,z,R,1,1),r.transformMat4(T,T,this.inverseProjection());var A=Math.sqrt(T[0]*T[0]+T[1]*T[1]+T[2]*T[2]);return C.yaw=Math.atan2(T[0],-T[2]),C.pitch=Math.acos(T[1]/A)-Math.PI/2,this._normalizeCoordinates(C),C},M.prototype.coordinatesToPerspectiveTransform=function(u,C,T){T=T||"";var b=this._height,P=this._width,z=this._fov,R=.5*b/Math.tan(z/2),A="";return A+="translateX("+l(P/2)+"px) ",A+="translateY("+l(b/2)+"px) ",A+="translateX(-50%) translateY(-50%) ",A+="perspective("+l(R)+"px) ",A+="translateZ("+l(R)+"px) ",A+="rotateZ("+l(-this._roll)+"rad) ",A+="rotateX("+l(-this._pitch)+"rad) ",A+="rotateY("+l(this._yaw)+"rad) ",A+="rotateY("+l(-u.yaw)+"rad) ",A+="rotateX("+l(u.pitch)+"rad) ",A+="translateZ("+l(-C)+"px) ",A+=T+" ",A},M.limit={yaw:function(u,C){return function(b){return b.yaw=o(b.yaw,u,C),b}},pitch:function(u,C){return function(b){return b.pitch=o(b.pitch,u,C),b}},roll:function(u,C){return function(b){return b.roll=o(b.roll,u,C),b}},hfov:function(u,C){return function(b){var P=b.width,z=b.height;if(P>0&&z>0){var R=n.htov(u,P,z),A=n.htov(C,P,z);b.fov=o(b.fov,R,A)}return b}},vfov:function(u,C){return function(b){return b.fov=o(b.fov,u,C),b}},resolution:function(u){return function(T){var b=T.height;if(b){var P=i()*b,z=2*Math.atan(P/u);T.fov=o(T.fov,z,1/0)}return T}},traditional:function(u,C,T){return T=T??C,h(M.limit.resolution(u),M.limit.vfov(0,C),M.limit.hfov(0,T),M.limit.pitch(-Math.PI/2,Math.PI/2))}},M.type=M.prototype.type="rectilinear",sr=M,sr}var ar,Tn;function su(){if(Tn)return ar;Tn=1;var e=j(),t=Q.mat4,r=Q.vec4,i=Qe(),n=ci(),s=Le(),a=U(),o=0,l=0,h=.5,c=.5,f=1,_=[1,0,1,0],d=[-1,-1,1,1],g=1e-6;function p(v,w){if(!(v&&v.mediaAspectRatio!=null))throw new Error("mediaAspectRatio must be defined");this._x=v&&v.x!=null?v.x:h,this._y=v&&v.y!=null?v.y:c,this._zoom=v&&v.zoom!=null?v.zoom:f,this._mediaAspectRatio=v.mediaAspectRatio,this._width=v&&v.width!=null?v.width:o,this._height=v&&v.height!=null?v.height:l,this._limiter=w||null,this._projMatrix=t.create(),this._invProjMatrix=t.create(),this._frustum=[0,0,0,0],this._projectionChanged=!0,this._params={},this._vec=r.create(),this._update()}return e(p),p.prototype.destroy=function(){a(this)},p.prototype.x=function(){return this._x},p.prototype.y=function(){return this._y},p.prototype.zoom=function(){return this._zoom},p.prototype.mediaAspectRatio=function(){return this._mediaAspectRatio},p.prototype.width=function(){return this._width},p.prototype.height=function(){return this._height},p.prototype.size=function(v){return v=v||{},v.width=this._width,v.height=this._height,v},p.prototype.parameters=function(v){return v=v||{},v.x=this._x,v.y=this._y,v.zoom=this._zoom,v.mediaAspectRatio=this._mediaAspectRatio,v},p.prototype.limiter=function(){return this._limiter},p.prototype.setX=function(v){this._resetParams(),this._params.x=v,this._update(this._params)},p.prototype.setY=function(v){this._resetParams(),this._params.y=v,this._update(this._params)},p.prototype.setZoom=function(v){this._resetParams(),this._params.zoom=v,this._update(this._params)},p.prototype.offsetX=function(v){this.setX(this._x+v)},p.prototype.offsetY=function(v){this.setY(this._y+v)},p.prototype.offsetZoom=function(v){this.setZoom(this._zoom+v)},p.prototype.setMediaAspectRatio=function(v){this._resetParams(),this._params.mediaAspectRatio=v,this._update(this._params)},p.prototype.setSize=function(v){this._resetParams(),this._params.width=v.width,this._params.height=v.height,this._update(this._params)},p.prototype.setParameters=function(v){this._resetParams(),this._params.x=v.x,this._params.y=v.y,this._params.zoom=v.zoom,this._params.mediaAspectRatio=v.mediaAspectRatio,this._update(this._params)},p.prototype.setLimiter=function(v){this._limiter=v||null,this._update()},p.prototype._resetParams=function(){var v=this._params;v.x=null,v.y=null,v.zoom=null,v.mediaAspectRatio=null,v.width=null,v.height=null},p.prototype._update=function(v){v==null&&(this._resetParams(),v=this._params);var w=this._x,x=this._y,m=this._zoom,M=this._mediaAspectRatio,u=this._width,C=this._height;if(v.x=v.x!=null?v.x:w,v.y=v.y!=null?v.y:x,v.zoom=v.zoom!=null?v.zoom:m,v.mediaAspectRatio=v.mediaAspectRatio!=null?v.mediaAspectRatio:M,v.width=v.width!=null?v.width:u,v.height=v.height!=null?v.height:C,this._limiter&&(v=this._limiter(v),!v))throw new Error("Bad view limiter");var T=v.x,b=v.y,P=v.zoom,z=v.mediaAspectRatio,R=v.width,A=v.height;if(!n(T)||!n(b)||!n(P)||!n(z)||!n(R)||!n(A))throw new Error("Bad view - suspect a broken limiter");P=s(P,g,1/0),this._x=T,this._y=b,this._zoom=P,this._mediaAspectRatio=z,this._width=R,this._height=A,(T!==w||b!==x||P!==m||z!==M||R!==u||A!==C)&&(this._projectionChanged=!0,this.emit("change")),(R!==u||A!==C)&&this.emit("resize")},p.prototype._zoomX=function(){return this._zoom},p.prototype._zoomY=function(){var v=this._mediaAspectRatio,w=this._width/this._height,x=this._zoom,m=x*v/w;return isNaN(m)&&(m=x),m},p.prototype.updateWithControlParameters=function(v){var w=this.zoom(),x=this._zoomX(),m=this._zoomY();this.offsetX(v.axisScaledX*x+v.x*w),this.offsetY(v.axisScaledY*m+v.y*w),this.offsetZoom(v.zoom*w)},p.prototype._updateProjection=function(){var v=this._projMatrix,w=this._invProjMatrix,x=this._frustum;if(this._projectionChanged){var m=this._x,M=this._y,u=this._zoomX(),C=this._zoomY(),T=x[0]=.5-M+.5*C,b=x[1]=m-.5+.5*u,P=x[2]=.5-M-.5*C,z=x[3]=m-.5-.5*u;t.ortho(v,z,b,P,T,-1,1),t.invert(w,v),this._projectionChanged=!1}},p.prototype.projection=function(){return this._updateProjection(),this._projMatrix},p.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},p.prototype.intersects=function(v){this._updateProjection();for(var w=this._frustum,x=0;x<w.length;x++){for(var m=w[x],M=_[x],u=d[x],C=!1,T=0;T<v.length;T++){var b=v[T];if(u<0&&b[M]<m||u>0&&b[M]>m){C=!0;break}}if(!C)return!1}return!0},p.prototype.selectLevel=function(v){for(var w=i()*this.width(),x=this._zoom,m=0;m<v.length;m++){var M=v[m];if(x*M.width()>=w)return M}return v[v.length-1]},p.prototype.coordinatesToScreen=function(v,w){var x=this._vec;w||(w={});var m=this._width,M=this._height;if(m<=0||M<=0)return w.x=null,w.y=null,null;var u=v&&v.x!=null?v.x:h,C=v&&v.y!=null?v.y:c;r.set(x,u-.5,.5-C,-1,1),r.transformMat4(x,x,this.projection());for(var T=0;T<3;T++)x[T]/=x[3];return w.x=m*(x[0]+1)/2,w.y=M*(1-x[1])/2,w},p.prototype.screenToCoordinates=function(v,w){var x=this._vec;w||(w={});var m=this._width,M=this._height,u=2*v.x/m-1,C=1-2*v.y/M;return r.set(x,u,C,1,1),r.transformMat4(x,x,this.inverseProjection()),w.x=.5+x[0],w.y=.5-x[1],w},p.limit={x:function(v,w){return function(m){return m.x=s(m.x,v,w),m}},y:function(v,w){return function(m){return m.y=s(m.y,v,w),m}},zoom:function(v,w){return function(m){return m.zoom=s(m.zoom,v,w),m}},resolution:function(v){return function(x){if(x.width<=0||x.height<=0)return x;var m=x.width,M=i()*m/v;return x.zoom=s(x.zoom,M,1/0),x}},visibleX:function(v,w){return function(m){var M=w-v;m.zoom>M&&(m.zoom=M);var u=v+.5*m.zoom,C=w-.5*m.zoom;return m.x=s(m.x,u,C),m}},visibleY:function(v,w){return function(m){if(m.width<=0||m.height<=0)return m;var M=m.width/m.height,u=M/m.mediaAspectRatio,C=(w-v)*u;m.zoom>C&&(m.zoom=C);var T=v+.5*m.zoom/u,b=w-.5*m.zoom/u;return m.y=s(m.y,T,b),m}},letterbox:function(){return function(w){if(w.width<=0||w.height<=0)return w;var x=w.width/w.height,m=1,M=x/w.mediaAspectRatio;w.mediaAspectRatio>=x&&(w.zoom=Math.min(w.zoom,m)),w.mediaAspectRatio<=x&&(w.zoom=Math.min(w.zoom,M));var u,C;w.zoom>m?u=C=.5:(u=0+.5*w.zoom/m,C=1-.5*w.zoom/m);var T,b;return w.zoom>M?T=b=.5:(T=0+.5*w.zoom/M,b=1-.5*w.zoom/M),w.x=s(w.x,u,C),w.y=s(w.y,T,b),w}}},p.type=p.prototype.type="flat",ar=p,ar}var or,bn;function au(){if(bn)return or;bn=1;var e=ds(),t=Ee();function r(i){this._concurrency=i&&i.concurrency||1,this._paused=i&&!!i.paused||!1,this._pool=[];for(var n=0;n<this._concurrency;n++)this._pool.push(new e(i));this._next=0}return r.prototype.length=function(){for(var i=0,n=0;n<this._pool.length;n++)i+=this._pool[n].length();return i},r.prototype.push=function(i,n){var s=this._next,a=this._pool[s].push(i,n);return this._next=t(this._next+1,this._concurrency),a},r.prototype.pause=function(){if(!this._paused){this._paused=!0;for(var i=0;i<this._concurrency;i++)this._pool[i].pause()}},r.prototype.resume=function(){if(this._paused){this._paused=!1;for(var i=0;i<this._concurrency;i++)this._pool[i].resume()}},or=r,or}var hr,Cn;function $e(){if(Cn)return hr;Cn=1;function e(){}return hr=e,hr}var lr,Sn;function fi(){if(Sn)return lr;Sn=1;var e=$e();function t(){var r=Array.prototype.slice.call(arguments,0);return function(){var n=r.slice(0),s=null,a=null,o=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],l=arguments.length?arguments[arguments.length-1]:e;function h(){var f=arguments[0];if(f){s=a=null,l.apply(null,arguments);return}if(!n.length){s=a=null,l.apply(null,arguments);return}s=n.shift();var _=s,d=Array.prototype.slice.call(arguments,1);d.push(h);var g=s.apply(null,d);if(_===s){if(typeof g!="function")throw new Error("chain: chaining on non-cancellable function");a=g}}function c(){a&&a.apply(null,arguments)}return o.unshift(null),h.apply(null,o),c}}return lr=t,lr}var cr,Rn;function Fa(){if(Rn)return cr;Rn=1;function e(t,r){var i=null;function n(){i!=null&&(i=null,r(null))}function s(){i!=null&&(clearTimeout(i),i=null,r.apply(null,arguments))}return i=setTimeout(n,t),s}return cr=e,cr}var vr,Ln;function ou(){if(Ln)return vr;Ln=1;var e=j(),t=gs(),r=au(),i=fi(),n=Fa(),s=Ce(),a={x:"x",y:"y",z:"z",f:"face"},o="bdflru",l=4,h=1e4;function c(_,d){d=d||{},this._loadPool=new r({concurrency:d.concurrency||l}),this._retryDelay=d.retryDelay||h,this._retryMap={},this._sourceFromTile=_}e(c),c.prototype.loadAsset=function(_,d,g){var p=this,v=this._retryDelay,w=this._retryMap,x=this._sourceFromTile(d),m=x.url,M=x.rect,u=_.loadImage.bind(_,m,M),C=function(A){return p._loadPool.push(u,function(O,I){O?(O instanceof t&&(w[m]=s(),p.emit("networkError",O,d)),A(O,d)):(delete w[m],A(null,d,I))})},T,b=w[m];if(b!=null){var P=s(),z=P-b;z<v?T=v-z:(T=0,delete w[m])}var R=n.bind(null,T);return i(R,C)(g)},c.fromString=function(_,d){d=d||{};var g=d&&d.cubeMapPreviewFaceOrder||o,p=d.cubeMapPreviewUrl?w:v;return new c(p,d);function v(m){var M=_;for(var u in a){var C=a[u],T=f(u),b=m.hasOwnProperty(C)?m[C]:"";M=M.replace(T,b)}return{url:M}}function w(m){return m.z===0?x(m):v(m)}function x(m){var M=g.indexOf(m.face)/6;return{url:d.cubeMapPreviewUrl,rect:{x:0,y:M,width:1,height:1/6}}}};function f(_){var d="\\{("+_+")\\}";return new RegExp(d,"g")}return vr=c,vr}var fr,Pn;function hu(){if(Pn)return fr;Pn=1;function e(t){this._asset=t}return e.prototype.asset=function(){return this._asset},e.prototype.loadAsset=function(t,r,i){var n=this,s=setTimeout(function(){i(null,r,n._asset)},0);function a(){clearTimeout(s),i.apply(null,arguments)}return a},fr=e,fr}var ur,zn;function lu(){if(zn)return ur;zn=1;var e=Qr(),t=de(),r=j(),i=U();function n(s){this.constructor.super_.call(this,s),this._timestamp=0}return t(n,e),r(n),n.prototype.destroy=function(){i(this)},n.prototype.timestamp=function(){return this._timestamp},n.prototype.isDynamic=function(){return!0},n.prototype.markDirty=function(){this._timestamp++,this.emit("change")},ur=n,ur}var dr,An;function cu(){if(An)return dr;An=1;var e=Ee(),t=64;function r(i){if(i!=null&&(!isFinite(i)||Math.floor(i)!==i||i<1))throw new Error("Map: invalid capacity");this._capacity=i||t,this._keyBuckets=[],this._valBuckets=[];for(var n=0;n<this._capacity;n++)this._keyBuckets.push([]),this._valBuckets.push([]);this._size=0}return r.prototype.get=function(i){for(var n=e(i.hash(),this._capacity),s=this._keyBuckets[n],a=0;a<s.length;a++){var o=s[a];if(i.equals(o)){var l=this._valBuckets[n],h=l[a];return h}}return null},r.prototype.set=function(i,n){for(var s=e(i.hash(),this._capacity),a=this._keyBuckets[s],o=this._valBuckets[s],l=0;l<a.length;l++){var h=a[l];if(i.equals(h)){var c=o[l];return a[l]=i,o[l]=n,c}}return a.push(i),o.push(n),this._size++,null},r.prototype.del=function(i){for(var n=e(i.hash(),this._capacity),s=this._keyBuckets[n],a=this._valBuckets[n],o=0;o<s.length;o++){var l=s[o];if(i.equals(l)){for(var h=a[o],c=o;c<s.length-1;c++)s[c]=s[c+1],a[c]=a[c+1];return s.length=s.length-1,a.length=a.length-1,this._size--,h}}return null},r.prototype.has=function(i){for(var n=e(i.hash(),this._capacity),s=this._keyBuckets[n],a=0;a<s.length;a++){var o=s[a];if(i.equals(o))return!0}return!1},r.prototype.size=function(){return this._size},r.prototype.clear=function(){for(var i=0;i<this._capacity;i++)this._keyBuckets[i].length=0,this._valBuckets[i].length=0;this._size=0},r.prototype.forEach=function(i){for(var n=0,s=0;s<this._capacity;s++)for(var a=this._keyBuckets[s],o=this._valBuckets[s],l=0;l<a.length;l++)i(a[l],o[l]),n+=1;return n},dr=r,dr}var pr,In;function vu(){if(In)return pr;In=1;var e=Ee();function t(r){if(!isFinite(r)||Math.floor(r)!==r||r<0)throw new Error("LruSet: invalid capacity");this._capacity=r,this._elements=new Array(this._capacity),this._start=0,this._size=0}return t.prototype._index=function(r){return e(this._start+r,this._capacity)},t.prototype.add=function(r){if(this._capacity===0)return r;this.remove(r);var i=this._size===this._capacity?this._elements[this._index(0)]:null;return this._elements[this._index(this._size)]=r,this._size<this._capacity?this._size++:this._start=this._index(1),i},t.prototype.remove=function(r){for(var i=0;i<this._size;i++){var n=this._elements[this._index(i)];if(r.equals(n)){for(var s=i;s<this._size-1;s++)this._elements[this._index(s)]=this._elements[this._index(s+1)];return this._size--,n}}return null},t.prototype.has=function(r){for(var i=0;i<this._size;i++)if(r.equals(this._elements[this._index(i)]))return!0;return!1},t.prototype.size=function(){return this._size},t.prototype.clear=function(){this._elements.length=0,this._start=0,this._size=0},t.prototype.forEach=function(r){for(var i=0,n=0;n<this._size;n++)r(this._elements[this._index(n)]),i+=1;return i},pr=t,pr}var _r,qn;function pe(){if(qn)return _r;qn=1;function e(t,r){for(var i in r)i in t||(t[i]=r[i]);return t}return _r=e,_r}var mr,On;function Va(){if(On)return mr;On=1;var e=$e();function t(r){return function(){var n=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],s=arguments.length?arguments[arguments.length-1]:e,a=null,o=!1;function l(){var h=arguments[0];!h||o?s.apply(null,arguments):a=r.apply(null,n)}return n.push(l),l(!0),function(){o=!0,a.apply(null,arguments)}}}return mr=t,mr}var yr,Dn;function Wa(){if(Dn)return yr;Dn=1;var e=cu(),t=Oa(),r=vu(),i=j(),n=pe(),s=Va(),a=fi(),o=de(),l=U(),h=typeof MARZIPANODEBUG<"u"&&MARZIPANODEBUG.textureStore,c={IDLE:0,START:1,MARK:2,END:3},f={previouslyVisibleCacheSize:512},_=0;function d(){}o(d,Error);function g(v,w){var x=this,m=_++;x._id=m,x._store=v,x._tile=w,x._asset=null,x._texture=null,x._changeHandler=function(){v.emit("textureInvalid",w)};var M=v.source(),u=v.stage(),C=M.loadAsset.bind(M),T=u.createTexture.bind(u),b=a(s(C),T);v.emit("textureStartLoad",w),h&&console.log("loading",m,w),x._cancel=b(u,w,function(P,z,R,A){if(x._cancel=null,P){R&&R.destroy(),A&&A.destroy(),P instanceof d?(v.emit("textureCancel",w),h&&console.log("cancel",m,w)):(v.emit("textureError",w,P),h&&console.log("error",m,w));return}x._texture=A,R.isDynamic()?(x._asset=R,R.addEventListener("change",x._changeHandler)):R.destroy(),v.emit("textureLoad",w),h&&console.log("load",m,w)})}g.prototype.asset=function(){return this._asset},g.prototype.texture=function(){return this._texture},g.prototype.destroy=function(){var v=this._id,w=this._store,x=this._tile,m=this._asset,M=this._texture,u=this._cancel;if(u){u(new d);return}m&&(m.removeEventListener("change",this._changeHandler),m.destroy()),M&&M.destroy(),w.emit("textureUnload",x),h&&console.log("unload",v,x),l(this)},i(g);function p(v,w,x){x=n(x||{},f),this._source=v,this._stage=w,this._state=c.IDLE,this._delimCount=0,this._itemMap=new e,this._visible=new t,this._previouslyVisible=new r(x.previouslyVisibleCacheSize),this._pinMap=new e,this._newVisible=new t,this._noLongerVisible=[],this._visibleAgain=[],this._evicted=[]}return i(p),p.prototype.destroy=function(){this.clear(),l(this)},p.prototype.stage=function(){return this._stage},p.prototype.source=function(){return this._source},p.prototype.clear=function(){var v=this;v._evicted.length=0,v._itemMap.forEach(function(w){v._evicted.push(w)}),v._evicted.forEach(function(w){v._unloadTile(w)}),v._itemMap.clear(),v._visible.clear(),v._previouslyVisible.clear(),v._pinMap.clear(),v._newVisible.clear(),v._noLongerVisible.length=0,v._visibleAgain.length=0,v._evicted.length=0},p.prototype.clearNotPinned=function(){var v=this;v._evicted.length=0,v._itemMap.forEach(function(w){v._pinMap.has(w)||v._evicted.push(w)}),v._evicted.forEach(function(w){v._unloadTile(w)}),v._visible.clear(),v._previouslyVisible.clear(),v._evicted.length=0},p.prototype.startFrame=function(){if(this._state!==c.IDLE&&this._state!==c.START)throw new Error("TextureStore: startFrame called out of sequence");this._state=c.START,this._delimCount++},p.prototype.markTile=function(v){if(this._state!==c.START&&this._state!==c.MARK)throw new Error("TextureStore: markTile called out of sequence");this._state=c.MARK;var w=this._itemMap.get(v),x=w&&w.texture(),m=w&&w.asset();x&&m&&x.refresh(v,m),this._newVisible.add(v)},p.prototype.endFrame=function(){if(this._state!==c.START&&this._state!==c.MARK&&this._state!==c.END)throw new Error("TextureStore: endFrame called out of sequence");this._state=c.END,this._delimCount--,this._delimCount||(this._update(),this._state=c.IDLE)},p.prototype._update=function(){var v=this;v._noLongerVisible.length=0,v._visible.forEach(function(x){v._newVisible.has(x)||v._noLongerVisible.push(x)}),v._visibleAgain.length=0,v._newVisible.forEach(function(x){v._previouslyVisible.has(x)&&v._visibleAgain.push(x)}),v._visibleAgain.forEach(function(x){v._previouslyVisible.remove(x)}),v._evicted.length=0,v._noLongerVisible.forEach(function(x){var m=v._itemMap.get(x),M=m&&m.texture();if(M){var u=v._previouslyVisible.add(x);u!=null&&v._evicted.push(u)}else m&&v._unloadTile(x)}),v._evicted.forEach(function(x){v._pinMap.has(x)||v._unloadTile(x)}),v._newVisible.forEach(function(x){var m=v._itemMap.get(x);m||v._loadTile(x)});var w=v._visible;v._visible=v._newVisible,v._newVisible=w,v._newVisible.clear(),v._noLongerVisible.length=0,v._visibleAgain.length=0,v._evicted.length=0},p.prototype._loadTile=function(v){if(this._itemMap.has(v))throw new Error("TextureStore: loading texture already in cache");var w=new g(this,v);this._itemMap.set(v,w)},p.prototype._unloadTile=function(v){var w=this._itemMap.del(v);if(!w)throw new Error("TextureStore: unloading texture not in cache");w.destroy()},p.prototype.asset=function(v){var w=this._itemMap.get(v);return w?w.asset():null},p.prototype.texture=function(v){var w=this._itemMap.get(v);return w?w.texture():null},p.prototype.pin=function(v){var w=(this._pinMap.get(v)||0)+1;return this._pinMap.set(v,w),this._itemMap.has(v)||this._loadTile(v),w},p.prototype.unpin=function(v){var w=this._pinMap.get(v);if(w)w--,w>0?this._pinMap.set(v,w):(this._pinMap.del(v),!this._visible.has(v)&&!this._previouslyVisible.has(v)&&this._unloadTile(v));else throw new Error("TextureStore: unpin when not pinned");return w},p.prototype.query=function(v){var w=this._itemMap.get(v),x=this._pinMap.get(v)||0;return{visible:this._visible.has(v),previouslyVisible:this._previouslyVisible.has(v),hasAsset:w!=null&&w.asset()!=null,hasTexture:w!=null&&w.texture()!=null,pinned:x!==0,pinCount:x}},yr=p,yr}var gr,Hn;function ka(){if(Hn)return gr;Hn=1;function e(t,r){for(var i in r)t[i]=r[i];return t}return gr=e,gr}var wr,$n;function Ya(){if($n)return wr;$n=1;var e=j(),t=ka(),r=U();function i(n,s,a,o,l){l=l||{};var h=this;this._source=n,this._geometry=s,this._view=a,this._textureStore=o,this._effects=l.effects||{},this._fixedLevelIndex=null,this._viewChangeHandler=function(){h.emit("viewChange",h.view())},this._view.addEventListener("change",this._viewChangeHandler),this._textureStoreChangeHandler=function(){h.emit("textureStoreChange",h.textureStore())},this._textureStore.addEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureInvalid",this._textureStoreChangeHandler)}return e(i),i.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._textureStore.removeEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureInvalid",this._textureStoreChangeHandler),r(this)},i.prototype.source=function(){return this._source},i.prototype.geometry=function(){return this._geometry},i.prototype.view=function(){return this._view},i.prototype.textureStore=function(){return this._textureStore},i.prototype.effects=function(){return this._effects},i.prototype.setEffects=function(n){this._effects=n,this.emit("effectsChange",this._effects)},i.prototype.mergeEffects=function(n){t(this._effects,n),this.emit("effectsChange",this._effects)},i.prototype.fixedLevel=function(){return this._fixedLevelIndex},i.prototype.setFixedLevel=function(n){if(n!==this._fixedLevelIndex){if(n!=null&&(n>=this._geometry.levelList.length||n<0))throw new Error("Level index out of range: "+n);this._fixedLevelIndex=n,this.emit("fixedLevelChange",this._fixedLevelIndex)}},i.prototype._selectLevel=function(){var n;return this._fixedLevelIndex!=null?n=this._geometry.levelList[this._fixedLevelIndex]:n=this._view.selectLevel(this._geometry.selectableLevelList),n},i.prototype.visibleTiles=function(n){var s=this._selectLevel();return this._geometry.visibleTiles(this._view,s,n)},i.prototype.pinLevel=function(n){for(var s=this._geometry.levelList[n],a=this._geometry.levelTiles(s),o=0;o<a.length;o++)this._textureStore.pin(a[o])},i.prototype.unpinLevel=function(n){for(var s=this._geometry.levelList[n],a=this._geometry.levelTiles(s),o=0;o<a.length;o++)this._textureStore.unpin(a[o])},i.prototype.pinFirstLevel=function(){return this.pinLevel(0)},i.prototype.unpinFirstLevel=function(){return this.unpinLevel(0)},wr=i,wr}var xr,Nn;function Xa(){if(Nn)return xr;Nn=1;var e=j(),t=U();function r(i){var n=this;this._stage=i,this._running=!1,this._rendering=!1,this._requestHandle=null,this._boundLoop=this._loop.bind(this),this._renderInvalidHandler=function(){n._rendering||n.renderOnNextFrame()},this._stage.addEventListener("renderInvalid",this._renderInvalidHandler)}return e(r),r.prototype.destroy=function(){this.stop(),this._stage.removeEventListener("renderInvalid",this._renderInvalidHandler),t(this)},r.prototype.stage=function(){return this._stage},r.prototype.start=function(){this._running=!0,this.renderOnNextFrame()},r.prototype.stop=function(){this._requestHandle&&(window.cancelAnimationFrame(this._requestHandle),this._requestHandle=null),this._running=!1},r.prototype.renderOnNextFrame=function(){this._running&&!this._requestHandle&&(this._requestHandle=window.requestAnimationFrame(this._boundLoop))},r.prototype._loop=function(){if(!this._running)throw new Error("Render loop running while in stopped state");this._requestHandle=null,this._rendering=!0,this.emit("beforeRender"),this._rendering=!1,this._stage.render(),this.emit("afterRender")},xr=r,xr}var Mr,Fn;function ye(){if(Fn)return Mr;Fn=1;function e(){this.velocity=null,this.friction=null,this.offset=null}e.equals=function(r,i){return r.velocity===i.velocity&&r.friction===i.friction&&r.offset===i.offset},e.prototype.equals=function(r){return e.equals(this,r)},e.prototype.update=function(r,i){r.offset&&(this.offset=this.offset||0,this.offset+=r.offset);var n=this.offsetFromVelocity(i);n&&(this.offset=this.offset||0,this.offset+=n),this.velocity=r.velocity,this.friction=r.friction},e.prototype.reset=function(){this.velocity=null,this.friction=null,this.offset=null},e.prototype.velocityAfter=function(r){return this.velocity?this.friction?t(this.velocity,this.friction*r):this.velocity:null},e.prototype.offsetFromVelocity=function(r){r=Math.min(r,this.nullVelocityTime());var i=this.velocityAfter(r),n=(this.velocity+i)/2;return n*r},e.prototype.nullVelocityTime=function(){return this.velocity==null?0:this.velocity&&!this.friction?1/0:Math.abs(this.velocity/this.friction)};function t(r,i){return r<0?Math.min(0,r+i):r>0?Math.max(0,r-i):0}return Mr=e,Mr}var Er,Vn;function Ba(){if(Vn)return Er;Vn=1;var e=j(),t=ye(),r=U();function i(n,s,a,o,l){if(!n)throw new Error("KeyControlMethod: keyCode must be defined");if(!s)throw new Error("KeyControlMethod: parameter must be defined");if(!a)throw new Error("KeyControlMethod: velocity must be defined");if(!o)throw new Error("KeyControlMethod: friction must be defined");l=l||document,this._keyCode=n,this._parameter=s,this._velocity=a,this._friction=o,this._element=l,this._keydownHandler=this._handlePress.bind(this),this._keyupHandler=this._handleRelease.bind(this),this._blurHandler=this._handleBlur.bind(this),this._element.addEventListener("keydown",this._keydownHandler),this._element.addEventListener("keyup",this._keyupHandler),window.addEventListener("blur",this._blurHandler),this._dynamics=new t,this._pressing=!1}return e(i),i.prototype.destroy=function(){this._element.removeEventListener("keydown",this._keydownHandler),this._element.removeEventListener("keyup",this._keyupHandler),window.removeEventListener("blur",this._blurHandler),r(this)},i.prototype._handlePress=function(n){n.keyCode===this._keyCode&&(this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active"))},i.prototype._handleRelease=function(n){n.keyCode===this._keyCode&&(this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1)},i.prototype._handleBlur=function(){this._dynamics.velocity=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive"),this._pressing=!1},Er=i,Er}var Tr={exports:{}};/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */var Wn;function Ua(){return Wn||(Wn=1,function(e){(function(t,r,i,n){var s=["","webkit","moz","MS","ms","o"],a=r.createElement("div"),o="function",l=Math.round,h=Math.abs,c=Date.now;function f(y,E,L){return setTimeout(w(y,L),E)}function _(y,E,L){return Array.isArray(y)?(d(y,L[E],L),!0):!1}function d(y,E,L){var q;if(y)if(y.forEach)y.forEach(E,L);else if(y.length!==n)for(q=0;q<y.length;)E.call(L,y[q],q,y),q++;else for(q in y)y.hasOwnProperty(q)&&E.call(L,y[q],q,y)}function g(y,E,L){for(var q=Object.keys(E),D=0;D<q.length;)(!L||L&&y[q[D]]===n)&&(y[q[D]]=E[q[D]]),D++;return y}function p(y,E){return g(y,E,!0)}function v(y,E,L){var q=E.prototype,D;D=y.prototype=Object.create(q),D.constructor=y,D._super=q,L&&g(D,L)}function w(y,E){return function(){return y.apply(E,arguments)}}function x(y,E){return typeof y==o?y.apply(E&&E[0]||n,E):y}function m(y,E){return y===n?E:y}function M(y,E,L){d(b(E),function(q){y.addEventListener(q,L,!1)})}function u(y,E,L){d(b(E),function(q){y.removeEventListener(q,L,!1)})}function C(y,E){for(;y;){if(y==E)return!0;y=y.parentNode}return!1}function T(y,E){return y.indexOf(E)>-1}function b(y){return y.trim().split(/\s+/g)}function P(y,E,L){if(y.indexOf&&!L)return y.indexOf(E);for(var q=0;q<y.length;){if(L&&y[q][L]==E||!L&&y[q]===E)return q;q++}return-1}function z(y){return Array.prototype.slice.call(y,0)}function R(y,E,L){for(var q=[],D=[],F=0;F<y.length;){var X=y[F][E];P(D,X)<0&&q.push(y[F]),D[F]=X,F++}return q=q.sort(function(re,ue){return re[E]>ue[E]}),q}function A(y,E){for(var L,q,D=E[0].toUpperCase()+E.slice(1),F=0;F<s.length;){if(L=s[F],q=L?L+D:E,q in y)return q;F++}return n}var O=1;function I(){return O++}function S(y){var E=y.ownerDocument;return E.defaultView||E.parentWindow}var N=/mobile|tablet|ip(ad|hone|od)|android/i,H="ontouchstart"in t,V=A(t,"PointerEvent")!==n,k=H&&N.test(navigator.userAgent),Y="touch",G="pen",K="mouse",ie="kinect",ge=25,Z=1,J=2,B=4,ee=8,he=1,we=2,xe=4,se=8,Pe=16,ve=we|xe,Te=se|Pe,ui=ve|Te,di=["x","y"],Fe=["clientX","clientY"];function ae(y,E){var L=this;this.manager=y,this.callback=E,this.element=y.element,this.target=y.options.inputTarget,this.domHandler=function(q){x(y.options.enable,[y])&&L.handler(q)},this.init()}ae.prototype={handler:function(){},init:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(S(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&u(this.element,this.evEl,this.domHandler),this.evTarget&&u(this.target,this.evTarget,this.domHandler),this.evWin&&u(S(this.element),this.evWin,this.domHandler)}};function oo(y){var E,L=y.options.inputClass;return L?E=L:V?E=nt:k?E=ke:H?E=st:E=We,new E(y,ho)}function ho(y,E,L){var q=L.pointers.length,D=L.changedPointers.length,F=E&Z&&q-D===0,X=E&(B|ee)&&q-D===0;L.isFirst=!!F,L.isFinal=!!X,F&&(y.session={}),L.eventType=E,lo(y,L),y.emit("hammer.input",L),y.recognize(L),y.session.prevInput=L}function lo(y,E){var L=y.session,q=E.pointers,D=q.length;L.firstInput||(L.firstInput=pi(E)),D>1&&!L.firstMultiple?L.firstMultiple=pi(E):D===1&&(L.firstMultiple=!1);var F=L.firstInput,X=L.firstMultiple,te=X?X.center:F.center,re=E.center=_i(q);E.timeStamp=c(),E.deltaTime=E.timeStamp-F.timeStamp,E.angle=it(te,re),E.distance=Ve(te,re),co(L,E),E.offsetDirection=mi(E.deltaX,E.deltaY),E.scale=X?po(X.pointers,q):1,E.rotation=X?uo(X.pointers,q):0,vo(L,E);var ue=y.element;C(E.srcEvent.target,ue)&&(ue=E.srcEvent.target),E.target=ue}function co(y,E){var L=E.center,q=y.offsetDelta||{},D=y.prevDelta||{},F=y.prevInput||{};(E.eventType===Z||F.eventType===B)&&(D=y.prevDelta={x:F.deltaX||0,y:F.deltaY||0},q=y.offsetDelta={x:L.x,y:L.y}),E.deltaX=D.x+(L.x-q.x),E.deltaY=D.y+(L.y-q.y)}function vo(y,E){var L=y.lastInterval||E,q=E.timeStamp-L.timeStamp,D,F,X,te;if(E.eventType!=ee&&(q>ge||L.velocity===n)){var re=L.deltaX-E.deltaX,ue=L.deltaY-E.deltaY,Re=fo(q,re,ue);F=Re.x,X=Re.y,D=h(Re.x)>h(Re.y)?Re.x:Re.y,te=mi(re,ue),y.lastInterval=E}else D=L.velocity,F=L.velocityX,X=L.velocityY,te=L.direction;E.velocity=D,E.velocityX=F,E.velocityY=X,E.direction=te}function pi(y){for(var E=[],L=0;L<y.pointers.length;)E[L]={clientX:l(y.pointers[L].clientX),clientY:l(y.pointers[L].clientY)},L++;return{timeStamp:c(),pointers:E,center:_i(E),deltaX:y.deltaX,deltaY:y.deltaY}}function _i(y){var E=y.length;if(E===1)return{x:l(y[0].clientX),y:l(y[0].clientY)};for(var L=0,q=0,D=0;D<E;)L+=y[D].clientX,q+=y[D].clientY,D++;return{x:l(L/E),y:l(q/E)}}function fo(y,E,L){return{x:E/y||0,y:L/y||0}}function mi(y,E){return y===E?he:h(y)>=h(E)?y>0?we:xe:E>0?se:Pe}function Ve(y,E,L){L||(L=di);var q=E[L[0]]-y[L[0]],D=E[L[1]]-y[L[1]];return Math.sqrt(q*q+D*D)}function it(y,E,L){L||(L=di);var q=E[L[0]]-y[L[0]],D=E[L[1]]-y[L[1]];return Math.atan2(D,q)*180/Math.PI}function uo(y,E){return it(E[1],E[0],Fe)-it(y[1],y[0],Fe)}function po(y,E){return Ve(E[0],E[1],Fe)/Ve(y[0],y[1],Fe)}var _o={mousedown:Z,mousemove:J,mouseup:B},mo="mousedown",yo="mousemove mouseup";function We(){this.evEl=mo,this.evWin=yo,this.allow=!0,this.pressed=!1,ae.apply(this,arguments)}v(We,ae,{handler:function(E){var L=_o[E.type];L&Z&&E.button===0&&(this.pressed=!0),L&J&&E.which!==1&&(L=B),!(!this.pressed||!this.allow)&&(L&B&&(this.pressed=!1),this.callback(this.manager,L,{pointers:[E],changedPointers:[E],pointerType:K,srcEvent:E}))}});var go={pointerdown:Z,pointermove:J,pointerup:B,pointercancel:ee,pointerout:ee},wo={2:Y,3:G,4:K,5:ie},yi="pointerdown",gi="pointermove pointerup pointercancel";t.MSPointerEvent&&(yi="MSPointerDown",gi="MSPointerMove MSPointerUp MSPointerCancel");function nt(){this.evEl=yi,this.evWin=gi,ae.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}v(nt,ae,{handler:function(E){var L=this.store,q=!1,D=E.type.toLowerCase().replace("ms",""),F=go[D],X=wo[E.pointerType]||E.pointerType,te=X==Y,re=P(L,E.pointerId,"pointerId");F&Z&&(E.button===0||te)?re<0&&(L.push(E),re=L.length-1):F&(B|ee)&&(q=!0),!(re<0)&&(L[re]=E,this.callback(this.manager,F,{pointers:L,changedPointers:[E],pointerType:X,srcEvent:E}),q&&L.splice(re,1))}});var xo={touchstart:Z,touchmove:J,touchend:B,touchcancel:ee},Mo="touchstart",Eo="touchstart touchmove touchend touchcancel";function wi(){this.evTarget=Mo,this.evWin=Eo,this.started=!1,ae.apply(this,arguments)}v(wi,ae,{handler:function(E){var L=xo[E.type];if(L===Z&&(this.started=!0),!!this.started){var q=To.call(this,E,L);L&(B|ee)&&q[0].length-q[1].length===0&&(this.started=!1),this.callback(this.manager,L,{pointers:q[0],changedPointers:q[1],pointerType:Y,srcEvent:E})}}});function To(y,E){var L=z(y.touches),q=z(y.changedTouches);return E&(B|ee)&&(L=R(L.concat(q),"identifier")),[L,q]}var bo={touchstart:Z,touchmove:J,touchend:B,touchcancel:ee},Co="touchstart touchmove touchend touchcancel";function ke(){this.evTarget=Co,this.targetIds={},ae.apply(this,arguments)}v(ke,ae,{handler:function(E){var L=bo[E.type],q=So.call(this,E,L);q&&this.callback(this.manager,L,{pointers:q[0],changedPointers:q[1],pointerType:Y,srcEvent:E})}});function So(y,E){var L=z(y.touches),q=this.targetIds;if(E&(Z|J)&&L.length===1)return q[L[0].identifier]=!0,[L,L];var D,F,X=z(y.changedTouches),te=[],re=this.target;if(F=L.filter(function(ue){return C(ue.target,re)}),E===Z)for(D=0;D<F.length;)q[F[D].identifier]=!0,D++;for(D=0;D<X.length;)q[X[D].identifier]&&te.push(X[D]),E&(B|ee)&&delete q[X[D].identifier],D++;if(te.length)return[R(F.concat(te),"identifier"),te]}function st(){ae.apply(this,arguments);var y=w(this.handler,this);this.touch=new ke(this.manager,y),this.mouse=new We(this.manager,y)}v(st,ae,{handler:function(E,L,q){var D=q.pointerType==Y,F=q.pointerType==K;if(D)this.mouse.allow=!1;else if(F&&!this.mouse.allow)return;L&(B|ee)&&(this.mouse.allow=!0),this.callback(E,L,q)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var xi=A(a.style,"touchAction"),Mi=xi!==n,Ei="compute",Ti="auto",at="manipulation",ze="none",Ae="pan-x",Ie="pan-y";function ot(y,E){this.manager=y,this.set(E)}ot.prototype={set:function(y){y==Ei&&(y=this.compute()),Mi&&(this.manager.element.style[xi]=y),this.actions=y.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var y=[];return d(this.manager.recognizers,function(E){x(E.options.enable,[E])&&(y=y.concat(E.getTouchAction()))}),Ro(y.join(" "))},preventDefaults:function(y){if(!Mi){var E=y.srcEvent,L=y.offsetDirection;if(this.manager.session.prevented){E.preventDefault();return}var q=this.actions,D=T(q,ze),F=T(q,Ie),X=T(q,Ae);if(D||F&&L&ve||X&&L&Te)return this.preventSrc(E)}},preventSrc:function(y){this.manager.session.prevented=!0,y.preventDefault()}};function Ro(y){if(T(y,ze))return ze;var E=T(y,Ae),L=T(y,Ie);return E&&L?Ae+" "+Ie:E||L?E?Ae:Ie:T(y,at)?at:Ti}var Ye=1,oe=2,Se=4,Me=8,_e=Me,qe=16,fe=32;function me(y){this.id=I(),this.manager=null,this.options=p(y||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=Ye,this.simultaneous={},this.requireFail=[]}me.prototype={defaults:{},set:function(y){return g(this.options,y),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(y){if(_(y,"recognizeWith",this))return this;var E=this.simultaneous;return y=Xe(y,this),E[y.id]||(E[y.id]=y,y.recognizeWith(this)),this},dropRecognizeWith:function(y){return _(y,"dropRecognizeWith",this)?this:(y=Xe(y,this),delete this.simultaneous[y.id],this)},requireFailure:function(y){if(_(y,"requireFailure",this))return this;var E=this.requireFail;return y=Xe(y,this),P(E,y)===-1&&(E.push(y),y.requireFailure(this)),this},dropRequireFailure:function(y){if(_(y,"dropRequireFailure",this))return this;y=Xe(y,this);var E=P(this.requireFail,y);return E>-1&&this.requireFail.splice(E,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(y){return!!this.simultaneous[y.id]},emit:function(y){var E=this,L=this.state;function q(D){E.manager.emit(E.options.event+(D?Lo(L):""),y)}L<Me&&q(!0),q(),L>=Me&&q(!0)},tryEmit:function(y){if(this.canEmit())return this.emit(y);this.state=fe},canEmit:function(){for(var y=0;y<this.requireFail.length;){if(!(this.requireFail[y].state&(fe|Ye)))return!1;y++}return!0},recognize:function(y){var E=g({},y);if(!x(this.options.enable,[this,E])){this.reset(),this.state=fe;return}this.state&(_e|qe|fe)&&(this.state=Ye),this.state=this.process(E),this.state&(oe|Se|Me|qe)&&this.tryEmit(E)},process:function(y){},getTouchAction:function(){},reset:function(){}};function Lo(y){return y&qe?"cancel":y&Me?"end":y&Se?"move":y&oe?"start":""}function bi(y){return y==Pe?"down":y==se?"up":y==we?"left":y==xe?"right":""}function Xe(y,E){var L=E.manager;return L?L.get(y):y}function le(){me.apply(this,arguments)}v(le,me,{defaults:{pointers:1},attrTest:function(y){var E=this.options.pointers;return E===0||y.pointers.length===E},process:function(y){var E=this.state,L=y.eventType,q=E&(oe|Se),D=this.attrTest(y);return q&&(L&ee||!D)?E|qe:q||D?L&B?E|Me:E&oe?E|Se:oe:fe}});function Be(){le.apply(this,arguments),this.pX=null,this.pY=null}v(Be,le,{defaults:{event:"pan",threshold:10,pointers:1,direction:ui},getTouchAction:function(){var y=this.options.direction,E=[];return y&ve&&E.push(Ie),y&Te&&E.push(Ae),E},directionTest:function(y){var E=this.options,L=!0,q=y.distance,D=y.direction,F=y.deltaX,X=y.deltaY;return D&E.direction||(E.direction&ve?(D=F===0?he:F<0?we:xe,L=F!=this.pX,q=Math.abs(y.deltaX)):(D=X===0?he:X<0?se:Pe,L=X!=this.pY,q=Math.abs(y.deltaY))),y.direction=D,L&&q>E.threshold&&D&E.direction},attrTest:function(y){return le.prototype.attrTest.call(this,y)&&(this.state&oe||!(this.state&oe)&&this.directionTest(y))},emit:function(y){this.pX=y.deltaX,this.pY=y.deltaY;var E=bi(y.direction);E&&this.manager.emit(this.options.event+E,y),this._super.emit.call(this,y)}});function ht(){le.apply(this,arguments)}v(ht,le,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ze]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.scale-1)>this.options.threshold||this.state&oe)},emit:function(y){if(this._super.emit.call(this,y),y.scale!==1){var E=y.scale<1?"in":"out";this.manager.emit(this.options.event+E,y)}}});function lt(){me.apply(this,arguments),this._timer=null,this._input=null}v(lt,me,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Ti]},process:function(y){var E=this.options,L=y.pointers.length===E.pointers,q=y.distance<E.threshold,D=y.deltaTime>E.time;if(this._input=y,!q||!L||y.eventType&(B|ee)&&!D)this.reset();else if(y.eventType&Z)this.reset(),this._timer=f(function(){this.state=_e,this.tryEmit()},E.time,this);else if(y.eventType&B)return _e;return fe},reset:function(){clearTimeout(this._timer)},emit:function(y){this.state===_e&&(y&&y.eventType&B?this.manager.emit(this.options.event+"up",y):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}});function ct(){le.apply(this,arguments)}v(ct,le,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ze]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.rotation)>this.options.threshold||this.state&oe)}});function vt(){le.apply(this,arguments)}v(vt,le,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:ve|Te,pointers:1},getTouchAction:function(){return Be.prototype.getTouchAction.call(this)},attrTest:function(y){var E=this.options.direction,L;return E&(ve|Te)?L=y.velocity:E&ve?L=y.velocityX:E&Te&&(L=y.velocityY),this._super.attrTest.call(this,y)&&E&y.direction&&y.distance>this.options.threshold&&h(L)>this.options.velocity&&y.eventType&B},emit:function(y){var E=bi(y.direction);E&&this.manager.emit(this.options.event+E,y),this.manager.emit(this.options.event,y)}});function Ue(){me.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}v(Ue,me,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[at]},process:function(y){var E=this.options,L=y.pointers.length===E.pointers,q=y.distance<E.threshold,D=y.deltaTime<E.time;if(this.reset(),y.eventType&Z&&this.count===0)return this.failTimeout();if(q&&D&&L){if(y.eventType!=B)return this.failTimeout();var F=this.pTime?y.timeStamp-this.pTime<E.interval:!0,X=!this.pCenter||Ve(this.pCenter,y.center)<E.posThreshold;this.pTime=y.timeStamp,this.pCenter=y.center,!X||!F?this.count=1:this.count+=1,this._input=y;var te=this.count%E.taps;if(te===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=_e,this.tryEmit()},E.interval,this),oe):_e}return fe},failTimeout:function(){return this._timer=f(function(){this.state=fe},this.options.interval,this),fe},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==_e&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function be(y,E){return E=E||{},E.recognizers=m(E.recognizers,be.defaults.preset),new ft(y,E)}be.VERSION="2.0.4",be.defaults={domEvents:!1,touchAction:Ei,enable:!0,inputTarget:null,inputClass:null,preset:[[ct,{enable:!1}],[ht,{enable:!1},["rotate"]],[vt,{direction:ve}],[Be,{direction:ve},["swipe"]],[Ue],[Ue,{event:"doubletap",taps:2},["tap"]],[lt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Po=1,Ci=2;function ft(y,E){E=E||{},this.options=p(E,be.defaults),this.options.inputTarget=this.options.inputTarget||y,this.handlers={},this.session={},this.recognizers=[],this.element=y,this.input=oo(this),this.touchAction=new ot(this,this.options.touchAction),Si(this,!0),d(E.recognizers,function(L){var q=this.add(new L[0](L[1]));L[2]&&q.recognizeWith(L[2]),L[3]&&q.requireFailure(L[3])},this)}ft.prototype={set:function(y){return g(this.options,y),y.touchAction&&this.touchAction.update(),y.inputTarget&&(this.input.destroy(),this.input.target=y.inputTarget,this.input.init()),this},stop:function(y){this.session.stopped=y?Ci:Po},recognize:function(y){var E=this.session;if(!E.stopped){this.touchAction.preventDefaults(y);var L,q=this.recognizers,D=E.curRecognizer;(!D||D&&D.state&_e)&&(D=E.curRecognizer=null);for(var F=0;F<q.length;)L=q[F],E.stopped!==Ci&&(!D||L==D||L.canRecognizeWith(D))?L.recognize(y):L.reset(),!D&&L.state&(oe|Se|Me)&&(D=E.curRecognizer=L),F++}},get:function(y){if(y instanceof me)return y;for(var E=this.recognizers,L=0;L<E.length;L++)if(E[L].options.event==y)return E[L];return null},add:function(y){if(_(y,"add",this))return this;var E=this.get(y.options.event);return E&&this.remove(E),this.recognizers.push(y),y.manager=this,this.touchAction.update(),y},remove:function(y){if(_(y,"remove",this))return this;var E=this.recognizers;return y=this.get(y),E.splice(P(E,y),1),this.touchAction.update(),this},on:function(y,E){var L=this.handlers;return d(b(y),function(q){L[q]=L[q]||[],L[q].push(E)}),this},off:function(y,E){var L=this.handlers;return d(b(y),function(q){E?L[q].splice(P(L[q],E),1):delete L[q]}),this},emit:function(y,E){this.options.domEvents&&zo(y,E);var L=this.handlers[y]&&this.handlers[y].slice();if(!(!L||!L.length)){E.type=y,E.preventDefault=function(){E.srcEvent.preventDefault()};for(var q=0;q<L.length;)L[q](E),q++}},destroy:function(){this.element&&Si(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Si(y,E){var L=y.element;d(y.options.cssProps,function(q,D){L.style[A(L.style,D)]=E?q:""})}function zo(y,E){var L=r.createEvent("Event");L.initEvent(y,!0,!0),L.gesture=E,E.target.dispatchEvent(L)}g(be,{INPUT_START:Z,INPUT_MOVE:J,INPUT_END:B,INPUT_CANCEL:ee,STATE_POSSIBLE:Ye,STATE_BEGAN:oe,STATE_CHANGED:Se,STATE_ENDED:Me,STATE_RECOGNIZED:_e,STATE_CANCELLED:qe,STATE_FAILED:fe,DIRECTION_NONE:he,DIRECTION_LEFT:we,DIRECTION_RIGHT:xe,DIRECTION_UP:se,DIRECTION_DOWN:Pe,DIRECTION_HORIZONTAL:ve,DIRECTION_VERTICAL:Te,DIRECTION_ALL:ui,Manager:ft,Input:ae,TouchAction:ot,TouchInput:ke,MouseInput:We,PointerEventInput:nt,TouchMouseInput:st,SingleTouchInput:wi,Recognizer:me,AttrRecognizer:le,Tap:Ue,Pan:Be,Swipe:vt,Pinch:ht,Rotate:ct,Press:lt,on:M,off:u,each:d,merge:p,extend:g,inherit:v,bindFn:w,prefixed:A}),e.exports?e.exports=be:t[i]=be})(window,document,"Hammer")}(Tr)),Tr.exports}var br,kn;function tt(){if(kn)return br;kn=1;var e=Ua(),t=1,r="MarzipanoHammerElementId";function i(a,o){return a[r]||(a[r]=t++),o+a[r]}function n(){this._managers={},this._refCount={}}n.prototype.get=function(a,o){var l=i(a,o);return this._managers[l]||(this._managers[l]=this._createManager(a,o),this._refCount[l]=0),this._refCount[l]++,new s(this,this._managers[l],a,o)},n.prototype._createManager=function(a,o){var l=new e.Manager(a);return o==="mouse"?l.add(new e.Pan({direction:e.DIRECTION_ALL,threshold:0})):(o==="touch"||o==="pen"||o==="kinect")&&(l.add(new e.Pan({direction:e.DIRECTION_ALL,threshold:20,pointers:1})),l.add(new e.Pinch)),l},n.prototype._releaseHandle=function(a,o){var l=i(a,o);this._refCount[l]&&(this._refCount[l]--,this._refCount[l]||(this._managers[l].destroy(),delete this._managers[l],delete this._refCount[l]))};function s(a,o,l,h){this._manager=o,this._element=l,this._type=h,this._hammerGestures=a,this._eventHandlers=[]}return s.prototype.on=function(a,o){var l=this._type,h=function(c){l===c.pointerType&&o(c)};this._eventHandlers.push({events:a,handler:h}),this._manager.on(a,h)},s.prototype.release=function(){for(var a=0;a<this._eventHandlers.length;a++){var o=this._eventHandlers[a];this._manager.off(o.events,o.handler)}this._hammerGestures._releaseHandle(this._element,this._type),this._manager=null,this._element=null,this._type=null,this._hammerGestures=null},s.prototype.manager=function(){return this._manager},br=new n,br}var Cr,Yn;function Ga(){if(Yn)return Cr;Yn=1;function e(r,i,n,s,a){var o=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));r=Math.max(r,o/s),t(i,n,r,a),a[0]=Math.abs(a[0]),a[1]=Math.abs(a[1])}function t(r,i,n,s){var a=Math.atan(i/r);s[0]=n*Math.cos(a),s[1]=n*Math.sin(a)}return Cr={maxFriction:e,changeVectorNorm:t},Cr}var Sr,Xn;function ja(){if(Xn)return Sr;Xn=1;var e=j(),t=ye(),r=tt(),i=pe(),n=Ga().maxFriction,s=U(),a={friction:6,maxFrictionTime:.3,hammerEvent:"pan"},o=typeof MARZIPANODEBUG<"u"&&MARZIPANODEBUG.controls;function l(c,f,_){if(this._element=c,this._opts=i(_||{},a),this._startEvent=null,this._lastEvent=null,this._active=!1,this._dynamics={x:new t,y:new t},this._hammer=r.get(c,f),this._hammer.on("hammer.input",this._handleHammerEvent.bind(this)),this._opts.hammerEvent!="pan"&&this._opts.hammerEvent!="pinch")throw new Error(this._opts.hammerEvent+" is not a hammerEvent managed in DragControlMethod");this._hammer.on(this._opts.hammerEvent+"start",this._handleStart.bind(this)),this._hammer.on(this._opts.hammerEvent+"move",this._handleMove.bind(this)),this._hammer.on(this._opts.hammerEvent+"end",this._handleEnd.bind(this)),this._hammer.on(this._opts.hammerEvent+"cancel",this._handleEnd.bind(this))}e(l),l.prototype.destroy=function(){this._hammer.release(),s(this)},l.prototype._handleHammerEvent=function(c){if(c.isFirst){if(o&&this._active)throw new Error("DragControlMethod active detected when already active");this._active=!0,this.emit("active")}if(c.isFinal){if(o&&!this._active)throw new Error("DragControlMethod inactive detected when already inactive");this._active=!1,this.emit("inactive")}},l.prototype._handleStart=function(c){c.preventDefault(),this._startEvent=c},l.prototype._handleMove=function(c){c.preventDefault(),this._startEvent&&(this._updateDynamicsMove(c),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y))},l.prototype._handleEnd=function(c){c.preventDefault(),this._startEvent&&(this._updateDynamicsRelease(c),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y)),this._startEvent=!1,this._lastEvent=!1},l.prototype._updateDynamicsMove=function(c){var f=c.deltaX,_=c.deltaY,d=this._lastEvent||this._startEvent;d&&(f-=d.deltaX,_-=d.deltaY);var g=this._element.getBoundingClientRect(),p=g.right-g.left,v=g.bottom-g.top;f/=p,_/=v,this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.offset=-f,this._dynamics.y.offset=-_,this._lastEvent=c};var h=[null,null];return l.prototype._updateDynamicsRelease=function(c){var f=this._element.getBoundingClientRect(),_=f.right-f.left,d=f.bottom-f.top,g=1e3*c.velocityX/_,p=1e3*c.velocityY/d;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=g,this._dynamics.y.velocity=p,n(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,h),this._dynamics.x.friction=h[0],this._dynamics.y.friction=h[1]},Sr=l,Sr}var Rr,Bn;function Za(){if(Bn)return Rr;Bn=1;var e=j(),t=ye(),r=tt(),i=pe(),n=Ga().maxFriction,s=U(),a={speed:8,friction:6,maxFrictionTime:.3};function o(h,c,f){this._element=h,this._opts=i(f||{},a),this._active=!1,this._hammer=r.get(h,c),this._dynamics={x:new t,y:new t},this._hammer.on("panstart",this._handleStart.bind(this)),this._hammer.on("panmove",this._handleMove.bind(this)),this._hammer.on("panend",this._handleRelease.bind(this)),this._hammer.on("pancancel",this._handleRelease.bind(this))}e(o),o.prototype.destroy=function(){this._hammer.release(),s(this)},o.prototype._handleStart=function(h){h.preventDefault(),this._active||(this._active=!0,this.emit("active"))},o.prototype._handleMove=function(h){h.preventDefault(),this._updateDynamics(h,!1)},o.prototype._handleRelease=function(h){h.preventDefault(),this._updateDynamics(h,!0),this._active&&(this._active=!1,this.emit("inactive"))};var l=[null,null];return o.prototype._updateDynamics=function(h,c){var f=this._element.getBoundingClientRect(),_=f.right-f.left,d=f.bottom-f.top,g=Math.max(_,d),p=h.deltaX/g*this._opts.speed,v=h.deltaY/g*this._opts.speed;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=p,this._dynamics.y.velocity=v,c&&(n(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,l),this._dynamics.x.friction=l[0],this._dynamics.y.friction=l[1]),this.emit("parameterDynamics","x",this._dynamics.x),this.emit("parameterDynamics","y",this._dynamics.y)},Rr=o,Rr}var Lr,Un;function Ka(){if(Un)return Lr;Un=1;var e=j(),t=ye(),r=pe(),i=U(),n={frictionTime:.2,zoomDelta:.001};function s(o,l){this._element=o,this._opts=r(l||{},n),this._dynamics=new t,this._eventList=[];var h=this._opts.frictionTime?this.withSmoothing:this.withoutSmoothing;this._wheelListener=h.bind(this),o.addEventListener("wheel",this._wheelListener)}e(s),s.prototype.destroy=function(){this._element.removeEventListener("wheel",this._wheelListener),i(this)},s.prototype.withoutSmoothing=function(o){this._dynamics.offset=a(o)*this._opts.zoomDelta,this.emit("parameterDynamics","zoom",this._dynamics),o.preventDefault(),this.emit("active"),this.emit("inactive")},s.prototype.withSmoothing=function(o){var l=o.timeStamp;for(this._eventList.push(o);this._eventList[0].timeStamp<l-this._opts.frictionTime*1e3;)this._eventList.shift(0);for(var h=0,c=0;c<this._eventList.length;c++){var f=a(this._eventList[c])*this._opts.zoomDelta;h+=f/this._opts.frictionTime}this._dynamics.velocity=h,this._dynamics.friction=Math.abs(h)/this._opts.frictionTime,this.emit("parameterDynamics","zoom",this._dynamics),o.preventDefault(),this.emit("active"),this.emit("inactive")};function a(o){var l=o.deltaMode==1?20:1;return o.deltaY*l}return Lr=s,Lr}var Pr,Gn;function Qa(){if(Gn)return Pr;Gn=1;var e=j(),t=ye(),r=tt(),i=U();function n(s,a,o){this._hammer=r.get(s,a),this._lastEvent=null,this._active=!1,this._dynamics=new t,this._hammer.on("pinchstart",this._handleStart.bind(this)),this._hammer.on("pinch",this._handleEvent.bind(this)),this._hammer.on("pinchend",this._handleEnd.bind(this)),this._hammer.on("pinchcancel",this._handleEnd.bind(this))}return e(n),n.prototype.destroy=function(){this._hammer.release(),i(this)},n.prototype._handleStart=function(){this._active||(this._active=!0,this.emit("active"))},n.prototype._handleEnd=function(){this._lastEvent=null,this._active&&(this._active=!1,this.emit("inactive"))},n.prototype._handleEvent=function(s){var a=s.scale;this._lastEvent&&(a/=this._lastEvent.scale),this._dynamics.offset=(a-1)*-1,this.emit("parameterDynamics","zoom",this._dynamics),this._lastEvent=s},Pr=n,Pr}var zr,jn;function fu(){if(jn)return zr;jn=1;var e=j(),t=ye(),r=U();function i(n){if(!n)throw new Error("VelocityControlMethod: parameter must be defined");this._parameter=n,this._dynamics=new t}return e(i),i.prototype.destroy=function(){r(this)},i.prototype.setVelocity=function(n){this._dynamics.velocity=n,this.emit("parameterDynamics",this._parameter,this._dynamics)},i.prototype.setFriction=function(n){this._dynamics.friction=n,this.emit("parameterDynamics",this._parameter,this._dynamics)},zr=i,zr}var Ar,Zn;function uu(){if(Zn)return Ar;Zn=1;var e=j(),t=ye(),r=U();function i(n,s,a,o){if(!n)throw new Error("ElementPressControlMethod: element must be defined");if(!s)throw new Error("ElementPressControlMethod: parameter must be defined");if(!a)throw new Error("ElementPressControlMethod: velocity must be defined");if(!o)throw new Error("ElementPressControlMethod: friction must be defined");this._element=n,this._pressHandler=this._handlePress.bind(this),this._releaseHandler=this._handleRelease.bind(this),n.addEventListener("mousedown",this._pressHandler),n.addEventListener("mouseup",this._releaseHandler),n.addEventListener("mouseleave",this._releaseHandler),n.addEventListener("touchstart",this._pressHandler),n.addEventListener("touchmove",this._releaseHandler),n.addEventListener("touchend",this._releaseHandler),this._parameter=s,this._velocity=a,this._friction=o,this._dynamics=new t,this._pressing=!1}return e(i),i.prototype.destroy=function(){this._element.removeEventListener("mousedown",this._pressHandler),this._element.removeEventListener("mouseup",this._releaseHandler),this._element.removeEventListener("mouseleave",this._releaseHandler),this._element.removeEventListener("touchstart",this._pressHandler),this._element.removeEventListener("touchmove",this._releaseHandler),this._element.removeEventListener("touchend",this._releaseHandler),r(this)},i.prototype._handlePress=function(){this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active")},i.prototype._handleRelease=function(){this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1},Ar=i,Ar}var Ir,Kn;function du(){if(Kn)return Ir;Kn=1;var e=j(),t=ye(),r=Ce(),i=U();function n(s){s=s||{},this._methods=[],this._parameters=["x","y","axisScaledX","axisScaledY","zoom","yaw","pitch","roll"],this._now=s.nowForTesting||r,this._composedOffsets={},this._composeReturn={offsets:this._composedOffsets,changing:null}}return e(n),n.prototype.add=function(s){if(!this.has(s)){var a={};this._parameters.forEach(function(h){a[h]={dynamics:new t,time:null}});var o=this._updateDynamics.bind(this,a),l={instance:s,dynamics:a,parameterDynamicsHandler:o};s.addEventListener("parameterDynamics",o),this._methods.push(l)}},n.prototype.remove=function(s){var a=this._indexOfInstance(s);if(a>=0){var o=this._methods.splice(a,1)[0];o.instance.removeEventListener("parameterDynamics",o.parameterDynamicsHandler)}},n.prototype.has=function(s){return this._indexOfInstance(s)>=0},n.prototype._indexOfInstance=function(s){for(var a=0;a<this._methods.length;a++)if(this._methods[a].instance===s)return a;return-1},n.prototype.list=function(){for(var s=[],a=0;a<this._methods.length;a++)s.push(this._methods[a].instance);return s},n.prototype._updateDynamics=function(s,a,o){var l=s[a];if(!l)throw new Error("Unknown control parameter "+a);var h=this._now();l.dynamics.update(o,(h-l.time)/1e3),l.time=h,this.emit("change")},n.prototype._resetComposedOffsets=function(){for(var s=0;s<this._parameters.length;s++)this._composedOffsets[this._parameters[s]]=0},n.prototype.offsets=function(){var s,a=!1,o=this._now();this._resetComposedOffsets();for(var l=0;l<this._methods.length;l++)for(var h=this._methods[l].dynamics,c=0;c<this._parameters.length;c++){s=this._parameters[c];var f=h[s],_=f.dynamics;_.offset!=null&&(this._composedOffsets[s]+=_.offset,_.offset=null);var d=(o-f.time)/1e3,g=_.offsetFromVelocity(d);g&&(this._composedOffsets[s]+=g);var p=_.velocityAfter(d);_.velocity=p,p&&(a=!0),f.time=o}return this._composeReturn.changing=a,this._composeReturn},n.prototype.destroy=function(){for(var s=this.list(),a=0;a<s.length;a++)this.remove(s[a]);i(this)},Ir=n,Ir}var qr,Qn;function Ja(){if(Qn)return qr;Qn=1;var e=j(),t=du(),r=U(),i=typeof MARZIPANODEBUG<"u"&&MARZIPANODEBUG.controls;function n(s){s=s||{},this._methods={},this._methodGroups={},this._composer=new t,this._enabled=s&&s.enabled?!!s.enabled:!0,this._activeCount=0,this.updatedViews_=[],this._attachedRenderLoop=null}return e(n),n.prototype.destroy=function(){this.detach(),this._composer.destroy(),r(this)},n.prototype.methods=function(){var s={};for(var a in this._methods)s[a]=this._methods[a];return s},n.prototype.method=function(s){return this._methods[s]},n.prototype.registerMethod=function(s,a,o){if(this._methods[s])throw new Error("Control method already registered with id "+s);this._methods[s]={instance:a,enabled:!1,active:!1,activeHandler:this._handleActive.bind(this,s),inactiveHandler:this._handleInactive.bind(this,s)},o&&this.enableMethod(s,a)},n.prototype.unregisterMethod=function(s){var a=this._methods[s];if(!a)throw new Error("No control method registered with id "+s);a.enabled&&this.disableMethod(s),delete this._methods[s]},n.prototype.enableMethod=function(s){var a=this._methods[s];if(!a)throw new Error("No control method registered with id "+s);a.enabled||(a.enabled=!0,a.active&&this._incrementActiveCount(),this._listen(s),this._updateComposer(),this.emit("methodEnabled",s))},n.prototype.disableMethod=function(s){var a=this._methods[s];if(!a)throw new Error("No control method registered with id "+s);a.enabled&&(a.enabled=!1,a.active&&this._decrementActiveCount(),this._unlisten(s),this._updateComposer(),this.emit("methodDisabled",s))},n.prototype.addMethodGroup=function(s,a){this._methodGroups[s]=a},n.prototype.removeMethodGroup=function(s){delete this._methodGroups[s]},n.prototype.methodGroups=function(){var s={};for(var a in this._methodGroups)s[a]=this._methodGroups[a];return s},n.prototype.enableMethodGroup=function(s){var a=this;a._methodGroups[s].forEach(function(o){a.enableMethod(o)})},n.prototype.disableMethodGroup=function(s){var a=this;a._methodGroups[s].forEach(function(o){a.disableMethod(o)})},n.prototype.enabled=function(){return this._enabled},n.prototype.enable=function(){this._enabled||(this._enabled=!0,this._activeCount>0&&this.emit("active"),this.emit("enabled"),this._updateComposer())},n.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._activeCount>0&&this.emit("inactive"),this.emit("disabled"),this._updateComposer())},n.prototype.attach=function(s){this._attachedRenderLoop&&this.detach(),this._attachedRenderLoop=s,this._beforeRenderHandler=this._updateViewsWithControls.bind(this),this._changeHandler=s.renderOnNextFrame.bind(s),this._attachedRenderLoop.addEventListener("beforeRender",this._beforeRenderHandler),this._composer.addEventListener("change",this._changeHandler)},n.prototype.detach=function(){this._attachedRenderLoop&&(this._attachedRenderLoop.removeEventListener("beforeRender",this._beforeRenderHandler),this._composer.removeEventListener("change",this._changeHandler),this._beforeRenderHandler=null,this._changeHandler=null,this._attachedRenderLoop=null)},n.prototype.attached=function(){return this._attachedRenderLoop!=null},n.prototype._listen=function(s){var a=this._methods[s];if(!a)throw new Error("Bad method id");a.instance.addEventListener("active",a.activeHandler),a.instance.addEventListener("inactive",a.inactiveHandler)},n.prototype._unlisten=function(s){var a=this._methods[s];if(!a)throw new Error("Bad method id");a.instance.removeEventListener("active",a.activeHandler),a.instance.removeEventListener("inactive",a.inactiveHandler)},n.prototype._handleActive=function(s){var a=this._methods[s];if(!a)throw new Error("Bad method id");if(!a.enabled)throw new Error("Should not receive event from disabled control method");a.active||(a.active=!0,this._incrementActiveCount())},n.prototype._handleInactive=function(s){var a=this._methods[s];if(!a)throw new Error("Bad method id");if(!a.enabled)throw new Error("Should not receive event from disabled control method");a.active&&(a.active=!1,this._decrementActiveCount())},n.prototype._incrementActiveCount=function(){this._activeCount++,i&&this._checkActiveCount(),this._enabled&&this._activeCount===1&&this.emit("active")},n.prototype._decrementActiveCount=function(){this._activeCount--,i&&this._checkActiveCount(),this._enabled&&this._activeCount===0&&this.emit("inactive")},n.prototype._checkActiveCount=function(){var s=0;for(var a in this._methods){var o=this._methods[a];o.enabled&&o.active&&s++}if(s!=this._activeCount)throw new Error("Bad control state")},n.prototype._updateComposer=function(){var s=this._composer;for(var a in this._methods){var o=this._methods[a],l=this._enabled&&o.enabled;l&&!s.has(o.instance)&&s.add(o.instance),!l&&s.has(o.instance)&&s.remove(o.instance)}},n.prototype._updateViewsWithControls=function(){var s=this._composer.offsets();s.changing&&this._attachedRenderLoop.renderOnNextFrame(),this.updatedViews_.length=0;for(var a=this._attachedRenderLoop.stage().listLayers(),o=0;o<a.length;o++){var l=a[o].view();this.updatedViews_.indexOf(l)<0&&(a[o].view().updateWithControlParameters(s.offsets),this.updatedViews_.push(l))}},qr=n,qr}var Or,Jn;function eo(){if(Jn)return Or;Jn=1;var e=ne().setTransform,t=vi();function r(i,n,s,a){a=a||"";var o="translateX("+t(n)+"px) translateY("+t(s)+"px) translateZ(0) "+a;e(i,o)}return Or=r,Or}var Dr,es;function to(){if(es)return Dr;es=1;var e=j(),t=eo(),r=ne().setTransform,i=U();function n(s,a,o,l,h){h=h||{},h.perspective=h.perspective||{},h.perspective.extraTransforms=h.perspective.extraTransforms!=null?h.perspective.extraTransforms:"",this._domElement=s,this._parentDomElement=a,this._view=o,this._coords={},this._perspective={},this.setPosition(l),this._parentDomElement.appendChild(this._domElement),this.setPerspective(h.perspective),this._visible=!0,this._position={x:0,y:0}}return e(n),n.prototype.destroy=function(){this._parentDomElement.removeChild(this._domElement),i(this)},n.prototype.domElement=function(){return this._domElement},n.prototype.position=function(){return this._coords},n.prototype.setPosition=function(s){for(var a in s)this._coords[a]=s[a];this._update()},n.prototype.perspective=function(){return this._perspective},n.prototype.setPerspective=function(s){for(var a in s)this._perspective[a]=s[a];this._update()},n.prototype.show=function(){this._visible||(this._visible=!0,this._update())},n.prototype.hide=function(){this._visible&&(this._visible=!1,this._update())},n.prototype._update=function(){var s=this._domElement,a=this._coords,o=this._position,l,h,c=!1;if(this._visible){var f=this._view;this._perspective.radius?(c=!0,this._setEmbeddedPosition(f,a)):(f.coordinatesToScreen(a,o),l=o.x,h=o.y,l!=null&&h!=null&&(c=!0,this._setPosition(l,h)))}c?(s.style.display="block",s.style.position="absolute"):(s.style.display="none",s.style.position="")},n.prototype._setEmbeddedPosition=function(s,a){var o=s.coordinatesToPerspectiveTransform(a,this._perspective.radius,this._perspective.extraTransforms);r(this._domElement,o)},n.prototype._setPosition=function(s,a){t(this._domElement,s,a,this._perspective.extraTransforms)},Dr=n,Dr}var Hr,ts;function ro(){if(ts)return Hr;ts=1;var e=j(),t=to(),r=ps(),i=eo(),n=ne().setAbsolute,s=ne().setOverflowHidden,a=ne().setOverflowVisible,o=ne().setNullSize,l=ne().setPixelSize,h=ne().setWithVendorPrefix("pointer-events"),c=U();function f(_,d,g,p,v){v=v||{},this._parentDomElement=_,this._stage=d,this._view=g,this._renderLoop=p,this._hotspots=[],this._visible=!0,this._rect=v.rect,this._visibilityOrRectChanged=!0,this._stageWidth=null,this._stageHeight=null,this._tmpRect={},this._hotspotContainerWrapper=document.createElement("div"),n(this._hotspotContainerWrapper),h(this._hotspotContainerWrapper,"none"),this._parentDomElement.appendChild(this._hotspotContainerWrapper),this._hotspotContainer=document.createElement("div"),n(this._hotspotContainer),h(this._hotspotContainer,"all"),this._hotspotContainerWrapper.appendChild(this._hotspotContainer),this._updateHandler=this._update.bind(this),this._renderLoop.addEventListener("afterRender",this._updateHandler)}return e(f),f.prototype.destroy=function(){for(;this._hotspots.length;)this.destroyHotspot(this._hotspots[0]);this._parentDomElement.removeChild(this._hotspotContainerWrapper),this._renderLoop.removeEventListener("afterRender",this._updateHandler),c(this)},f.prototype.domElement=function(){return this._hotspotContainer},f.prototype.setRect=function(_){this._rect=_,this._visibilityOrRectChanged=!0},f.prototype.rect=function(){return this._rect},f.prototype.createHotspot=function(_,d,g){d=d||{};var p=new t(_,this._hotspotContainer,this._view,d,g);return this._hotspots.push(p),p._update(),this.emit("hotspotsChange"),p},f.prototype.hasHotspot=function(_){return this._hotspots.indexOf(_)>=0},f.prototype.listHotspots=function(){return[].concat(this._hotspots)},f.prototype.destroyHotspot=function(_){var d=this._hotspots.indexOf(_);if(d<0)throw new Error("No such hotspot");this._hotspots.splice(d,1),_.destroy(),this.emit("hotspotsChange")},f.prototype.hide=function(){this._visible&&(this._visible=!1,this._visibilityOrRectChanged=!0,this._update())},f.prototype.show=function(){this._visible||(this._visible=!0,this._visibilityOrRectChanged=!0,this._update())},f.prototype._update=function(){var _=this._hotspotContainerWrapper,d=this._stage.width(),g=this._stage.height(),p=this._tmpRect;if(this._visibilityOrRectChanged||this._rect&&(d!==this._stageWidth||g!==this._stageHeight)){var v=this._visible;_.style.display=v?"block":"none",v&&(this._rect?(r(d,g,this._rect,p),i(_,d*p.x,g*p.y),l(_,d*p.width,g*p.height),s(_)):(i(_,0,0),o(_),a(_))),this._stageWidth=d,this._stageHeight=g,this._visibilityOrRectChanged=!1}for(var w=0;w<this._hotspots.length;w++)this._hotspots[w]._update()},Hr=f,Hr}var $r,rs;function io(){if(rs)return $r;rs=1;var e=Ya(),t=Wa(),r=ro(),i=j(),n=Ce(),s=$e(),a=He(),o=pe(),l=U();function h(c,f){this._viewer=c,this._view=f,this._layers=[],this._hotspotContainer=new r(c._controlContainer,c.stage(),this._view,c.renderLoop()),this._movement=null,this._movementStartTime=null,this._movementStep=null,this._movementParams=null,this._movementCallback=null,this._updateMovementHandler=this._updateMovement.bind(this),this._updateHotspotContainerHandler=this._updateHotspotContainer.bind(this),this._viewer.addEventListener("sceneChange",this._updateHotspotContainerHandler),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._view.addEventListener("change",this._viewChangeHandler),this._updateHotspotContainer()}return i(h),h.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._viewer.removeEventListener("sceneChange",this._updateHotspotContainerHandler),this._movement&&this.stopMovement(),this._hotspotContainer.destroy(),this.destroyAllLayers(),l(this)},h.prototype.hotspotContainer=function(){return this._hotspotContainer},h.prototype.layer=function(){return this._layers[0]},h.prototype.listLayers=function(){return[].concat(this._layers)},h.prototype.view=function(){return this._view},h.prototype.viewer=function(){return this._viewer},h.prototype.visible=function(){return this._viewer.scene()===this},h.prototype.createLayer=function(c){c=c||{};var f=c.textureStoreOpts||{},_=c.layerOpts||{},d=c.source,g=c.geometry,p=this._view,v=this._viewer.stage(),w=new t(d,v,f),x=new e(d,g,p,w,_);return this._layers.push(x),c.pinFirstLevel&&x.pinFirstLevel(),this.emit("layerChange"),x},h.prototype.destroyLayer=function(c){var f=this._layers.indexOf(c);if(f<0)throw new Error("No such layer in scene");this._layers.splice(f,1),this.emit("layerChange"),c.textureStore().destroy(),c.destroy()},h.prototype.destroyAllLayers=function(){for(;this._layers.length>0;)this.destroyLayer(this._layers[0])},h.prototype.switchTo=function(c,f){return this._viewer.switchScene(this,c,f)},h.prototype.lookTo=function(c,f,_){var d=this;if(f=f||{},_=_||s,a(c)!=="object")throw new Error("Target view parameters must be an object");var g=function(b){return(b*=2)<1?.5*b*b:-.5*(--b*(b-2)-1)},p=f.ease!=null?f.ease:g,v=f.controlsInterrupt!=null?f.controlsInterrupt:!1,w=f.transitionDuration!=null?f.transitionDuration:1e3,x=f.shortest!=null?f.shortest:!0,m=this._view,M=m.parameters(),u={};o(u,c),o(u,M),x&&m.normalizeToClosest&&m.normalizeToClosest(u,u);var C=function(){var b=!1;return function(P,z){if(z>=w&&b)return null;var R=Math.min(z/w,1);for(var A in P){var O=M[A],I=u[A];P[A]=O+p(R)*(I-O)}return b=z>=w,P}},T=this._viewer.controls().enabled();v||this._viewer.controls().disable(),this.startMovement(C,function(){T&&d._viewer.controls().enable(),_()})},h.prototype.startMovement=function(c,f){var _=this._viewer.renderLoop();this._movement&&this.stopMovement();var d=c();if(typeof d!="function")throw new Error("Bad movement");this._movement=c,this._movementStep=d,this._movementStartTime=n(),this._movementParams={},this._movementCallback=f,_.addEventListener("beforeRender",this._updateMovementHandler),_.renderOnNextFrame()},h.prototype.stopMovement=function(){var c=this._movementCallback,f=this._viewer.renderLoop();this._movement&&(this._movement=null,this._movementStep=null,this._movementStartTime=null,this._movementParams=null,this._movementCallback=null,f.removeEventListener("beforeRender",this._updateMovementHandler),c&&c())},h.prototype.movement=function(){return this._movement},h.prototype._updateMovement=function(){if(!this._movement)throw new Error("Should not call update");var c=this._viewer.renderLoop(),f=this._view,_=n()-this._movementStartTime,d=this._movementStep,g=this._movementParams;g=f.parameters(g),g=d(g,_),g==null?this.stopMovement():(f.setParameters(g),c.renderOnNextFrame())},h.prototype._updateHotspotContainer=function(){this.visible()?this._hotspotContainer.show():this._hotspotContainer.hide()},$r=h,$r}var Nr,is;function pu(){if(is)return Nr;is=1;var e=j(),t=pe(),r=Ce(),i={duration:1/0};function n(s){s=t(s||{},i),this._duration=s.duration,this._startTime=null,this._handle=null,this._check=this._check.bind(this)}return e(n),n.prototype.start=function(){this._startTime=r(),this._handle==null&&this._duration<1/0&&this._setup(this._duration)},n.prototype.started=function(){return this._startTime!=null},n.prototype.stop=function(){this._startTime=null,this._handle!=null&&(clearTimeout(this._handle),this._handle=null)},n.prototype._setup=function(s){this._handle=setTimeout(this._check,s)},n.prototype._teardown=function(){clearTimeout(this._handle),this._handle=null},n.prototype._check=function(){var s=r(),a=s-this._startTime,o=this._duration-a;this._teardown(),o<=0?(this.emit("timeout"),this._startTime=null):o<1/0&&this._setup(o)},n.prototype.duration=function(){return this._duration},n.prototype.setDuration=function(s){this._duration=s,this._startTime!=null&&this._check()},Nr=n,Nr}var Fr,ns;function _u(){if(ns)return Fr;ns=1;var e=pe(),t=U(),r={active:"move",inactive:"default",disabled:"default"};function i(n,s,a,o){o=e(o||{},r),this._element=a,this._controls=n,this._id=s,this._attached=!1,this._setActiveCursor=this._setCursor.bind(this,o.active),this._setInactiveCursor=this._setCursor.bind(this,o.inactive),this._setDisabledCursor=this._setCursor.bind(this,o.disabled),this._setOriginalCursor=this._setCursor.bind(this,this._element.style.cursor),this._updateAttachmentHandler=this._updateAttachment.bind(this),n.addEventListener("methodEnabled",this._updateAttachmentHandler),n.addEventListener("methodDisabled",this._updateAttachmentHandler),n.addEventListener("enabled",this._updateAttachmentHandler),n.addEventListener("disabled",this._updateAttachmentHandler),this._updateAttachment()}return i.prototype.destroy=function(){this._detachFromControlMethod(this._controls.method(this._id)),this._setOriginalCursor(),this._controls.removeEventListener("methodEnabled",this._updateAttachmentHandler),this._controls.removeEventListener("methodDisabled",this._updateAttachmentHandler),this._controls.removeEventListener("enabled",this._updateAttachmentHandler),this._controls.removeEventListener("disabled",this._updateAttachmentHandler),t(this)},i.prototype._updateAttachment=function(){var n=this._controls,s=this._id;n.enabled()&&n.method(s).enabled?this._attachToControlMethod(n.method(s)):this._detachFromControlMethod(n.method(s))},i.prototype._attachToControlMethod=function(n){this._attached||(n.instance.addEventListener("active",this._setActiveCursor),n.instance.addEventListener("inactive",this._setInactiveCursor),n.active?this._setActiveCursor():this._setInactiveCursor(),this._attached=!0)},i.prototype._detachFromControlMethod=function(n){this._attached&&(n.instance.removeEventListener("active",this._setActiveCursor),n.instance.removeEventListener("inactive",this._setInactiveCursor),this._setDisabledCursor(),this._attached=!1)},i.prototype._setCursor=function(n){this._element.style.cursor=n},Fr=i,Fr}var Vr,ss;function no(){if(ss)return Vr;ss=1;var e=pe(),t=ja(),r=Za(),i=Ka(),n=Qa(),s=Ba(),a={mouseViewMode:"drag",dragMode:"pan"};function o(l,h,c){c=e(c||{},a);var f={mouseViewDrag:new t(h,"mouse"),mouseViewQtvr:new r(h,"mouse"),leftArrowKey:new s(37,"x",-.7,3),rightArrowKey:new s(39,"x",.7,3),upArrowKey:new s(38,"y",-.7,3),downArrowKey:new s(40,"y",.7,3),plusKey:new s(107,"zoom",-.7,3),minusKey:new s(109,"zoom",.7,3),wKey:new s(87,"y",-.7,3),aKey:new s(65,"x",-.7,3),sKey:new s(83,"y",.7,3),dKey:new s(68,"x",.7,3),qKey:new s(81,"roll",.7,3),eKey:new s(69,"roll",-.7,3)},_=["scrollZoom","touchView","pinch"];c.scrollZoom!==!1&&(f.scrollZoom=new i(h));var d={arrowKeys:["leftArrowKey","rightArrowKey","upArrowKey","downArrowKey"],plusMinusKeys:["plusKey","minusKey"],wasdKeys:["wKey","aKey","sKey","dKey"],qeKeys:["qKey","eKey"]};switch(c.dragMode){case"pinch":f.pinch=new t(h,"touch",{hammerEvent:"pinch"});break;case"pan":f.touchView=new t(h,"touch"),f.pinch=new n(h,"touch");break;default:throw new Error("Unknown drag mode: "+c.dragMode)}switch(c.mouseViewMode){case"drag":_.push("mouseViewDrag");break;case"qtvr":_.push("mouseViewQtvr");break;default:throw new Error("Unknown mouse view mode: "+c.mouseViewMode)}for(var g in f){var p=f[g];l.registerMethod(g,p),_.indexOf(g)>=0&&l.enableMethod(g)}for(var v in d){var w=d[v];l.addMethodGroup(v,w)}return f}return Vr=o,Vr}var Wr,as;function so(){if(as)return Wr;as=1;var e=Ce();function t(r,i,n){var s=!1,a=e();function o(){if(!s){var l=(e()-a)/r;l<1?(i(l),requestAnimationFrame(o)):(i(1),n())}}return i(0),requestAnimationFrame(o),function(){s=!0,n.apply(null,arguments)}}return Wr=t,Wr}var kr,os;function mu(){if(os)return kr;os=1;var e=j(),t=Xa(),r=Ja(),i=io(),n=pu(),s=ws(),a=_u(),o=tt(),l=no(),h=qa(),c=ne().setOverflowHidden,f=ne().setAbsolute,_=ne().setFullSize,d=so(),g=$e(),p=U();function v(m,M){M=M||{},this._domElement=m,c(m),this._stage=new s(M.stage),h(this._stage),this._domElement.appendChild(this._stage.domElement()),this._controlContainer=document.createElement("div"),f(this._controlContainer),_(this._controlContainer),m.appendChild(this._controlContainer),this._size={},this.updateSize(),this._updateSizeListener=this.updateSize.bind(this),window.addEventListener("resize",this._updateSizeListener),this._renderLoop=new t(this._stage),this._controls=new r,this._controlMethods=l(this._controls,this._controlContainer,M.controls),this._controls.attach(this._renderLoop),this._hammerManagerTouch=o.get(this._controlContainer,"touch"),this._hammerManagerMouse=o.get(this._controlContainer,"mouse"),this._dragCursor=new a(this._controls,"mouseViewDrag",m,M.cursors&&M.cursors.drag||{}),this._renderLoop.start(),this._scenes=[],this._currentScene=null,this._replacedScene=null,this._cancelCurrentTween=null,this._layerChangeHandler=this._updateSceneLayers.bind(this),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._idleTimer=new n,this._idleTimer.start(),this._resetIdleTimerHandler=this._resetIdleTimer.bind(this),this.addEventListener("viewChange",this._resetIdleTimerHandler),this._triggerIdleTimerHandler=this._triggerIdleTimer.bind(this),this._idleTimer.addEventListener("timeout",this._triggerIdleTimerHandler),this._stopMovementHandler=this.stopMovement.bind(this),this._controls.addEventListener("active",this._stopMovementHandler),this.addEventListener("sceneChange",this._stopMovementHandler),this._idleMovement=null}e(v),v.prototype.destroy=function(){window.removeEventListener("resize",this._updateSizeListener),this._currentScene&&this._removeSceneEventListeners(this._currentScene),this._replacedScene&&this._removeSceneEventListeners(this._replacedScene),this._dragCursor.destroy();for(var m in this._controlMethods)this._controlMethods[m].destroy();for(;this._scenes.length;)this.destroyScene(this._scenes[0]);this._domElement.removeChild(this._stage.domElement()),this._stage.destroy(),this._renderLoop.destroy(),this._controls.destroy(),this._controls=null,this._cancelCurrentTween&&this._cancelCurrentTween(),p(this)},v.prototype.updateSize=function(){var m=this._size;m.width=this._domElement.clientWidth,m.height=this._domElement.clientHeight,this._stage.setSize(m)},v.prototype.stage=function(){return this._stage},v.prototype.renderLoop=function(){return this._renderLoop},v.prototype.controls=function(){return this._controls},v.prototype.domElement=function(){return this._domElement},v.prototype.createScene=function(m){m=m||{};var M=this.createEmptyScene({view:m.view});return M.createLayer({source:m.source,geometry:m.geometry,pinFirstLevel:m.pinFirstLevel,textureStoreOpts:m.textureStoreOpts,layerOpts:m.layerOpts}),M},v.prototype.createEmptyScene=function(m){m=m||{};var M=new i(this,m.view);return this._scenes.push(M),M},v.prototype._updateSceneLayers=function(){var m,M,u=this._stage,C=this._currentScene,T=this._replacedScene,b=u.listLayers(),P=[];if(T&&(P=P.concat(T.listLayers())),C&&(P=P.concat(C.listLayers())),Math.abs(b.length-P.length)!==1)throw new Error("Stage and scene out of sync");if(P.length<b.length){for(m=0;m<b.length;m++)if(M=b[m],P.indexOf(M)<0){this._removeLayerFromStage(M);break}}if(P.length>b.length)for(m=0;m<P.length;m++)M=P[m],b.indexOf(M)<0&&this._addLayerToStage(M,m)},v.prototype._addLayerToStage=function(m,M){m.pinFirstLevel(),this._stage.addLayer(m,M)},v.prototype._removeLayerFromStage=function(m){this._stage.removeLayer(m),m.unpinFirstLevel(),m.textureStore().clearNotPinned()},v.prototype._addSceneEventListeners=function(m){m.addEventListener("layerChange",this._layerChangeHandler),m.addEventListener("viewChange",this._viewChangeHandler)},v.prototype._removeSceneEventListeners=function(m){m.removeEventListener("layerChange",this._layerChangeHandler),m.removeEventListener("viewChange",this._viewChangeHandler)},v.prototype.destroyScene=function(m){var M=this._scenes.indexOf(m);if(M<0)throw new Error("No such scene in viewer");var u,C;if(this._currentScene===m){for(this._removeSceneEventListeners(m),C=m.listLayers(),u=0;u<C.length;u++)this._removeLayerFromStage(C[u]);this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null),this._currentScene=null,this.emit("sceneChange")}if(this._replacedScene===m){for(this._removeSceneEventListeners(m),C=m.listLayers(),u=0;u<C.length;u++)this._removeLayerFromStage(C[u]);this._replacedScene=null}this._scenes.splice(M,1),m.destroy()},v.prototype.destroyAllScenes=function(){for(;this._scenes.length>0;)this.destroyScene(this._scenes[0])},v.prototype.hasScene=function(m){return this._scenes.indexOf(m)>=0},v.prototype.listScenes=function(){return[].concat(this._scenes)},v.prototype.scene=function(){return this._currentScene},v.prototype.view=function(){var m=this._currentScene;return m?m.view():null},v.prototype.lookTo=function(m,M,u){var C=this._currentScene;C&&C.lookTo(m,M,u)},v.prototype.startMovement=function(m,M){var u=this._currentScene;u&&u.startMovement(m,M)},v.prototype.stopMovement=function(){var m=this._currentScene;m&&m.stopMovement()},v.prototype.movement=function(){var m=this._currentScene;if(m)return m.movement()},v.prototype.setIdleMovement=function(m,M){this._idleTimer.setDuration(m),this._idleMovement=M},v.prototype.breakIdleMovement=function(){this.stopMovement(),this._resetIdleTimer()},v.prototype._resetIdleTimer=function(){this._idleTimer.start()},v.prototype._triggerIdleTimer=function(){var m=this._idleMovement;m&&this.startMovement(m)};var w=1e3;function x(m,M,u){var C=M.listLayers();C.forEach(function(T){T.mergeEffects({opacity:m})}),M._hotspotContainer.domElement().style.opacity=m}return v.prototype.switchScene=function(m,M,u){var C=this;M=M||{},u=u||g;var T=this._stage,b=this._currentScene;if(b===m){u();return}if(this._scenes.indexOf(m)<0)throw new Error("No such scene in viewer");this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null);var P=b?b.listLayers():[],z=m.listLayers(),R=T.listLayers();if(b&&(R.length!==P.length||R.length>1&&R[0]!=P[0]))throw new Error("Stage not in sync with viewer");for(var A=M.transitionDuration!=null?M.transitionDuration:w,O=M.transitionUpdate!=null?M.transitionUpdate:x,I=0;I<z.length;I++)this._addLayerToStage(z[I]);function S(H){O(H,m,b)}function N(){if(C._replacedScene){C._removeSceneEventListeners(C._replacedScene),P=C._replacedScene.listLayers();for(var H=0;H<P.length;H++)C._removeLayerFromStage(P[H]);C._replacedScene=null}C._cancelCurrentTween=null,u()}this._cancelCurrentTween=d(A,S,N),this._currentScene=m,this._replacedScene=b,this.emit("sceneChange"),this.emit("viewChange"),this._addSceneEventListeners(m)},kr=v,kr}var Yr,hs;function yu(){if(hs)return Yr;hs=1;var e=Q.vec4,t=Q.mat4;function r(o){var l=o||{};return l.colorOffset=l.colorOffset||e.create(),l.colorMatrix=l.colorMatrix||t.create(),l}function i(o,l,h){n(h,o,l.colorMatrix),e.add(h,h,l.colorOffset)}function n(o,l,h){var c=l[0],f=l[1],_=l[2],d=l[3];return o[0]=h[0]*c+h[1]*f+h[2]*_+h[3]*d,o[1]=h[4]*c+h[5]*f+h[6]*_+h[7]*d,o[2]=h[8]*c+h[9]*f+h[10]*_+h[11]*d,o[3]=h[12]*c+h[13]*f+h[14]*_+h[15]*d,o}var s=e.create();function a(o,l){for(var h=o.width,c=o.height,f=o.data,_=0;_<h*c;_++)e.set(s,f[_*4+0]/255,f[_*4+1]/255,f[_*4+2]/255,f[_*4+3]/255),i(s,l,s),f[_*4+0]=s[0]*255,f[_*4+1]=s[1]*255,f[_*4+2]=s[2]*255,f[_*4+3]=s[3]*255}return Yr={identity:r,applyToPixel:i,applyToImageData:a},Yr}var Xr,ls;function gu(){if(ls)return Xr;ls=1;var e=pe(),t=.1,r=.01,i={yawSpeed:t,pitchSpeed:t,fovSpeed:t,yawAccel:r,pitchAccel:r,fovAccel:r,targetPitch:0,targetFov:null};function n(s){s=e(s||{},i);var a=s.yawSpeed,o=s.pitchSpeed,l=s.fovSpeed,h=s.yawAccel,c=s.pitchAccel,f=s.fovAccel,_=s.targetPitch,d=s.targetFov;return function(){var p=0,v=0,w=0,x=0,m=0,M=0,u=0,C,T,b,P;return function(R,A){if(C=(A-p)/1e3,m=Math.min(v+C*h,a),T=m*C,R.yaw=R.yaw+T,_!=null&&R.pitch!==_){var O=.5*w*w/c;Math.abs(_-R.pitch)>O?M=Math.min(w+C*c,o):M=Math.max(w-C*c,0),b=M*C,_<R.pitch&&(R.pitch=Math.max(_,R.pitch-b)),_>R.pitch&&(R.pitch=Math.min(_,R.pitch+b))}if(d!=null&&R.fov!==_){var I=.5*x*x/f;Math.abs(d-R.fov)>I?u=Math.min(x+C*f,l):u=Math.max(x-C*f,0),P=u*C,d<R.fov&&(R.fov=Math.max(d,R.fov-P)),d>R.fov&&(R.fov=Math.min(d,R.fov+P))}return p=A,v=m,w=M,x=u,R}}}return Xr=n,Xr}var Br,cs;function wu(){if(cs)return Br;cs=1;function e(t,r){function i(){r&&r.length>0?t.apply(null,r):t()}setTimeout(i,0)}return Br=e,Br}var Ur,vs;function xu(){if(vs)return Ur;vs=1;function e(t){return t*Math.PI/180}return Ur=e,Ur}var Gr,fs;function Mu(){if(fs)return Gr;fs=1;function e(t){return t*180/Math.PI}return Gr=e,Gr}var jr,us;function Eu(){return us||(us=1,jr={WebGlStage:ws(),WebGlCubeRenderer:za(),WebGlFlatRenderer:Aa(),WebGlEquirectRenderer:Ia(),registerDefaultRenderers:qa(),CubeGeometry:tu(),FlatGeometry:ru(),EquirectGeometry:iu(),RectilinearView:nu(),FlatView:su(),ImageUrlSource:ou(),SingleAssetSource:hu(),StaticAsset:Qr(),DynamicAsset:lu(),TextureStore:Wa(),Layer:Ya(),RenderLoop:Xa(),KeyControlMethod:Ba(),DragControlMethod:ja(),QtvrControlMethod:Za(),ScrollZoomControlMethod:Ka(),PinchZoomControlMethod:Qa(),VelocityControlMethod:fu(),ElementPressControlMethod:uu(),Controls:Ja(),Dynamics:ye(),Viewer:mu(),Scene:io(),Hotspot:to(),HotspotContainer:ro(),colorEffects:yu(),registerDefaultControls:no(),autorotate:gu(),util:{async:_s(),cancelize:ms(),chain:fi(),clamp:Le(),clearOwnProperties:U(),cmp:De(),compose:Na(),convertFov:$a(),decimal:vi(),defaults:pe(),defer:wu(),degToRad:xu(),delay:Fa(),dom:ne(),extend:ka(),hash:et(),inherits:de(),mod:Ee(),noop:$e(),now:Ce(),once:Kr(),pixelRatio:Qe(),radToDeg:Mu(),real:ci(),retry:Va(),tween:so(),type:He()},dependencies:{bowser:Jr(),glMatrix:Q,eventEmitter:j(),hammerjs:Ua()}}),jr}var Tu=Eu();const Ne=Ao(Tu),bu=document.getElementById("pano"),Cu=new Ne.Viewer(bu),Su=Ne.ImageUrlSource.fromString("/src/assets/panorama.jpg"),Ru=new Ne.EquirectGeometry([{width:4e3}]),Lu=Ne.RectilinearView.limit.traditional(4e3,100*Math.PI/180),Pu=new Ne.RectilinearView(null,Lu),ao=Cu.createScene({source:Su,geometry:Ru,view:Pu});ao.switchTo();const zu=ao.hotspotContainer(),rt=document.createElement("div");rt.className="hotspot";rt.innerHTML='<div class="hotspot-content">MIS-BAV</div>';zu.createHotspot(rt,{yaw:0,pitch:0});rt.addEventListener("click",()=>{alert("Welcome to MIS of BAV!")});
